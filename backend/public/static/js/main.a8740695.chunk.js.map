{"version":3,"sources":["data/action.js","utils/utils.js","api/api.js","data/reducers.js","Config.js","data/store.js","components/listItemLink.js","pages/login.js","pages/loginDialog.js","components/roomItemList.js","components/timetableNodeList.js","components/timetableNode.js","components/timetablePeriodList.js","components/timetablePeriod.js","pages/timetableNodeAddDialog.js","pages/timetablePeriodAddDialog.js","pages/planTime.js","components/roomStockPlanList.js","components/roomStockPlan.js","pages/roomStockPlanAddDialog.js","pages/planStock.js","components/reserveTable.js","components/reserveTables.js","pages/launch.js","pages/settings.js","pages/verify.js","pages/connect.js","App.js","reportWebVitals.js","index.js"],"names":["setConfig","data","dispatch","type","setReserveTableData","setTimetableNodes","setRoomStockPlans","setTimetablePeriods","setErrorInfo","setMessage","isMobileDevice","sUserAgent","navigator","userAgent","indexOf","urlEncode","param","key","encode","paramStr","t","encodeURIComponent","i","k","Array","parseTimePoint","time","moment","format","parseTimePeriod","duration","humanize","sleep","time_ms","Promise","accept","setTimeout","Date","prototype","setDay","day","day_","this","getDay","setTime","getTime","toDateString","toISOString","slice","request","url_base","router","args","a","method","js","fetch","credentials","mode","json","resolve","reject","body","JSON","stringify","headers","then","console","log","store","code","warn","message","timetable_node","timetable_period","room_stock_plan","parse","API","props","window","location","port","url","test","get_ips","get_timetable_node","set_timetable_node","delete_timetable_node","get_timetable_period","set_timetable_period","delete_timetable_period","get_room_stock_plan","set_room_stock_plan","delete_room_stock_plan","delete_tid","get_shop_info","get_reserve_date","get_reserve_table","upload_config","download_config","logout","has_login","bind","default_error_info","ips","node","period","stock","tid","shop_info","reserve_date","date","reserve_table","getState","config","config_frontend","AuthAPI","url_base_remote","url_base_local","regist","login","auth","delete","applyCaptcha","admin_url","user","phone","password","captcha","defaultState","ITEM_NAME","load","save","theme_avaliable","createMuiTheme","palette","primary","main","blueGrey","secondary","grey","data_default","debug","version_frontend","theme_name","settings_async","theme","api","state","localStorage","getItem","Error","e","s","setItem","reserveTableData","roomStockData","timetableNodes","timetablePeriods","roomStockPlans","shopInfo","errorInfo","combineReducers","action","createStore","reducers","applyMiddleware","thunk","ListItemLink","icon","to","renderLink","React","useMemo","forwardRef","itemProps","ref","ListItem","button","component","ListItemIcon","ListItemText","Login","render","Container","size","Typography","variant","Button","onClick","setState","Component","useStyles","makeStyles","content","marginTop","marginBottom","LoginDialog","onClose","open","Dialog","DialogTitle","Divider","DialogContent","foodDesc","overflow","whiteSpace","contentOverflow","maxWidth","RoomItemList","classes","roomItemNow","editable","useState","itemId","periodId","price","singHours","roomType","roomItem","setRoomItem","List","ListItemSecondaryAction","TextField","disabled","defaultValue","onChange","item","target","value","className","nested","paddingLeft","spacing","TimetableNodeList","time_","selectedDate","handleDateChange","available_start","selectAvailableStartDate","handleAvailableStartDateChange","available_end","selectAvailableEndDate","handleAvailableEndDateChange","selectAvailableStartDateOn","setSelectAvailableStartDateOn","selectAvailableEndDateOn","setSelectAvailableEndDateOn","roomItemListOpen","setRoomItemListOpen","cycle","parseInt","frequency","setFrequency","valuePrice","setValuePrice","disablePadding","Collapse","in","timeout","unmountOnExit","label","DateTimePicker","Switch","checked","undefined","fullWidth","n","_d","parent","arg","secondaryIcon","TimetableNode","setOpen","itemName","avaliable","IconButton","edge","TimetablePeriodList","time_start","selectedStartDate","handleDateStartChange","time_end","selectedEndDate","handleDateEndChange","TimetablePeriod","TimetableNodeAddDialog","TimetablePeriodAddDialog","PlanTime","storeState","nodeAddOpen","periodAddOpen","unsubscribe","subscribe","updateData","nodes","periods","subheader","ListSubheader","style","float","color","length","map","RoomStockPlanList","valueValue","setValueValue","planType","setPlanType","errorMessage","setErrorMessage","FormControl","InputLabel","Select","v","MenuItem","RoomStockPlan","planTypeName","RoomStockPlanAddDialog","PlanStock","stockAddOpen","roomStockPlan","stocks","table","minWidth","planButton","MyTableCell","styles","padding","noBorder","borderBottom","TableCell","align","colSpan","requestedDayData","setUpdateTimer","ReserveTable","dayData","setDayData","roomList","setRoomList","addPlanOpen","setAddPlanOpen","planManagerOpen","setPlanManagerOpen","Period","maxRow","roomNameList","roomData","roomMapItemEntry","roomName","push","targetRowCenter","rows","cells","key2","name","Box","planCount","Link","href","TableRow","AddPlanTypeSelector","val","d","PlanManager","reserveTableData_","t_","LinearProgress","tableHeaderCells","tableHeader","TableHead","roomCapacity","periodList","TableContainer","Paper","Table","stickyHeader","TableBody","TabPanel","children","index","other","role","hidden","id","aria-labelledby","root","overflowX","display","width","flexGrow","background","paper","formControl","margin","selectEmpty","ReserveTables","tabValue","setTableValue","showTable","setShowTable","fullShow","setFullShow","Tabs","indicatorColor","textColor","scrollButtons","aria-label","Tab","event","innerWidth","fullScreen","StateNow","Launch","Settings","themeName","setThemeName","refConfigFileInput","useRef","resetSettingsOpen","setResetSettingsOpen","deleteDataOpen","setDeleteDataOpen","resetSettings","c","reload","filename","eleLink","document","createElement","download","blob","Blob","URL","createObjectURL","appendChild","click","removeChild","funDownload","toLocaleString","current","files","file","reader","FileReader","readAsText","onload","evt","fileData","result","defaultChecked","DialogActions","authApi","linkAction","RegistComp","onLogin","setPhone","setAddress","setPassword","passwordRepeate","setPasswordRepeate","setChecked","helperText","error","Boolean","FormControlLabel","control","Checkbox","CaptchaComp","onSuccess","onError","setCaptcha","handleCaptcha","resp","DialogContentText","autoFocus","LoginComp","onRegist","requesting","setRequesting","errorData","setErrorData","openCaptcha","setOpenCaptcha","handleLogin","loginData","err","PropType","func","isRequired","bool","string","Verify","pageType","setPageType","QRCode","require","Connect","qrcodeWidth","protocol","hostname","addEventListener","ip","drawerWidth","locale","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","leavingScreen","title","appBarShift","marginLeft","enteringScreen","menuButton","marginRight","hide","flexShrink","drawerOpen","drawerClose","breakpoints","up","toolbar","alignItems","justifyContent","mixins","catch","subscribers","config_last_data","subFunc","getShopTitle","shopName","branchName","App","useTheme","popupLogin","setPopupLogin","errorDialogInfo","setErrorDialogInfo","myMessage","setMyMessage","titleDefault","setTitle","useEffect","onWindowResize","removeEventListener","ThemeProvider","utils","MomentUtils","CssBaseline","AppBar","position","clsx","Toolbar","noWrap","Drawer","direction","pathname","path","exact","obj","Symbol","iterator","toString","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Fragment","fontSize","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","getElementById","startFunc","cycleFunc"],"mappings":"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","file":"static/js/main.a8740695.chunk.js","sourcesContent":["export function setConfig(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_CONFIG\", data: data });\r\n  };\r\n}\r\n\r\nexport function setReserveTableData(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_RESERVE_TABLE_DATA\", data: data });\r\n  };\r\n}\r\n\r\nexport function setRoomStockData(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ROOM_STOCK_DATA\", data: data });\r\n  };\r\n}\r\n\r\nexport function setShopInfo(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_SHOP_INFO\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTimetableNodes(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TIMETABLE_NODES\", data: data });\r\n  };\r\n}\r\n\r\nexport function setRoomStockPlans(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ROOM_STOCK_PLANS\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTimetablePeriods(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TIMETABLE_PERIODS\", data: data });\r\n  };\r\n}\r\n\r\nexport function setErrorInfo(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ERROR_INFO\", data: data });\r\n  };\r\n}\r\n\r\nexport function setMessage(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_MESSAGE\", data: data });\r\n  };\r\n}\r\n\r\n","import moment from 'moment';\r\nimport 'moment/locale/zh-cn'\r\n\r\nexport function isMobileDevice() {\r\n  const sUserAgent = navigator.userAgent;\r\n  return (sUserAgent.indexOf('Android') > -1 || sUserAgent.indexOf('iPhone') > -1 || sUserAgent.indexOf('iPad') > -1 || sUserAgent.indexOf('iPod') > -1 || sUserAgent.indexOf('Symbian') > -1);\r\n}\r\n\r\n/** \r\n* param 将要转为URL参数字符串的对象 \r\n* key URL参数字符串的前缀 \r\n* encode true/false 是否进行URL编码,默认为true \r\n*  \r\n* return URL参数字符串 \r\n*/\r\nexport function urlEncode(param, key, encode) {\r\n  if (param == null) return '';\r\n  var paramStr = '';\r\n  var t = typeof (param);\r\n  if (t === 'string' || t === 'number' || t === 'boolean') {\r\n    paramStr += '&' + key + '=' + ((encode == null || encode) ? encodeURIComponent(param) : param);\r\n  } else {\r\n    for (var i in param) {\r\n      var k = key == null ? i : key + (param instanceof Array ? '[' + i + ']' : '.' + i);\r\n      paramStr += urlEncode(param[i], k, encode);\r\n    }\r\n  }\r\n  return paramStr;\r\n};\r\n\r\nexport function urlEncode2(obj) {\r\n  try {\r\n    return JSON.stringify(obj).replace(/:/g, \"=\").replace(/\"/g, '').replace(/,/g, '&').match(/\\{([^)]*)\\}/)[1];\r\n  } catch (e) {\r\n    console.error(e);\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function parseTimePoint(time) {\r\n  return moment(time).format('LLLL');\r\n}\r\n\r\nexport function parseTimePeriod(time) {\r\n  return moment.duration(time).humanize();\r\n}\r\n\r\nexport function getTextFieldValue(el) {\r\n  return el.current.childNodes[el.current.childElementCount - 1].childNodes[0].value;\r\n}\r\n\r\nexport function sleep(time_ms) {\r\n  return new Promise(accept => {\r\n    setTimeout(accept, time_ms);\r\n  });\r\n}\r\n\r\n// 设置到本周的星期几\r\nDate.prototype.setDay = function (day) {\r\n  let day_ = this.getDay();\r\n  if (day_ === day) return this;\r\n  this.setTime(this.getTime() + 1000 * 60 * 60 * 24 * (day - day_));\r\n  return this;\r\n};\r\n\r\n// 获取 YYYY-MM-DD 格式\r\nDate.prototype.toDateString = function () {\r\n  return this.toISOString().slice(0, 10);\r\n};\r\n\r\n// export function cutString(str, length=10)\r\n\r\nexport function isIterator(obj) {\r\n  return obj != null && typeof obj[Symbol.iterator] === 'function';\r\n}\r\n\r\n// 下载文件方法\r\nexport function funDownload(content, filename) {\r\n  var eleLink = document.createElement('a');\r\n  eleLink.download = filename;\r\n  eleLink.style.display = 'none';\r\n  // 字符内容转变成blob地址\r\n  var blob = new Blob([content]);\r\n  eleLink.href = URL.createObjectURL(blob);\r\n  // 触发点击\r\n  document.body.appendChild(eleLink);\r\n  eleLink.click();\r\n  // 然后移除\r\n  document.body.removeChild(eleLink);\r\n};","import { setErrorInfo } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { isIterator, urlEncode } from \"../utils/utils\"\r\n\r\nconst request = async function (url_base, router, args, method = 'GET') {\r\n  let js = {};\r\n  try {\r\n    if (method === 'GET') {\r\n      js = await ((await fetch(url_base + router + (args ? \"?\" : \"\") + urlEncode(args), {\r\n        method: 'GET',\r\n        credentials: 'omit',\r\n        // credentials: 'include',\r\n        mode: 'cors'\r\n      })).json());\r\n    } else {\r\n      js = await (await new Promise((resolve, reject) => {\r\n        fetch(url_base + router, {\r\n          body: JSON.stringify(args),\r\n          method: 'POST',\r\n          // 使用 include 会拖慢速度\r\n          // credentials: 'include',\r\n          credentials: 'omit',\r\n          mode: 'cors',\r\n          headers: {\r\n            'content-type': 'application/json',\r\n          },\r\n        }).then(data => {\r\n          // console.log('then', data);\r\n          resolve(data);\r\n        })\r\n      })).json();\r\n    }\r\n  } catch (e) {\r\n    console.log(e);\r\n    // if (isIterator(store.getState().errorInfo)) {\r\n    //   let t = store.getState().errorInfo;\r\n    //   t.push(e);\r\n    //   setErrorInfo(t);\r\n    // } else setErrorInfo([e,]);\r\n    store.dispatch(setErrorInfo(e));\r\n    throw e;\r\n  }\r\n  if (js.code !== 200) {\r\n    console.warn(\"Request responsed with code\", js.code, 'message:', js.message, 'data:', js.data);\r\n    store.dispatch(setErrorInfo(js));\r\n  }\r\n  try {\r\n    // 忽略惯常消息\r\n    if (!(js.data.timetable_node || js.data.timetable_period || js.data.room_stock_plan))\r\n      console.log('resp', js);\r\n    // 过长的json可能不自动转换..?\r\n    if (typeof (js) === 'string') {\r\n      try {\r\n        js = JSON.parse(js);\r\n      } catch (e) {\r\n        console.warn(e);\r\n        store.dispatch(setErrorInfo(e));\r\n        return null;\r\n      }\r\n    }\r\n    return js;\r\n  } catch (e) {\r\n    console.log(e);\r\n    // if (isIterator(store.getState().errorInfo)) {\r\n    //   let t = store.getState().errorInfo;\r\n    //   t.push(e);\r\n    //   setErrorInfo(t);\r\n    // } else setErrorInfo([e,]);\r\n    store.dispatch(setErrorInfo(e));\r\n    throw e;\r\n  }\r\n};\r\n\r\nclass API {\r\n  constructor(props) {\r\n    this.url_base = `http://localhost:${window.location.port}/api/v1/`;\r\n    // this.url_base = '/api/v1/';\r\n    // this.url_base = 'http://localhost:12000/api/v1/';\r\n    // this.url_base = 'http://localhost:8000/';\r\n    // this.url_base = 'http://localhost:8001/';\r\n    this.url = {\r\n      test: 'test',\r\n      get_ips: 'get/ips',\r\n      get_timetable_node: \"get/timetable_node\",\r\n      set_timetable_node: \"set/timetable_node\",\r\n      delete_timetable_node: \"delete/timetable_node\",\r\n      get_timetable_period: \"get/timetable_period\",\r\n      set_timetable_period: \"set/timetable_period\",\r\n      delete_timetable_period: \"delete/timetable_period\",\r\n      get_room_stock_plan: \"get/room_stock_plan\",\r\n      set_room_stock_plan: \"set/room_stock_plan\",\r\n      delete_room_stock_plan: \"delete/room_stock_plan\",\r\n      delete_tid: \"delete/tid\",\r\n      get_shop_info: \"get/shop_info\",\r\n      get_reserve_date: 'get/reserve_date',\r\n      get_reserve_table: 'get/reserve_table',\r\n      upload_config: \"upload/config\",\r\n      download_config: \"download/config\",\r\n      logout: \"logout\",\r\n      has_login: 'has_login',\r\n    }\r\n    this.test = this.test.bind(this);\r\n    this.get_ips = this.get_ips.bind(this);\r\n    this.default_error_info = {\r\n      code: 302,\r\n      message: \"网络错误\",\r\n      data: {},\r\n    };\r\n  }\r\n  async test() {\r\n    return (await request(this.url_base, this.url.test)).data;\r\n  }\r\n  async logout() {\r\n    return (await request(this.url_base, this.url.logout)).code;\r\n  }\r\n  async has_login() {\r\n    return (await request(this.url_base, this.url.has_login)).data.has_login;\r\n  }\r\n  async get_ips() {\r\n    return (await request(this.url_base, this.url.get_ips)).data.ips;\r\n  }\r\n  async get_timetable_node() {\r\n    return (await request(this.url_base, this.url.get_timetable_node)).data.timetable_node;\r\n  }\r\n  async set_timetable_node(node) {\r\n    return await request(this.url_base, this.url.set_timetable_node, node, 'POST');\r\n  }\r\n  async get_timetable_period() {\r\n    return (await request(this.url_base, this.url.get_timetable_period)).data.timetable_period;\r\n  }\r\n  async set_timetable_period(period) {\r\n    return await request(this.url_base, this.url.set_timetable_period, period, 'POST');\r\n  }\r\n  async get_room_stock_plan() {\r\n    return (await request(this.url_base, this.url.get_room_stock_plan)).data.room_stock_plan;\r\n  }\r\n  async set_room_stock_plan(stock) {\r\n    return await request(this.url_base, this.url.set_room_stock_plan, stock, 'POST');\r\n  }\r\n  async delete_tid(tid) {\r\n    return await request(this.url_base, this.url.delete_tid + '/' + tid);\r\n  }\r\n  \r\n  async get_shop_info() {\r\n    return (await request(this.url_base, this.url.get_shop_info)).data.shop_info;\r\n  }\r\n  async get_reserve_date() {\r\n    return (await request(this.url_base, this.url.get_reserve_date)).data.reserve_date;\r\n  }\r\n  async get_reserve_table(date) {\r\n    // console.log('date', date);\r\n    return (await request(this.url_base, this.url.get_reserve_table, { date: date })).data.reserve_table;\r\n  }\r\n  async upload_config() {\r\n    return (await request(this.url_base, this.url.upload_config, store.getState().config.data, 'POST'));\r\n  }\r\n  async download_config() {\r\n    return (await request(this.url_base, this.url.download_config)).data.config_frontend;\r\n  }\r\n}\r\n\r\nclass AuthAPI {\r\n  constructor(props) {\r\n    this.url_base_remote = 'https://service-kfp3xte1-1254016670.sh.apigw.tencentcs.com/release/';\r\n    this.url_base_local = 'http://localhost:8081/';\r\n    this.url_base = window.location.port === 80 ? this.url_base_remote : this.url_base_local;\r\n    this.url = {\r\n      regist: 'user/regist',\r\n      login: 'user/login',\r\n      auth: 'user/auth',\r\n      delete: 'user/delete',\r\n      applyCaptcha: 'user/captcha/apply',\r\n    };\r\n    this.admin_url = 'http://gbk.chiro.work/';\r\n  }\r\n  async regist(user) {\r\n    return await request(this.url_base, this.url.regist, user, 'GET');\r\n  }\r\n  async auth(auth) {\r\n    return await request(this.url_base, this.url.auth, { auth }, 'GET').code === 200;\r\n  }\r\n  async login(phone, password) {\r\n    return await request(this.url_base, this.url.login, { phone, password }, 'GET');\r\n  }\r\n  async applyCaptcha(phone, password, captcha) {\r\n    return (await request(this.url_base, this.url.applyCaptcha, { phone, password, captcha }, 'GET'));\r\n  }\r\n}\r\n\r\nexport { API, AuthAPI };","import { combineReducers } from 'redux'\r\nimport Config from \"../Config\"\r\n\r\nconst defaultState = {\r\n  config: new Config(),\r\n  reserveTableData: {},\r\n  roomStockData: null,\r\n  timetableNodes: [],\r\n  timetablePeriods: [],\r\n  roomStockPlans: [],\r\n  shopInfo: null,\r\n  errorInfo: null,\r\n  message: null,\r\n}\r\n\r\nfunction config(state = defaultState.config, action) {\r\n  switch (action.type) {\r\n    case \"SET_CONFIG\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction reserveTableData(state = defaultState.reserveTableData, action) {\r\n  switch (action.type) {\r\n    case \"SET_RESERVE_TABLE_DATA\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction roomStockData(state = defaultState.roomStockData, action) {\r\n  switch (action.type) {\r\n    case \"SET_ROOM_STOCK_DATA\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction shopInfo(state = defaultState.reserveTableData, action) {\r\n  switch (action.type) {\r\n    case \"SET_SHOP_INFO\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\n\r\nfunction timetableNodes(state = defaultState.timetableNodes, action) {\r\n  switch (action.type) {\r\n    case \"SET_TIMETABLE_NODES\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction timetablePeriods(state = defaultState.timetablePeriods, action) {\r\n  switch (action.type) {\r\n    case \"SET_TIMETABLE_PERIODS\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction roomStockPlans(state = defaultState.roomStockPlans, action) {\r\n  switch (action.type) {\r\n    case \"SET_ROOM_STOCK_PLANS\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction errorInfo(state = defaultState.errorInfo, action) {\r\n  switch (action.type) {\r\n    case \"SET_ERROR_INFO\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction message(state = defaultState.message, action) {\r\n  switch (action.type) {\r\n    case \"SET_MESSAGE\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default combineReducers({ config, reserveTableData, roomStockData, shopInfo, timetableNodes, timetablePeriods, errorInfo, roomStockPlans, message });\r\n","import { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport { orange, grey, blueGrey } from '@material-ui/core/colors';\r\nimport { API, AuthAPI } from \"./api/api\";\r\n\r\nclass Config {\r\n  ITEM_NAME = \"group_bying_config\";\r\n  constructor() {\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.theme_avaliable = {\r\n      \"默认主题\": createMuiTheme({}),\r\n      '黑暗模式': createMuiTheme({\r\n        palette: {\r\n          type: \"dark\",\r\n          primary: {\r\n            main: blueGrey[500],\r\n          },\r\n          secondary: {\r\n            main: grey[500],\r\n          },\r\n        },\r\n      }),\r\n    }\r\n    // 在构造函数执行的时候加载保存的数据\r\n    this.data_default = {\r\n      debug: false,\r\n      version_frontend: 0.1,\r\n      // 显示主题\r\n      // theme_name: \"黑暗模式\",\r\n      theme_name: \"默认主题\",\r\n      theme_avaliable: [\r\n        '默认主题',\r\n        '黑暗模式'\r\n      ],\r\n      auth: \"\",\r\n      // 用户信息\r\n      user: {\r\n        phone: '',\r\n      },\r\n      // 设置同步\r\n      settings_async: true,\r\n    };\r\n    this.data = this.data_default;\r\n    this.theme = this.theme_avaliable[\"默认主题\"];\r\n    this.api = new API();\r\n    // 先声明已经登录，然后再检查登录状态\r\n    this.has_login = true;\r\n    this.api.has_login().then(state => { this.has_login = state; });\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    console.log(\"Config: loading config...\");\r\n    if (this.data.debug) {\r\n      console.log(\"Config: load default config.\");\r\n      this.save();\r\n    }\r\n    try {\r\n      this.data = JSON.parse(localStorage.getItem(this.ITEM_NAME));\r\n      if (!this.data) throw new Error(\"Null data\");\r\n      console.log(\"Got data:\", this.data);\r\n      if (!this.data.version_frontend || this.data.version_frontend < this.data_default.version_frontend) {\r\n        // 版本升级，增量更新\r\n        console.log(`Config: update ${this.data.version_frontend} -> ${this.data_default.version_frontend}`);\r\n        this.data.version_frontend = this.data_default.version_frontend;\r\n        for (let k in this.data_default) {\r\n          if (!this.data[k]) {\r\n            console.log(`    Config: add value ${k}`);\r\n            this.data[k] = this.data_default[k];\r\n          }\r\n        }\r\n        this.save();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Can not find ${this.ITEM_NAME} in localStorage, use default config.`);\r\n      this.data = this.data_default;\r\n      this.save();\r\n    }\r\n    this.theme = this.theme_avaliable[this.data.theme_name];\r\n    if (!this.theme) this.theme = this.theme_avaliable[\"default\"];\r\n  }\r\n\r\n  save() {\r\n    console.log(\"Config: saving config...\");\r\n    const s = JSON.stringify(this.data);\r\n    localStorage.setItem(this.ITEM_NAME, s);\r\n    return s;\r\n  }\r\n};\r\n\r\nexport default Config;","// applyMiddleware: redux通过该函数来使用中间件\r\n// createStore: 用于创建store实例\r\nimport { applyMiddleware, createStore } from 'redux'\r\n\r\n// 中间件，作用：如果不使用该中间件，当我们dispatch一个action时，需要给dispatch函数传入action        \r\n// 对象；但如果我们使用了这个中间件，那么就可以传入一个函数，这个函数接收两个参数:dispatch和    \r\n// getState。这个dispatch可以在将来的异步请求完成后使用，对于异步action很有用\r\nimport thunk from 'redux-thunk'\r\n\r\n// 引入reducer\r\nimport reducers from './reducers.js'\r\n\r\n// 创建store实例\r\nlet store = createStore(\r\n    reducers,\r\n    applyMiddleware(thunk)\r\n)\r\nexport default store","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\n\r\nfunction ListItemLink(props) {\r\n  const { icon, primary, to } = props;\r\n\r\n  const renderLink = React.useMemo(\r\n    () => React.forwardRef((itemProps, ref) => <RouterLink to={to} ref={ref} {...itemProps} />),\r\n    [to],\r\n  );\r\n\r\n  return (\r\n    <li>\r\n      <ListItem button component={renderLink}>\r\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\r\n        <ListItemText primary={primary} />\r\n      </ListItem>\r\n    </li>\r\n  );\r\n}\r\n\r\nListItemLink.propTypes = {\r\n  icon: PropTypes.element,\r\n  primary: PropTypes.string.isRequired,\r\n  to: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default ListItemLink;\r\n\r\n","import React from 'react';\r\nimport Container from '@material-ui/core/Container';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { setConfig } from \"../data/action\";\r\nimport { Button } from '@material-ui/core';\r\nimport { API } from \"../api/api\";\r\n\r\nclass Login extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.render = this.render.bind(this);\r\n    this.state = {\r\n      has_login: true\r\n    };\r\n    this.api = new API();\r\n  }\r\n  render() {\r\n    return (<Container size=\"sm\">\r\n      <Typography variant=\"body1\">{this.state.has_login ? \"点击“重新登录”会清除后台登录信息，是否继续？\" : \"请在稍后弹出的窗口中完成登录\"}</Typography>\r\n      <Button variant=\"contained\" onClick={() => {\r\n        this.api.logout();\r\n        this.setState({ has_login: false });\r\n      }}>重新登录</Button>\r\n    </Container >)\r\n  }\r\n};\r\n\r\nexport default Login;","import React from 'react'\r\nimport Container from '@material-ui/core/Container';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport { DialogContent } from '@material-ui/core';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport PropTypes from 'prop-types';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport Login from \"./login\"\r\nimport { setConfig } from \"../data/action\"\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    marginTop: \"20%\",\r\n    marginBottom: \"20%\"\r\n  }\r\n}));\r\n\r\nfunction LoginDialog(props) {\r\n  const classes = useStyles();\r\n  const { onClose, open } = props;\r\n\r\n  const handleClose = () => {\r\n    if (onClose)\r\n      onClose();\r\n  };\r\n  return (\r\n    <Dialog onClose={handleClose} open={open}>\r\n      <DialogTitle>账户登录</DialogTitle>\r\n      <Divider></Divider>\r\n      <DialogContent>\r\n        <Login></Login>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nLoginDialog.propTypes = {\r\n  onClose: PropTypes.func,\r\n  open: PropTypes.bool.isRequired,\r\n};\r\n\r\nexport default LoginDialog;","import { List, ListItem, ListItemSecondaryAction, ListItemText, makeStyles, TextField, Typography } from '@material-ui/core';\r\nimport React from 'react';\r\n\r\nconst useStyles = makeStyles({\r\n  foodDesc: {\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    contentOverflow: 'ellipsis',\r\n    maxWidth: 160\r\n  }\r\n})\r\n\r\nexport default function RoomItemList(props) {\r\n  const classes = useStyles();\r\n  const { roomItemNow, editable } = props;\r\n  const [roomItem, setRoomItem] = React.useState(roomItemNow ? roomItemNow : {\r\n    itemId: 0,\r\n    date: new Date().toDateString(),\r\n    periodId: '00:00-00:00',\r\n    price: '0',\r\n    foodDesc: '描述',\r\n    singHours: 0,\r\n    roomType: '-',\r\n  });\r\n  const weekDays = [\r\n    '日', '一', '二', '三', '四', '五', '六'\r\n  ];\r\n  return (<List>\r\n    <ListItem>\r\n      <ListItemText primary={'ID'} />\r\n      <ListItemSecondaryAction>\r\n        <Typography variant=\"body1\">{roomItem.itemId}</Typography>\r\n      </ListItemSecondaryAction>\r\n    </ListItem>\r\n    <ListItem>\r\n      <ListItemText primary={'价格'} />\r\n      <ListItemSecondaryAction>\r\n        <TextField variant=\"standard\" disabled={!editable} defaultValue={roomItem.price} onChange={e => {\r\n          let item = roomItem;\r\n          item.price = e.target.value;\r\n          setRoomItem(item);\r\n        }}></TextField>\r\n      </ListItemSecondaryAction>\r\n    </ListItem>\r\n    <ListItem>\r\n      <ListItemText primary={'类型'} />\r\n      <ListItemSecondaryAction>\r\n        <Typography variant=\"body1\">{roomItem.roomType}</Typography>\r\n      </ListItemSecondaryAction>\r\n    </ListItem>\r\n    <ListItem>\r\n      <ListItemText primary={'描述'} />\r\n      <ListItemSecondaryAction>\r\n        <Typography variant=\"body1\" className={classes.foodDesc}>{roomItem.foodDesc}</Typography>\r\n      </ListItemSecondaryAction>\r\n    </ListItem>\r\n    <ListItem>\r\n      <ListItemText primary={'时长'} />\r\n      <ListItemSecondaryAction>\r\n        <Typography variant=\"body1\">{roomItem.singHours}小时</Typography>\r\n      </ListItemSecondaryAction>\r\n    </ListItem>\r\n    <ListItem>\r\n      <ListItemText primary={'时段'} />\r\n      <ListItemSecondaryAction>\r\n        <Typography variant=\"body1\">{roomItem.periodId}</Typography>\r\n      </ListItemSecondaryAction>\r\n    </ListItem>\r\n    <ListItem>\r\n      <ListItemText primary={'星期'} />\r\n      <ListItemSecondaryAction>\r\n        <Typography variant=\"body1\">星期{weekDays[new Date(roomItem.date).getDay()]}</Typography>\r\n      </ListItemSecondaryAction>\r\n    </ListItem>\r\n  </List>);\r\n}","import React from 'react';\r\nimport { Switch, TextField, List, ListItem, ListItemText, ListItemIcon, ListItemSecondaryAction, IconButton, Button } from '@material-ui/core';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport AlarmOnIcon from '@material-ui/icons/AlarmOn';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport PropTypes from 'prop-types';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\nimport { parseTimePoint, parseTimePeriod, sleep } from '../utils/utils'\r\nimport RoomItemList from './roomItemList';\r\nimport { API } from '../api/api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  nested: {\r\n    paddingLeft: theme.spacing(4),\r\n  },\r\n}));\r\n\r\nfunction TimetableNodeList(props) {\r\n  const classes = useStyles();\r\n  const { node, onClose, roomItemNow } = props;\r\n  const [selectedDate, handleDateChange] = React.useState(node.time_ ? new Date(node.time_) : new Date());\r\n  const [selectAvailableStartDate, handleAvailableStartDateChange] = React.useState(node.available_start ? node.available_start : 0);\r\n  const [selectAvailableEndDate, handleAvailableEndDateChange] = React.useState(node.available_end ? node.available_end : 0);\r\n  const [selectAvailableStartDateOn, setSelectAvailableStartDateOn] = React.useState(selectAvailableStartDate === 0 ? false : true);\r\n  const [selectAvailableEndDateOn, setSelectAvailableEndDateOn] = React.useState(selectAvailableEndDate === 0 ? false : true);\r\n  const [roomItemListOpen, setRoomItemListOpen] = React.useState(false);\r\n  const [frequency, setFrequency] = React.useState(node.cycle ? parseInt(node.cycle / (1000 * 60 * 60 * 24)) : \"0\");\r\n  const [valuePrice, setValuePrice] = React.useState(node.price ? ('' + node.price) : (roomItemNow ? ('' + roomItemNow.price) : '0'));\r\n  // console.log('NodeList: roomItenNow = ', roomItemNow);\r\n  return (\r\n    <List component=\"div\" disablePadding className={classes.nested}>\r\n      <ListItem button onClick={() => { setRoomItemListOpen(!roomItemListOpen); }}>\r\n        <ListItemText primary=\"对应房间项目\" />\r\n      </ListItem>\r\n      <Collapse in={roomItemListOpen} timeout=\"auto\" unmountOnExit className={classes.nested}>\r\n        <RoomItemList roomItemNow={roomItemNow} />\r\n      </Collapse>\r\n      <ListItem>\r\n        <ListItemText primary=\"调整至\" />\r\n        <ListItemSecondaryAction>\r\n          <TextField label=\"输入价格\" defaultValue={valuePrice} onChange={(e) => {\r\n            setValuePrice(e.target.value);\r\n          }} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置时间\" />\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker value={selectedDate} onChange={handleDateChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置周期\" />\r\n        <ListItemSecondaryAction>\r\n          <TextField label=\"输入周期(单位:天, 0表示单次)\" defaultValue={frequency} onChange={(e) => {\r\n            setFrequency(e.target.value);\r\n          }} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"生效时间之外项目无效，不设置即全部生效\" />\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"启用生效开始时间\" />\r\n        <ListItemSecondaryAction>\r\n          <Switch checked={selectAvailableStartDateOn} onChange={e => {\r\n            if (e.target.checked) handleAvailableStartDateChange(0);\r\n            setSelectAvailableStartDateOn(e.target.checked);\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      {selectAvailableStartDateOn ? <ListItem className={classes.nested}>\r\n        <ListItemText primary=\"设置时间\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker\r\n            value={selectAvailableStartDate}\r\n            onChange={handleAvailableStartDateChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem> : undefined}\r\n      <ListItem>\r\n        <ListItemText primary=\"启用生效结束时间\" />\r\n        <ListItemSecondaryAction>\r\n          <Switch checked={selectAvailableEndDateOn} onChange={e => {\r\n            if (e.target.checked) handleAvailableEndDateChange(0);\r\n            setSelectAvailableEndDateOn(e.target.checked)\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      {selectAvailableEndDateOn ? <ListItem className={classes.nested}>\r\n        <ListItemText primary=\"设置时间\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker\r\n            value={selectAvailableEndDate}\r\n            onChange={handleAvailableEndDateChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem> : undefined}\r\n      <ListItem>\r\n        <Button variant=\"contained\" fullWidth onClick={() => {\r\n          let n = node ? node : {};\r\n          n.time_ = selectedDate._d ? selectedDate._d.getTime() : selectedDate.getTime();\r\n          n.available_start = selectAvailableStartDate._d ? selectAvailableStartDate._d.getTime() : selectAvailableStartDate;\r\n          n.available_end = selectAvailableEndDate._d ? selectAvailableEndDate._d.getTime() : selectAvailableEndDate;\r\n          if (n.available_start === 0) n.available_start = new Date().getTime();\r\n          if (n.available_end === 0) n.available_end = new Date().getTime();\r\n          if (!selectAvailableStartDateOn) delete n.available_start;\r\n          if (!selectAvailableEndDateOn) delete n.available_end;\r\n          n.cycle = parseInt(frequency) * 1000 * 60 * 60 * 24;\r\n          n.price = valuePrice;\r\n          n.roomItem = roomItemNow;\r\n          if (roomItemNow.parent)\r\n            for (const arg in roomItemNow.parent)\r\n              n[arg] = roomItemNow.parent[arg];\r\n          // 调用api\r\n          const api = new API();\r\n          api.set_timetable_node(n);\r\n          if (onClose) {\r\n            onClose(n);\r\n          }\r\n        }}>保存</Button>\r\n      </ListItem>\r\n    </List>\r\n  );\r\n}\r\n\r\nTimetableNodeList.propTypes = {\r\n  node: PropTypes.object,\r\n  onClose: PropTypes.func\r\n};\r\n\r\nexport default TimetableNodeList;","import React from 'react';\r\nimport { TextField, List, ListItem, ListItemText, ListItemIcon, ListItemSecondaryAction, IconButton, Button } from '@material-ui/core';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport AlarmOnIcon from '@material-ui/icons/AlarmOn';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport PropTypes from 'prop-types';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\nimport { parseTimePoint, parseTimePeriod, sleep } from '../utils/utils';\r\nimport TimetableNodeList from '../components/timetableNodeList';\r\nimport { API } from '../api/api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  nested: {\r\n    paddingLeft: theme.spacing(4),\r\n  },\r\n  secondaryIcon: {\r\n    // paddingRight: theme.spacing(4),\r\n  }\r\n}));\r\n\r\nconst api = new API();\r\n\r\nfunction TimetableNode(props) {\r\n  const classes = useStyles();\r\n  const { node, onClose } = props;\r\n  const [open, setOpen] = React.useState(false);\r\n  const handleClick = () => {\r\n    setOpen(!open);\r\n  };\r\n  const getSecondaryText = () => {\r\n    return `${node.periodId}/${node.roomItem.roomType}/调整至:${node.price}/下次调整:${parseTimePoint(node.time_)}/周期:${node.cycle > 0 ? parseTimePeriod(node.cycle) : \"单次\"}/${(node.avaliable !== false) ? \"可用\" : \"不可用\"}`\r\n  };\r\n  return (\r\n    <div>\r\n      <ListItem button onClick={handleClick}>\r\n        <ListItemIcon><AlarmOnIcon /></ListItemIcon>\r\n        <ListItemText primary={node.itemName} secondary={getSecondaryText()} />\r\n        <div className={classes.secondaryIcon}>\r\n          {open ? <ExpandLessIcon /> : <ExpandMoreIcon />}\r\n        </div>\r\n        <ListItemSecondaryAction>\r\n          <IconButton edge=\"end\" onClick={async () => {\r\n            if (node.tid) await api.delete_tid(node.tid);\r\n          }}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n        <TimetableNodeList roomItemNow={node.roomItem} node={node} onClose={node => {\r\n          console.log('onClose', node, onClose);\r\n          setOpen(false);\r\n          if (onClose) onClose();\r\n        }} />\r\n      </Collapse>\r\n    </div>\r\n  );\r\n}\r\n\r\nTimetableNode.propTypes = {\r\n  node: PropTypes.object.isRequired,\r\n  onClose: PropTypes.func\r\n};\r\n\r\nexport default TimetableNode;","import React from 'react';\r\nimport { Switch, TextField, List, ListItem, ListItemText, ListItemIcon, ListItemSecondaryAction, IconButton, Button } from '@material-ui/core';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport AlarmOnIcon from '@material-ui/icons/AlarmOn';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport PropTypes from 'prop-types';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\nimport { parseTimePoint, parseTimePeriod, sleep } from '../utils/utils'\r\nimport RoomItemList from './roomItemList';\r\nimport { API } from '../api/api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  nested: {\r\n    paddingLeft: theme.spacing(4),\r\n  },\r\n}));\r\n\r\nfunction TimetablePeriodList(props) {\r\n  const classes = useStyles();\r\n  const { period, onClose, roomItemNow } = props;\r\n  const [selectedStartDate, handleDateStartChange] = React.useState(period.time_start ? new Date(period.time_start) : new Date());\r\n  const [selectedEndDate, handleDateEndChange] = React.useState(period.time_end ? new Date(period.time_end) : new Date());\r\n  const [selectAvailableStartDate, handleAvailableStartDateChange] = React.useState(period.available_start ? period.available_start : 0);\r\n  const [selectAvailableEndDate, handleAvailableEndDateChange] = React.useState(period.available_end ? period.available_end : 0);\r\n  const [selectAvailableStartDateOn, setSelectAvailableStartDateOn] = React.useState(selectAvailableStartDate === 0 ? false : true);\r\n  const [selectAvailableEndDateOn, setSelectAvailableEndDateOn] = React.useState(selectAvailableEndDate === 0 ? false : true);\r\n  const [roomItemListOpen, setRoomItemListOpen] = React.useState(false);\r\n  const [frequency, setFrequency] = React.useState(period.cycle ? parseInt(period.cycle / (1000 * 60 * 60 * 24)) : \"0\");\r\n  const [valuePrice, setValuePrice] = React.useState(period.price ? ('' + period.price) : (roomItemNow ? ('' + roomItemNow.price) : '0'));\r\n  // console.log('PeriodList: roomItenNow = ', roomItemNow);\r\n  return (\r\n    <List component=\"div\" disablePadding className={classes.nested}>\r\n      <ListItem button onClick={() => { setRoomItemListOpen(!roomItemListOpen); }}>\r\n        <ListItemText primary=\"对应房间项目\" />\r\n      </ListItem>\r\n      <Collapse in={roomItemListOpen} timeout=\"auto\" unmountOnExit className={classes.nested}>\r\n        <RoomItemList roomItemNow={roomItemNow} />\r\n      </Collapse>\r\n      <ListItem>\r\n        <ListItemText primary=\"调整至\" />\r\n        <ListItemSecondaryAction>\r\n          <TextField label=\"输入价格\" defaultValue={valuePrice} onChange={(e) => {\r\n            setValuePrice(e.target.value);\r\n          }} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置价格开始时间\" />\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker value={selectedStartDate} onChange={handleDateStartChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置价格结束时间\" />\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker value={selectedEndDate} onChange={handleDateEndChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置周期\" />\r\n        <ListItemSecondaryAction>\r\n          <TextField label=\"输入周期(单位:天, 0表示单次)\" defaultValue={frequency} onChange={(e) => {\r\n            setFrequency(e.target.value);\r\n          }} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"生效时间之外项目无效，不设置即全部生效\" />\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"启用生效开始时间\" />\r\n        <ListItemSecondaryAction>\r\n          <Switch checked={selectAvailableStartDateOn} onChange={e => {\r\n            if (e.target.checked) handleAvailableStartDateChange(0);\r\n            setSelectAvailableStartDateOn(e.target.checked);\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      {selectAvailableStartDateOn ? <ListItem className={classes.nested}>\r\n        <ListItemText primary=\"设置时间\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker\r\n            value={selectAvailableStartDate}\r\n            onChange={handleAvailableStartDateChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem> : undefined}\r\n      <ListItem>\r\n        <ListItemText primary=\"启用生效结束时间\" />\r\n        <ListItemSecondaryAction>\r\n          <Switch checked={selectAvailableEndDateOn} onChange={e => {\r\n            if (e.target.checked) handleAvailableEndDateChange(0);\r\n            setSelectAvailableEndDateOn(e.target.checked)\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      {selectAvailableEndDateOn ? <ListItem className={classes.nested}>\r\n        <ListItemText primary=\"设置时间\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker\r\n            value={selectAvailableEndDate}\r\n            onChange={handleAvailableEndDateChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem> : undefined}\r\n      <ListItem>\r\n        <Button variant=\"contained\" fullWidth onClick={() => {\r\n          let n = period ? period : {};\r\n          n.time_start = selectedStartDate._d ? selectedStartDate._d.getTime() : selectedStartDate.getTime();\r\n          n.time_end = selectedEndDate._d ? selectedEndDate._d.getTime() : selectedEndDate.getTime();\r\n          n.available_start = selectAvailableStartDate._d ? selectAvailableStartDate._d.getTime() : selectAvailableStartDate;\r\n          n.available_end = selectAvailableEndDate._d ? selectAvailableEndDate._d.getTime() : selectAvailableEndDate;\r\n          if (n.available_start === 0) n.available_start = new Date().getTime();\r\n          if (n.available_end === 0) n.available_end = new Date().getTime();\r\n          if (!selectAvailableStartDateOn) delete n.available_start;\r\n          if (!selectAvailableEndDateOn) delete n.available_end;\r\n          n.cycle = parseInt(frequency) * 1000 * 60 * 60 * 24;\r\n          n.price = valuePrice;\r\n          n.roomItem = roomItemNow;\r\n          if (roomItemNow.parent)\r\n            for (const arg in roomItemNow.parent)\r\n              n[arg] = roomItemNow.parent[arg];\r\n          // 调用api\r\n          const api = new API();\r\n          api.set_timetable_period(n);\r\n          if (onClose) {\r\n            onClose(n);\r\n          }\r\n        }}>保存</Button>\r\n      </ListItem>\r\n    </List>\r\n  );\r\n}\r\n\r\nTimetablePeriodList.propTypes = {\r\n  period: PropTypes.object,\r\n  onClose: PropTypes.func\r\n};\r\n\r\nexport default TimetablePeriodList;","import React from 'react';\r\nimport { TextField, List, ListItem, ListItemText, ListItemIcon, ListItemSecondaryAction, IconButton, Button } from '@material-ui/core';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport AlarmOnIcon from '@material-ui/icons/AlarmOn';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport PropTypes from 'prop-types';\r\nimport { parseTimePoint, parseTimePeriod, sleep } from '../utils/utils'\r\nimport TimetablePeriodList from './timetablePeriodList';\r\nimport { API } from '../api/api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  nested: {\r\n    paddingLeft: theme.spacing(4),\r\n  },\r\n  secondaryIcon: {\r\n    // paddingRight: theme.spacing(4),\r\n  }\r\n}));\r\n\r\nconst api = new API();\r\n\r\nfunction TimetablePeriod(props) {\r\n  const classes = useStyles();\r\n  const { period, onClose } = props;\r\n  const [open, setOpen] = React.useState(false);\r\n  const handleClick = () => {\r\n    setOpen(!open);\r\n  };\r\n  const getSecondaryText = () => {\r\n    return `${period.periodId}/${period.roomItem.roomType}/调整至:${period.price}/下次调整:${parseTimePoint(period.time_start)}/下次调整结束:${parseTimePoint(period.time_end)}/周期:${period.cycle > 0 ? parseTimePeriod(period.cycle) : \"单次\"}/${period.avaliable ? \"可用\" : \"不可用\"}`\r\n  };\r\n  return (\r\n    <div>\r\n      <ListItem button onClick={handleClick}>\r\n        <ListItemIcon><AlarmOnIcon /></ListItemIcon>\r\n        <ListItemText primary={period.itemName} secondary={getSecondaryText()} />\r\n        <div className={classes.secondaryIcon}>\r\n          {open ? <ExpandLessIcon /> : <ExpandMoreIcon />}\r\n        </div>\r\n        <ListItemSecondaryAction>\r\n          <IconButton edge=\"end\" onClick={async () => {\r\n            if (period.tid) await api.delete_tid(period.tid);\r\n          }}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n        <TimetablePeriodList roomItemNow={period.roomItem} period={period} onClose={period => {\r\n          console.log('onClose', period);\r\n          if (onClose) onClose();\r\n          setOpen(false);\r\n        }} />\r\n      </Collapse>\r\n    </div>\r\n  );\r\n}\r\n\r\nTimetablePeriod.propTypes = {\r\n  period: PropTypes.object.isRequired,\r\n  onClose: PropTypes.func\r\n};\r\n\r\nexport default TimetablePeriod;","import React from 'react'\r\nimport Container from '@material-ui/core/Container';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport PropTypes from 'prop-types';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { setConfig } from \"../data/action\"\r\nimport TimetableNodeList from '../components/timetableNodeList';\r\nimport { DialogContent } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    marginTop: \"20%\",\r\n    marginBottom: \"20%\"\r\n  }\r\n}));\r\n\r\nfunction TimetableNodeAddDialog(props) {\r\n  const classes = useStyles();\r\n  const { onClose, open, roomItemNow } = props;\r\n\r\n  const handleClose = () => {\r\n    if (onClose)\r\n      onClose();\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={open} fullWidth>\r\n      <DialogTitle>添加一个时间点</DialogTitle>\r\n      <DialogContent>\r\n        <TimetableNodeList roomItemNow={roomItemNow} onClose={n => {\r\n          console.log(n);\r\n          onClose();\r\n        }} node={{}} />\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nTimetableNodeAddDialog.propTypes = {\r\n  onClose: PropTypes.func,\r\n  open: PropTypes.bool.isRequired,\r\n  roomItemNow: PropTypes.object\r\n};\r\n\r\nexport default TimetableNodeAddDialog;","import React from 'react'\r\nimport Container from '@material-ui/core/Container';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport PropTypes from 'prop-types';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { setConfig } from \"../data/action\"\r\nimport TimetablePeriodList from '../components/timetablePeriodList';\r\nimport { DialogContent } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    marginTop: \"20%\",\r\n    marginBottom: \"20%\"\r\n  }\r\n}));\r\n\r\nfunction TimetablePeriodAddDialog(props) {\r\n  const classes = useStyles();\r\n  const { onClose, open, roomItemNow } = props;\r\n\r\n  const handleClose = () => {\r\n    if (onClose)\r\n      onClose();\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={open} fullWidth>\r\n      <DialogTitle>添加一个时间段</DialogTitle>\r\n      <Divider></Divider>\r\n      <DialogContent>\r\n        <TimetablePeriodList roomItemNow={roomItemNow} onClose={n => {\r\n          console.log(n);\r\n          onClose();\r\n        }} period={{}} />\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nTimetablePeriodAddDialog.propTypes = {\r\n  onClose: PropTypes.func,\r\n  open: PropTypes.bool.isRequired,\r\n};\r\n\r\nexport default TimetablePeriodAddDialog;","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, Divider, List, ListSubheader, Typography } from \"@material-ui/core\";\r\nimport TimetableNode from \"../components/timetableNode\"\r\nimport TimetablePeriod from \"../components/timetablePeriod\"\r\nimport { API } from \"../api/api\"\r\nimport TimetableNodeAddDialog from \"./timetableNodeAddDialog\";\r\nimport TimetablePeriodAddDialog from \"./timetablePeriodAddDialog\";\r\nimport store from '../data/store'\r\nimport { setTimetablePeriods, setTimetableNodes } from \"../data/action\";\r\n\r\nclass PlanTime extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.roomItemNow = props.roomItemNow ? props.roomItemNow : {};\r\n    const storeState = store.getState();\r\n    this.state = {\r\n      nodeAddOpen: false,\r\n      periodAddOpen: false,\r\n      timetableNodes: storeState.timetableNodes,\r\n      timetablePeriods: storeState.timetablePeriods,\r\n    };\r\n    this.unsubscribe = store.subscribe(() => {\r\n      const storeState = store.getState();\r\n      this.setState({\r\n        timetableNodes: storeState.timetableNodes,\r\n        timetablePeriods: storeState.timetablePeriods\r\n      });\r\n    });\r\n    this.updateData();\r\n  }\r\n  componentWillUnmount() {\r\n    this.unsubscribe();\r\n  }\r\n  async updateData() {\r\n    const api = new API();\r\n    await api.get_timetable_node().then(nodes => { store.dispatch(setTimetableNodes(nodes)); });\r\n    await api.get_timetable_period().then(periods => { store.dispatch(setTimetablePeriods(periods)); });\r\n  }\r\n  render() {\r\n    return (<Container>\r\n      <List subheader={<ListSubheader component=\"div\">\r\n        按时间点管理\r\n        {JSON.stringify(this.roomItemNow) === '{}' ? undefined : <Button style={{ float: 'right' }} color=\"primary\" variant=\"contained\" onClick={async () => {\r\n          this.setState({\r\n            nodeAddOpen: true\r\n          });\r\n        }}>增加</Button>}\r\n      </ListSubheader>}>\r\n        {this.state.timetableNodes.length == 0 ? <Typography variant=\"body1\">（空列表）</Typography> : this.state.timetableNodes.map((node, i) => this.roomItemNow.itemId ? (node.roomItem.itemId === this.roomItemNow.itemId ? <TimetableNode key={i} node={node} /> : undefined) : <TimetableNode key={i} node={node} />)}\r\n      </List>\r\n      <List subheader={<ListSubheader component=\"div\">\r\n        按时间段管理\r\n        {JSON.stringify(this.roomItemNow) === '{}' ? undefined : <Button style={{ float: 'right' }} color=\"primary\" variant=\"contained\" onClick={async () => {\r\n          this.setState({\r\n            periodAddOpen: true\r\n          });\r\n        }}>增加</Button>}\r\n      </ListSubheader>}>\r\n        {this.state.timetablePeriods.length == 0 ? <Typography variant=\"body1\">（空列表）</Typography> : this.state.timetablePeriods.map((period, i) => this.roomItemNow.itemId ? (period.roomItem.itemId === this.roomItemNow.itemId ? <TimetablePeriod key={i} period={period} /> : undefined) : <TimetablePeriod key={i} period={period} />)}\r\n      </List>\r\n      <TimetableNodeAddDialog roomItemNow={this.roomItemNow} open={this.state.nodeAddOpen} onClose={() => {\r\n        this.setState({\r\n          nodeAddOpen: false\r\n        });\r\n        this.updateData();\r\n      }} />\r\n      <TimetablePeriodAddDialog roomItemNow={this.roomItemNow} open={this.state.periodAddOpen} onClose={() => {\r\n        this.setState({\r\n          periodAddOpen: false\r\n        });\r\n        this.updateData();\r\n      }} />\r\n    </Container >);\r\n  }\r\n}\r\n\r\nexport default PlanTime;","import React from 'react';\r\nimport { Switch, TextField, List, ListItem, ListItemText, ListItemIcon, ListItemSecondaryAction, IconButton, Button, FormControl, InputLabel, Select, MenuItem, Typography } from '@material-ui/core';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport AlarmOnIcon from '@material-ui/icons/AlarmOn';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport PropTypes from 'prop-types';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\nimport { parseTimePoint, parseTimePeriod, sleep } from '../utils/utils'\r\nimport RoomItemList from './roomItemList';\r\nimport { API } from '../api/api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  nested: {\r\n    paddingLeft: theme.spacing(4),\r\n  },\r\n}));\r\n\r\nfunction RoomStockPlanList(props) {\r\n  const classes = useStyles();\r\n  const { stock, onClose, roomItemNow } = props;\r\n  const [valueValue, setValueValue] = React.useState(stock.value || \"\");\r\n  const [planType, setPlanType] = React.useState(stock.planType || \"lt\");\r\n  const planTypeText = [\r\n    ['lt', '小于'], ['le', '小于等于'], ['gt', '大于'], ['ge', '大于等于'],\r\n  ];\r\n  const [selectAvailableStartDate, handleAvailableStrartDateChange] = React.useState(stock.available_start ? stock.available_start : 0);\r\n  const [selectAvailableEndDate, handleAvailableEndDateChange] = React.useState(stock.available_end ? stock.available_end : 0);\r\n  const [selectAvailableStartDateOn, setSelectAvailableStartDateOn] = React.useState(selectAvailableStartDate === 0 ? false : true);\r\n  const [selectAvailableEndDateOn, setSelectAvailableEndDateOn] = React.useState(selectAvailableEndDate === 0 ? false : true);\r\n  const [roomItemListOpen, setRoomItemListOpen] = React.useState(false);\r\n  const [valuePrice, setValuePrice] = React.useState(stock.price ? ('' + stock.price) : (roomItemNow ? ('' + roomItemNow.price) : '0'));\r\n  const [errorMessage, setErrorMessage] = React.useState('');\r\n  // console.log('StockList: roomItenNow = ', roomItemNow);\r\n  return (\r\n    <List component=\"div\" disablePadding className={classes.nested}>\r\n      <ListItem button onClick={() => { setRoomItemListOpen(!roomItemListOpen); }}>\r\n        <ListItemText primary=\"对应房间项目\" />\r\n      </ListItem>\r\n      <Collapse in={roomItemListOpen} timeout=\"auto\" unmountOnExit className={classes.nested}>\r\n        <RoomItemList roomItemNow={roomItemNow} />\r\n      </Collapse>\r\n      <ListItem>\r\n        <ListItemText primary=\"调整至\" />\r\n        <ListItemSecondaryAction>\r\n          <TextField label=\"输入价格\" defaultValue={valuePrice} onChange={(e) => {\r\n            setValuePrice(e.target.value);\r\n          }} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"选择触发类型\" />\r\n        <ListItemSecondaryAction>\r\n          <FormControl>\r\n            <InputLabel>触发类型</InputLabel>\r\n            <Select\r\n              value={planType}\r\n              onChange={(e) => { setPlanType(e.target.value); }}\r\n            >\r\n              {planTypeText.map((v, i) => <MenuItem key={i} value={v[0]}>{v[1]}</MenuItem>)}\r\n            </Select>\r\n          </FormControl>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"库存值\" />\r\n        <ListItemSecondaryAction>\r\n          <TextField label=\"和触发类型配合\" defaultValue={valueValue} onChange={(e) => {\r\n            setValueValue(e.target.value);\r\n          }} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"生效时间之外项目无效，不设置即全部生效\" />\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"启用生效开始时间\" />\r\n        <ListItemSecondaryAction>\r\n          <Switch checked={selectAvailableStartDateOn} onChange={e => {\r\n            if (e.target.checked) handleAvailableStartDateChange(0);\r\n            setSelectAvailableStartDateOn(e.target.checked);\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      {selectAvailableStartDateOn ? <ListItem className={classes.nested}>\r\n        <ListItemText primary=\"设置时间\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker\r\n            value={selectAvailableStartDate}\r\n            onChange={handleAvailableStartDateChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem> : undefined}\r\n      <ListItem>\r\n        <ListItemText primary=\"启用生效结束时间\" />\r\n        <ListItemSecondaryAction>\r\n          <Switch checked={selectAvailableEndDateOn} onChange={e => {\r\n            if (e.target.checked) handleAvailableEndDateChange(0);\r\n            setSelectAvailableEndDateOn(e.target.checked)\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      {selectAvailableEndDateOn ? <ListItem className={classes.nested}>\r\n        <ListItemText primary=\"设置时间\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <DateTimePicker\r\n            value={selectAvailableEndDate}\r\n            onChange={handleAvailableEndDateChange} />\r\n        </ListItemSecondaryAction>\r\n      </ListItem> : undefined}\r\n      {errorMessage ? <ListItem>\r\n        {/* <ListItemText primary={errorMessage} color=\"error\"></ListItemText> */}\r\n        <Typography color=\"error\">{errorMessage}</Typography>\r\n      </ListItem> : undefined}\r\n      <ListItem>\r\n        <Button variant=\"contained\" fullWidth onClick={() => {\r\n          let n = stock ? stock : {};\r\n          n.available_start = selectAvailableStartDate._d ? selectAvailableStartDate._d.getTime() : selectAvailableStartDate;\r\n          n.available_end = selectAvailableEndDate._d ? selectAvailableEndDate._d.getTime() : selectAvailableEndDate;\r\n          if (n.available_start === 0) n.available_start = new Date().getTime();\r\n          if (n.available_end === 0) n.available_end = new Date().getTime();\r\n          if (!selectAvailableStartDateOn) delete n.available_start;\r\n          if (!selectAvailableEndDateOn) delete n.available_end;\r\n          console.log(n);\r\n          n.price = valuePrice;\r\n          n.value = valueValue;\r\n          n.planType = planType;\r\n          n.roomItem = roomItemNow;\r\n          if (!valueValue) {\r\n            setErrorMessage(\"请设置正确的数值\");\r\n            return;\r\n          }\r\n          if (roomItemNow.parent)\r\n            for (const arg in roomItemNow.parent)\r\n              n[arg] = roomItemNow.parent[arg];\r\n          // 调用api\r\n          const api = new API();\r\n          api.set_room_stock_plan(n);\r\n          if (onClose) {\r\n            onClose(n);\r\n          }\r\n        }}>保存</Button>\r\n      </ListItem>\r\n    </List>\r\n  );\r\n}\r\n\r\nRoomStockPlanList.propTypes = {\r\n  stock: PropTypes.object,\r\n  onClose: PropTypes.func\r\n};\r\n\r\nexport default RoomStockPlanList;","import React from 'react';\r\nimport { TextField, List, ListItem, ListItemText, ListItemIcon, ListItemSecondaryAction, IconButton, Button } from '@material-ui/core';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport AlarmOnIcon from '@material-ui/icons/AlarmOn';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport PropTypes from 'prop-types';\r\nimport { DateTimePicker } from '@material-ui/pickers';\r\nimport { parseTimePoint, parseTimePeriod, sleep } from '../utils/utils';\r\nimport RoomStockPlanList from './roomStockPlanList';\r\nimport { API } from '../api/api';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  nested: {\r\n    paddingLeft: theme.spacing(4),\r\n  },\r\n  secondaryIcon: {\r\n    // paddingRight: theme.spacing(4),\r\n  }\r\n}));\r\n\r\nconst api = new API();\r\n\r\nfunction RoomStockPlan(props) {\r\n  const classes = useStyles();\r\n  const { stock, onClose } = props;\r\n  const [open, setOpen] = React.useState(false);\r\n  const handleClick = () => {\r\n    setOpen(!open);\r\n  };\r\n  const planTypeName = {\r\n    'lt': \"小于\", \"le\": \"小于等于\", 'gt': '大于', 'ge': '大约等于'\r\n  };\r\n  const getSecondaryText = () => {\r\n    return `${stock.roomItem.roomType}/库存${planTypeName[stock.planType]}${stock.value}/调整至:${stock.price}/下次调整:${parseTimePoint(stock.time_)}/周期:${stock.cycle > 0 ? parseTimePeriod(stock.cycle) : \"单次\"}/${(stock.avaliable !== false) ? \"可用\" : \"不可用\"}`\r\n  };\r\n  return (\r\n    <div>\r\n      <ListItem button onClick={handleClick}>\r\n        <ListItemIcon><AlarmOnIcon /></ListItemIcon>\r\n        <ListItemText primary={stock.itemName} secondary={getSecondaryText()} />\r\n        <div className={classes.secondaryIcon}>\r\n          {open ? <ExpandLessIcon /> : <ExpandMoreIcon />}\r\n        </div>\r\n        <ListItemSecondaryAction>\r\n          <IconButton edge=\"end\" onClick={async () => {\r\n            if (stock.tid) await api.delete_tid(stock.tid);\r\n          }}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <Collapse in={open} timeout=\"auto\" unmountOnExit>\r\n        <RoomStockPlanList roomItemNow={stock.roomItem} stock={stock} onClose={stock => {\r\n          console.log('onClose', stock, onClose);\r\n          setOpen(false);\r\n          if (onClose) onClose();\r\n        }} />\r\n      </Collapse>\r\n    </div>\r\n  );\r\n}\r\n\r\nRoomStockPlan.propTypes = {\r\n  stock: PropTypes.object.isRequired,\r\n  onClose: PropTypes.func\r\n};\r\n\r\nexport default RoomStockPlan;","import React from 'react'\r\nimport Container from '@material-ui/core/Container';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport PropTypes from 'prop-types';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport { setConfig } from \"../data/action\"\r\n\r\nimport { DialogContent } from '@material-ui/core';\r\nimport RoomStockPlanList from '../components/roomStockPlanList';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    marginTop: \"20%\",\r\n    marginBottom: \"20%\"\r\n  }\r\n}));\r\n\r\nfunction RoomStockPlanAddDialog(props) {\r\n  const classes = useStyles();\r\n  const { onClose, open, roomItemNow } = props;\r\n\r\n  const handleClose = () => {\r\n    if (onClose)\r\n      onClose();\r\n  };\r\n\r\n  return (\r\n    <Dialog onClose={handleClose} open={open} fullWidth>\r\n      <DialogTitle>添加一个库存管理</DialogTitle>\r\n      <DialogContent>\r\n        <RoomStockPlanList roomItemNow={roomItemNow} onClose={n => {\r\n          console.log('add room stock plan', n);\r\n          onClose();\r\n        }} stock={{}} />\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nRoomStockPlanAddDialog.propTypes = {\r\n  onClose: PropTypes.func,\r\n  open: PropTypes.bool.isRequired,\r\n  roomItemNow: PropTypes.object\r\n};\r\n\r\nexport default RoomStockPlanAddDialog;","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, Divider, List, ListSubheader, Typography } from \"@material-ui/core\";\r\nimport { API } from \"../api/api\"\r\nimport store from '../data/store'\r\nimport { setRoomStockPlans } from \"../data/action\";\r\nimport RoomStockPlan from \"../components/roomStockPlan\";\r\nimport RoomStockPlanAddDialog from \"./roomStockPlanAddDialog\";\r\n\r\nclass PlanStock extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.roomItemNow = props.roomItemNow ? props.roomItemNow : {};\r\n    const storeState = store.getState();\r\n    this.state = {\r\n      stockAddOpen: false,\r\n      periodAddOpen: false,\r\n      roomStockPlan: storeState.roomStockPlans\r\n    };\r\n    this.unsubscribe = store.subscribe(() => {\r\n      const storeState = store.getState();\r\n      this.setState({\r\n        roomStockPlan: storeState.roomStockPlans\r\n      });\r\n    });\r\n    this.updateData();\r\n  }\r\n  componentWillUnmount() {\r\n    this.unsubscribe();\r\n  }\r\n  async updateData() {\r\n    const api = new API();\r\n    await api.get_room_stock_plan().then(stocks => { store.dispatch(setRoomStockPlans(stocks)); });\r\n  }\r\n  render() {\r\n    return (<Container>\r\n      <List subheader={<ListSubheader component=\"div\">\r\n        按库存状态管理\r\n        {JSON.stringify(this.roomItemNow) === '{}' ? undefined : <Button style={{ float: 'right' }} color=\"primary\" variant=\"contained\" onClick={async () => {\r\n          this.setState({\r\n            stockAddOpen: true\r\n          });\r\n        }}>增加</Button>}\r\n      </ListSubheader>}>\r\n        {this.state.roomStockPlan.length == 0 ? <Typography variant=\"body1\">（空列表）</Typography> : this.state.roomStockPlan.map((stock, i) => this.roomItemNow.itemId ? (stock.roomItem.itemId === this.roomItemNow.itemId ? <RoomStockPlan key={i} stock={stock} /> : undefined) : <RoomStockPlan key={i} stock={stock} />)}\r\n      </List>\r\n      <RoomStockPlanAddDialog roomItemNow={this.roomItemNow} open={this.state.stockAddOpen} onClose={() => {\r\n        this.setState({\r\n          stockAddOpen: false\r\n        });\r\n        this.updateData();\r\n      }} />\r\n    </Container >);\r\n  }\r\n}\r\n\r\nexport default PlanStock;","import React from 'react';\r\nimport { Box, Container, LinearProgress, Button, Dialog, Link, List, ListItemText, DialogTitle, DialogContent, ListItem } from '@material-ui/core';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { API } from '../api/api';\r\nimport store from '../data/store';\r\nimport { setReserveTableData } from '../data/action'\r\nimport PlanTime from '../pages/planTime';\r\nimport PlanStock from '../pages/planStock';\r\n\r\nconst useStyles = makeStyles({\r\n  table: {\r\n    minWidth: 1200,\r\n  },\r\n  foodDesc: {\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    contentOverflow: 'ellipsis',\r\n    maxWidth: 160\r\n  },\r\n  planButton: {\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    contentOverflow: 'ellipsis',\r\n    maxWidth: 160\r\n  }\r\n});\r\n\r\nfunction MyTableCell(props) {\r\n  let styles = { padding: 3 };\r\n  // console.log('props.noBorder', props.noBorder);\r\n  if (props.noBorder) styles.borderBottom = \"0\";\r\n  return <TableCell align={props.align} colSpan={props.colSpan} style={styles}>{props.content}</TableCell>\r\n}\r\n\r\nconst api = new API();\r\n\r\n// 容易subscribe到已经卸载的component上面...\r\n// store.subscribe(() => {\r\n//   console.log('(tables) redux update to', store.getState());\r\n// });\r\n\r\nlet requestedDayData = null;\r\nlet roomItemNow = {};\r\nlet setUpdateTimer = null;\r\n\r\nfunction ReserveTable(props) {\r\n  const classes = useStyles();\r\n  const { day, data } = props;\r\n  const date = new Date().setDay(day).toDateString();\r\n  // const [dayData, setDayData] = React.useState(data ? data : store.getState().reserveTableData[date]);\r\n  const [dayData, setDayData] = React.useState(data);\r\n  const [roomList, setRoomList] = React.useState(store.getState().reserveTableData[date] ? store.getState().reserveTableData[date].roomList : []);\r\n  const [addPlanOpen, setAddPlanOpen] = React.useState(false);\r\n  const [planManagerOpen, setPlanManagerOpen] = React.useState(false);\r\n\r\n  requestedDayData = JSON.stringify(store.getState().reserveTableData[date]) !== '{}' && JSON.stringify(store.getState().reserveTableData[date]) !== undefined;\r\n  // console.log('requested', requestedDayData);\r\n  console.log('date', date);\r\n\r\n  const Period = function (props) {\r\n    const classes = useStyles();\r\n    const { data, roomList } = props;\r\n    // console.log('period', data, 'roomList', roomList);\r\n    // 先找到有几个row，再格式化输出\r\n    let maxRow = 0;\r\n    let roomNameList = [];\r\n    roomList.map((roomData, i) => {\r\n      maxRow = maxRow > data.roomMapItemEntry[roomData.roomName].length ? maxRow : data.roomMapItemEntry[roomData.roomName].length;\r\n      roomNameList.push(roomData.roomName);\r\n    });\r\n    // console.log('maxRow', maxRow);\r\n    let targetRowCenter = parseInt(maxRow / 2);\r\n    if (targetRowCenter < 0) targetRowCenter = 0;\r\n    // console.log('targetRowCenter', targetRowCenter);\r\n    let rows = [];\r\n    for (let i = 0; i < maxRow; i++) {\r\n      let cells = [<MyTableCell key=\"time\" key2=\"time\" align=\"center\" colSpan={1} content={targetRowCenter === i ? data.periodId : null} noBorder={maxRow - 1 !== i}></MyTableCell>,];\r\n      for (let name of roomNameList) {\r\n        // if (!(data.roomMapItemEntry[name] instanceof Array)) {\r\n        if (!(data.roomMapItemEntry[name][i])) {\r\n          // 没这个项的话也要占个位置\r\n          cells.push(<MyTableCell key={data.periodId + name + i + '_'} colSpan={1}></MyTableCell>);\r\n          continue;\r\n        }\r\n        let roomItem = data.roomMapItemEntry[name][i];\r\n        // 价格\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'price'} align=\"center\" colSpan={1} content={'￥' + roomItem.price}></MyTableCell>);\r\n        // 说明\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'desc'} align=\"center\" colSpan={1} content={<Box component=\"div\" className={classes.foodDesc}>\r\n          {roomItem.foodDesc}</Box>}></MyTableCell>);\r\n        // 库存\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'stock'} align=\"center\" colSpan={1} content={i === targetRowCenter ? (roomItem.stock + '间') : ''} noBorder={maxRow - 1 !== i}></MyTableCell>);\r\n        // 计划\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'plan'} align=\"center\" colSpan={1} content={\r\n          (() => {\r\n            let planCount = 0;\r\n            // 查找\r\n            const { timetableNodes, timetablePeriods, roomStockPlans } = store.getState();\r\n            for (let node of timetableNodes) {\r\n              if (!node.roomItem) continue;\r\n              if (node.roomItem.itemId === roomItem.itemId) {\r\n                planCount++;\r\n              }\r\n            }\r\n            for (let stock of roomStockPlans) {\r\n              if (!stock.roomItem) continue;\r\n              if (stock.roomItem.itemId === roomItem.itemId) {\r\n                planCount++;\r\n              }\r\n            }\r\n            for (let period of timetablePeriods) {\r\n              if (!period.roomItem) continue;\r\n              if (period.roomItem.itemId === roomItem.itemId) {\r\n                planCount++;\r\n              } else {\r\n                // console.log('irr', period, roomItem);\r\n              }\r\n            }\r\n            // console.log('planCount', planCount);\r\n            return (<Link key={data.periodId + name + roomItem.itemId + i + 'planLink'} onClick={() => {\r\n              // console.log('roomItem', roomItem);\r\n              // console.log('data', data);\r\n              let parent = {};\r\n              for (const arg in data)\r\n                if (arg !== 'roomMapItemEntry')\r\n                  parent[arg] = data[arg];\r\n              roomItem.parent = parent;\r\n              roomItemNow = roomItem;\r\n              setPlanManagerOpen(true);\r\n            }} href=\"#!\" className={classes.planButton}>计划{planCount > 0 ? (`(${planCount})`) : ''}</Link>);\r\n          })()\r\n        }></MyTableCell>);\r\n        // 临时下线\r\n        // cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'off'} align=\"center\" colSpan={1} content={\r\n        //   <Link key={data.periodId + name + roomItem.itemId + i + 'planLink'} onClick={() => {\r\n        //     console.log('roomItem', roomItem);\r\n        //   }} href=\"#!\">下线</Link>\r\n        // }></MyTableCell>);\r\n      }\r\n      // console.log('cells', cells);\r\n      rows.push(<TableRow key={data.periodId + i}>{cells}</TableRow>);\r\n    }\r\n    return rows;\r\n  }\r\n\r\n  const AddPlanTypeSelector = function (props) {\r\n    const { open, onClose } = props;\r\n    return (<Dialog open={open} onClose={onClose}>\r\n      <DialogTitle>选择计划类型</DialogTitle>\r\n      <DialogContent>\r\n        <List>\r\n          {[{ name: '按照时间点调整', val: 'timetableNode' }, { name: '按照时间段调整', val: 'timetablePeriod' }, { name: '按照库存调整', val: 'roomStock' }].map((d, i) =>\r\n            <ListItem button onClick={() => { onClose(d.val); }} key={i}>\r\n              <ListItemText primary={d.name} />\r\n            </ListItem>\r\n          )}\r\n        </List>\r\n      </DialogContent>\r\n    </Dialog>);\r\n  }\r\n\r\n  const PlanManager = function (props) {\r\n    const { open, onClose } = props;\r\n    return (<Dialog fullWidth open={open} onClose={onClose}>\r\n      <DialogTitle>管理计划</DialogTitle>\r\n      <DialogContent>\r\n        <PlanTime roomItemNow={roomItemNow} />\r\n        <PlanStock roomItemNow={roomItemNow} />\r\n      </DialogContent>\r\n    </Dialog>);\r\n  }\r\n\r\n  if (!setUpdateTimer) {\r\n    setUpdateTimer = true;\r\n    // 每分钟更新数据\r\n    setTimeout(() => {\r\n      if (!updateData) return;\r\n      updateData();\r\n    }, 60 * 1000);\r\n  }\r\n\r\n  const updateData = () => {\r\n    console.log('updating reserve table data!');\r\n    if (!requestedDayData) {\r\n      requestedDayData = true;\r\n      api.get_reserve_table(date).then(reserveTableData => {\r\n        // console.log('reserveTableData', reserveTableData);\r\n        let t = store.getState().reserveTableData;\r\n        t[date] = reserveTableData;\r\n        store.dispatch(setReserveTableData(t));\r\n        setDayData(reserveTableData);\r\n        setRoomList(reserveTableData.roomList);\r\n        requestedDayData = false;\r\n      })\r\n    } else {\r\n      let reserveTableData = store.getState().reserveTableData[date];\r\n      // console.log('got from redux:', reserveTableData);\r\n      if (reserveTableData) {\r\n        setDayData(reserveTableData);\r\n        setRoomList(reserveTableData.roomList);\r\n        // 也是要请求一遍的\r\n        api.get_reserve_table(date).then(reserveTableData_ => {\r\n          let t_ = store.getState().reserveTableData;\r\n          t_[date] = reserveTableData_;\r\n          store.dispatch(setReserveTableData(t_));\r\n        });\r\n      } else {\r\n        // console.warn('got empty reserveTableData', dayData, store.getState().reserveTableData, date, JSON.stringify(store.getState().reserveTableData[date]));\r\n      }\r\n    }\r\n  };\r\n\r\n  if (!dayData) {\r\n    updateData();\r\n    return (<Container>\r\n      <LinearProgress></LinearProgress>\r\n    </Container>);\r\n  }\r\n  let tableHeaderCells = [<TableCell key=\"time\" align=\"center\" colSpan={1}>时间</TableCell>,];\r\n  roomList.map((d, i) => {\r\n    tableHeaderCells.push(<TableCell key={'a' + d + i} align=\"center\" colSpan={2}>售卖内容</TableCell>);\r\n    tableHeaderCells.push(<TableCell key={'b' + d + i} align=\"center\" colSpan={1}>库存</TableCell>);\r\n    tableHeaderCells.push(<TableCell key={'c' + d + i} align=\"center\" colSpan={1}>计划</TableCell>);\r\n    // tableHeaderCells.push(<TableCell key={'d' + d + i} align=\"center\" colSpan={1}>临时下线</TableCell>);\r\n  });\r\n  const tableHeader = <TableHead>\r\n    <TableRow>\r\n      <TableCell align=\"center\" colSpan={1}>[{'周' + [\"日\", '一', '二', '三', '四', '五', '六'][day]}]</TableCell>\r\n      {roomList.map((d, i) =>\r\n        <TableCell align=\"center\" key={i} colSpan={5}>{d.roomName}({d.roomCapacity})</TableCell>\r\n      )}\r\n    </TableRow>\r\n    <TableRow>\r\n      {tableHeaderCells}\r\n    </TableRow>\r\n  </TableHead>;\r\n  if (!dayData || !dayData.periodList) {\r\n    // console.log('no data!', dayData, typeof (dayData));\r\n    return (<Container>\r\n      <header></header>\r\n      <LinearProgress></LinearProgress>\r\n    </Container>);\r\n  }\r\n  return (\r\n    <Container>\r\n      <TableContainer component={Paper}>\r\n        <Table stickyHeader className={classes.table}>\r\n          {tableHeader}\r\n          <TableBody>\r\n            {dayData.periodList.map((d, i) =>\r\n              <Period key={'period' + i} data={d} roomList={roomList}></Period>\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      <AddPlanTypeSelector open={addPlanOpen} onClose={(d) => {\r\n        switch (d) {\r\n          case 'timetableNode':\r\n\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n        setAddPlanOpen(false);\r\n      }} />\r\n      <PlanManager open={planManagerOpen} onClose={() => { setPlanManagerOpen(false); }} />\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default ReserveTable;","import React from 'react'\r\nimport { LinearProgress, Button, Container, Dialog, DialogTitle, IconButton } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport PropTypes from 'prop-types';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Box from '@material-ui/core/Box';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport ReserveTable from './reserveTable';\r\nimport { API } from '../api/api';\r\nimport store from '../data/store';\r\nimport { setReserveTableData } from '../data/action'\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index, ...other } = props;\r\n\r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`scrollable-auto-tabpanel-${index}`}\r\n      aria-labelledby={`scrollable-auto-tab-${index}`}\r\n      {...other}\r\n    >\r\n      {value === index && (\r\n        <Box>\r\n          {/* <Typography>{children}</Typography> */}\r\n          {children}\r\n        </Box>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nTabPanel.propTypes = {\r\n  children: PropTypes.node,\r\n  index: PropTypes.any.isRequired,\r\n  value: PropTypes.any.isRequired,\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    overflowX: 'auto',\r\n    display: 'block',\r\n    width: '100%',\r\n    flexGrow: 1,\r\n    width: '100%',\r\n    backgroundColor: theme.palette.background.paper,\r\n  },\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 120,\r\n  },\r\n  selectEmpty: {\r\n    marginTop: theme.spacing(2),\r\n  },\r\n}));\r\n\r\nfunction a11yProps(index) {\r\n  return {\r\n    id: `scrollable-auto-tab-${index}`,\r\n    'aria-controls': `scrollable-auto-tabpanel-${index}`,\r\n  };\r\n}\r\n\r\nexport default function ReserveTables(props) {\r\n  const classes = useStyles();\r\n  const [tabValue, setTableValue] = React.useState(new Date().getDay());\r\n  const [showTable, setShowTable] = React.useState(false);\r\n  const [fullShow, setFullShow] = React.useState(false);\r\n  const handleChange = (event) => {\r\n    setTableValue(event.target.value);\r\n  };\r\n  const table = <div className={classes.root}>\r\n    <Tabs\r\n      value={tabValue}\r\n      onChange={(e, val) => setTableValue(val)}\r\n      indicatorColor=\"primary\"\r\n      textColor=\"primary\"\r\n      variant=\"scrollable\"\r\n      scrollButtons=\"auto\"\r\n      aria-label=\"scrollable auto tabs example\"\r\n    >\r\n      {[\"日\", '一', '二', '三', '四', '五', '六'].map((d, i) => {\r\n        return (<Tab label={'周' + d} key={i} {...a11yProps(i)} />);\r\n      })}\r\n    </Tabs>\r\n    {[0, 1, 2, 3, 4, 5, 6].map((d, i) => <TabPanel key={i} value={tabValue} index={d}>\r\n      <ReserveTable day={tabValue}></ReserveTable>\r\n    </TabPanel>)}\r\n  </div>;\r\n  return (\r\n    // <Container className={classes.root}>\r\n    <div>\r\n      <FormControl className={classes.formControl}>\r\n        <InputLabel>选择日期</InputLabel>\r\n        <Select\r\n          value={tabValue}\r\n          onChange={handleChange}\r\n        >\r\n          {['日', '一', '二', '三', '四', '五', '六'].map((d, i) => <MenuItem key={i} value={i}>{'周' + d}</MenuItem>)}\r\n        </Select>\r\n      </FormControl>\r\n      <IconButton style={{ float: 'right' }} variant=\"contained\" onClick={() => {\r\n        setShowTable(true);\r\n        setFullShow(true);\r\n      }}><FullscreenIcon /></IconButton>\r\n      { window.innerWidth >= 600 ? table : <Button fullWidth variant=\"contained\" onClick={() => { setShowTable(!showTable); }}>点击{showTable ? \"隐藏\" : \"显示\"}表格</Button>}\r\n      <Dialog fullScreen={fullShow} onClose={() => { setShowTable(false); }} open={showTable}>\r\n        <DialogTitle>\r\n          <Box component=\"span\">周{['日', '一', '二', '三', '四', '五', '六'][tabValue]}({new Date().setDay(tabValue).toDateString()})数据</Box>\r\n          {fullShow ? <IconButton edge=\"end\" style={{ float: 'right' }} onClick={() => {\r\n            setFullShow(false);\r\n            setShowTable(false);\r\n          }}><FullscreenExitIcon /></IconButton> : <IconButton style={{ float: 'right' }} variant=\"contained\" onClick={() => {\r\n            setShowTable(true);\r\n            setFullShow(true);\r\n          }}><FullscreenIcon /></IconButton>}</DialogTitle>\r\n        {table}\r\n      </Dialog>\r\n      {/* </Container > */}\r\n    </div>\r\n  );\r\n\r\n}\r\n\r\n","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport ReserveTables from \"../components/reserveTables\";\r\nimport { Divider, Table, TableBody, TableCell, TableRow, Typography } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\n\r\nclass StateNow extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = store.getState();\r\n    this.unsubscribe = store.subscribe(() => {\r\n      this.setState({\r\n        timetableNodes: store.getState().timetableNodes,\r\n        timetablePeriods: store.getState().timetablePeriods,\r\n        roomStockPlans: store.getState().roomStockPlans\r\n      });\r\n    });\r\n  }\r\n  componentWillUnmount() {\r\n    this.unsubscribe();\r\n  }\r\n  render() {\r\n    return (<Table>\r\n      <TableBody>\r\n        <TableRow>\r\n          <TableCell align=\"center\">任务种类数</TableCell>\r\n          <TableCell align=\"center\">按照时间点调整</TableCell>\r\n          <TableCell align=\"center\">按照时间段调整</TableCell>\r\n          <TableCell align=\"center\">按照库存量调整</TableCell>\r\n        </TableRow>\r\n        <TableRow>\r\n          <TableCell align=\"center\">{3}种</TableCell>\r\n          <TableCell align=\"center\">{this.state.timetableNodes.length}个任务</TableCell>\r\n          <TableCell align=\"center\">{this.state.timetablePeriods.length}个任务</TableCell>\r\n          <TableCell align=\"center\">{this.state.roomStockPlans.length}个任务</TableCell>\r\n        </TableRow>\r\n      </TableBody>\r\n    </Table>);\r\n  }\r\n}\r\n\r\nfunction Launch() {\r\n  return (<Container style={{ overflowX: 'auto', width: '100%' }}>\r\n    <Typography variant=\"h5\">执行状态</Typography>\r\n    <StateNow></StateNow>\r\n    <br />\r\n    <Typography variant=\"h5\">数据总览</Typography>\r\n    <ReserveTables />\r\n  </Container>);\r\n}\r\n\r\nexport default Launch;","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { funDownload } from \"../utils/utils\";\r\n\r\nfunction Settings(props) {\r\n  const [themeName, setThemeName] = React.useState(store.getState().config.data.theme_name);\r\n  const refConfigFileInput = React.useRef();\r\n  const [resetSettingsOpen, setResetSettingsOpen] = React.useState(false);\r\n  const [deleteDataOpen, setDeleteDataOpen] = React.useState(false);\r\n\r\n  const resetSettings = function() {\r\n    let c = store.getState().config;\r\n    c.data = c.data_default;\r\n    c.save();\r\n    c.load();\r\n    store.dispatch(setConfig(c));\r\n  }\r\n\r\n  return (<Container maxWidth=\"md\">\r\n    <List>\r\n      <ListSubheader>外观</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"主题设置\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <FormControl>\r\n            {/* <InputLabel></InputLabel> */}\r\n            <Select value={themeName} onChange={e => {\r\n              setThemeName(e.target.value);\r\n              let c = store.getState().config;\r\n              c.data.theme_name = e.target.value;\r\n              c.theme = c.theme_avaliable[c.data.theme_name];\r\n              c.save();\r\n              store.dispatch(setConfig(c));\r\n              setTimeout(() => { window.location.reload(); }, 200);\r\n            }}>\r\n              {store.getState().config.data.theme_avaliable.map((v, k) => <MenuItem key={k} value={v}>{v}</MenuItem>)}\r\n            </Select>\r\n          </FormControl>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListSubheader>数据管理</ListSubheader>\r\n      <ListItem button onClick={() => {\r\n        funDownload(store.getState().config.save(), `团购杀手配置数据(${new Date().toLocaleString()}).json`);\r\n      }}>\r\n        <ListItemText primary=\"数据导出\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        // console.log(refConfigFileInput)\r\n        refConfigFileInput.current.click();\r\n      }}>\r\n        <ListItemText primary=\"数据导入\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <input type=\"file\" accept=\".json\" hidden name=\"file-gbk-data\" ref={refConfigFileInput} onChange={e => {\r\n            // console.log(e);\r\n            let files = e.target.files;\r\n            if (files.length === 0) {\r\n              store.dispatch(setMessage(\"未选择文件\"));\r\n              return;\r\n            }\r\n            try {\r\n              let file = files[0];\r\n              let reader = new FileReader();\r\n              reader.readAsText(file, 'UTF-8');\r\n              reader.onload = evt => {\r\n                const fileData = evt.target.result;\r\n                try {\r\n                  const js = JSON.parse(fileData);\r\n                  if (!js.version_frontend) {\r\n                    store.dispatch(setMessage(\"文件类型错误或者文件已经损坏\"));\r\n                    return;\r\n                  }\r\n                  if (js.version_frontend > store.getState().config.data.version_frontend) {\r\n                    store.dispatch(setMessage(`存档文件版本(${js.version_frontend}高于当前版本${store.getState().config.data.version_frontend})，请更新到最新版`));\r\n                    return;\r\n                  }\r\n                  let c = store.getState().config;\r\n                  c.data = js;\r\n                  store.dispatch(setConfig(c));\r\n                  store.dispatch(setMessage(\"数据导入完成\"));\r\n                } catch (e) {\r\n                  store.dispatch(setErrorInfo(e));\r\n                }\r\n              };\r\n            } catch (e) {\r\n              store.dispatch(setErrorInfo(e));\r\n            }\r\n          }}></input>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置数据同步\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Switch defaultChecked={store.getState().config.data.settings_async} onChange={e => {\r\n            let c = store.getState().config;\r\n            c.data.settings_async = e.target.checked;\r\n            c.save();\r\n            store.dispatch(setConfig(c));\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setResetSettingsOpen(true)}>\r\n        <ListItemText primary=\"回到默认设置\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setDeleteDataOpen(true)}>\r\n        <ListItemText primary=\"删除所有数据\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>更新</ListSubheader>\r\n      <ListItem button onClick={() => {\r\n        store.dispatch(setMessage(\"暂无\"));\r\n      }}>\r\n        <ListItemText primary=\"检查更新\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"自动下载安装更新\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Switch disabled checked={false}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n    </List>\r\n    <Dialog open={resetSettingsOpen} onClose={() => setResetSettingsOpen(false)}>\r\n      <DialogTitle>\r\n        回到默认设置\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除所有设置数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setResetSettingsOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={deleteDataOpen} onClose={() => setDeleteDataOpen(false)}>\r\n      <DialogTitle>\r\n        删除所有数据\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除软件数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setDeleteDataOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  </Container>)\r\n}\r\n\r\nexport default Settings;","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport PropType from 'prop-types'\r\nimport {\r\n  Box, Button, Checkbox, Dialog, DialogActions, DialogContent,\r\n  DialogContentText, DialogTitle, FormControlLabel, Link, List,\r\n  ListItem, ListItemText, makeStyles, TextField, Typography\r\n} from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\nimport { AuthAPI } from '../api/api';\r\nimport { setConfig } from \"../data/action\";\r\n\r\nconst authApi = new AuthAPI();\r\n\r\nconst useStyles = makeStyles({\r\n  linkAction: {\r\n    padding: 5,\r\n  }\r\n});\r\n\r\nfunction RegistComp(props) {\r\n  const { onLogin } = props;\r\n  const [phone, setPhone] = React.useState(props.phone || '');\r\n  const [name, setName] = React.useState('');\r\n  const [email, setEmail] = React.useState('');\r\n  const [address, setAddress] = React.useState('');\r\n  const [password, setPassword] = React.useState(props.password || '');\r\n  const [passwordRepeate, setPasswordRepeate] = React.useState(props.password || '');\r\n  const [checked, setChecked] = React.useState(false);\r\n\r\n  const handleRegist = () => {\r\n    let user = { phone, name, address, email, password };\r\n  };\r\n\r\n  return (<Container maxWidth=\"sm\">\r\n    <Typography variant=\"h5\">用户注册</Typography>\r\n    <List>\r\n      <ListItem>\r\n        <TextField fullWidth variant=\"standard\" label=\"手机号\" helperText=\"手机号将作为登录依据，请勿遗忘。\" onChange={e => {\r\n          setPhone(e.target.value);\r\n        }}></TextField>\r\n      </ListItem>\r\n      <ListItem>\r\n        <TextField fullWidth variant=\"standard\" type=\"password\" label=\"密码\" helperText=\"至少8位，包含数字和英文字符。\" onChange={e => {\r\n          setPassword(e.target.value);\r\n        }}></TextField>\r\n      </ListItem>\r\n      <ListItem>\r\n        <TextField fullWidth variant=\"standard\" type=\"password\" label=\"再次输入密码\"\r\n          error={Boolean((password && passwordRepeate) && (passwordRepeate !== password))}\r\n          helperText={(password && passwordRepeate) && (passwordRepeate !== password) ? \"两次输入密码不一致\" : null} onChange={e => {\r\n            setPasswordRepeate(e.target.value);\r\n          }}></TextField>\r\n      </ListItem>\r\n      <ListItem>\r\n        <TextField fullWidth variant=\"standard\" label=\"地址\" helperText=\"输入准确的地址有助于软件的使用。\" onChange={e => {\r\n          setAddress(e.target.value);\r\n        }}></TextField>\r\n      </ListItem>\r\n      <ListItem>\r\n        <TextField fullWidth variant=\"standard\" label=\"电子邮件\" helperText=\"可选，如果您想接收产品后续消息，请填写。\" onChange={e => {\r\n          setAddress(e.target.value);\r\n        }}></TextField>\r\n      </ListItem>\r\n    </List>\r\n    <FormControlLabel\r\n      control={\r\n        <Checkbox color=\"primary\" onChange={e => setChecked(e.target.checked)}></Checkbox>\r\n      }\r\n      label=\"我已经阅读并同意\"\r\n    /><Link >用户协议</Link>\r\n    <List>\r\n      <ListItem>\r\n        <Button fullWidth disabled={!checked && password === passwordRepeate} variant=\"contained\" color=\"primary\" onClick={handleRegist}>注册</Button>\r\n      </ListItem>\r\n      {onLogin ? <ListItem><Button fullWidth variant=\"outlined\" color=\"secondary\" onClick={() => {\r\n        if (onLogin) onLogin();\r\n      }}>去登录</Button></ListItem> : undefined}\r\n    </List>\r\n  </Container>);\r\n}\r\n\r\nfunction CaptchaComp(props) {\r\n  const { onSuccess, open, onClose, onError } = props;\r\n  const [phone, setPhone] = React.useState(props.phone || \"\");\r\n  const [password, setPassword] = React.useState(props.password || \"\");\r\n  const [captcha, setCaptcha] = React.useState('');\r\n  const handleCaptcha = async () => {\r\n    const resp = await authApi.applyCaptcha(phone, password, captcha);\r\n    if (resp.code !== 200) {\r\n      onError(resp);\r\n      return;\r\n    }\r\n    onSuccess(resp);\r\n    onClose();\r\n  };\r\n  return (<Dialog\r\n    open={open}\r\n    onClose={onClose}\r\n  >\r\n    <DialogTitle>请输入验证码</DialogTitle>\r\n    <DialogContent>\r\n      <DialogContentText>\r\n        <List>\r\n          <ListItem>\r\n            <TextField defaultValue={phone} onChange={e => {\r\n              setPhone(e.target.value);\r\n            }} label=\"手机号\"></TextField>\r\n          </ListItem>\r\n          <ListItem>\r\n            <TextField defaultValue={password} type=\"password\" onChange={e => {\r\n              setPassword(e.target.value);\r\n            }} label=\"密码\"></TextField>\r\n          </ListItem>\r\n          <ListItem>\r\n            <TextField defaultValue={captcha} onChange={e => {\r\n              setCaptcha(e.target.value);\r\n            }} label=\"验证码\"></TextField>\r\n          </ListItem>\r\n        </List>\r\n      </DialogContentText>\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button onClick={() => {\r\n        handleCaptcha();\r\n      }} color=\"primary\" autoFocus>确定</Button>\r\n      <Button onClick={() => {\r\n        onClose();\r\n      }} color=\"primary\">取消</Button>\r\n    </DialogActions>\r\n  </Dialog>);\r\n}\r\n\r\nCaptchaComp.PropType = {\r\n  onSuccess: PropType.func.isRequired,\r\n  onError: PropType.func.isRequired,\r\n  onClose: PropType.func.isRequired,\r\n  open: PropType.bool.isRequired,\r\n  phone: PropType.string\r\n};\r\n\r\nfunction LoginComp(props) {\r\n  const classes = useStyles();\r\n  const { onSuccess, onRegist } = props;\r\n  const [phone, setPhone] = React.useState(store.getState().config.data.user.phone || '');\r\n  const [password, setPassword] = React.useState('');\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [errorData, setErrorData] = React.useState({});\r\n\r\n  const [openCaptcha, setOpenCaptcha] = React.useState(false);\r\n  const handleLogin = async () => {\r\n    setRequesting(true);\r\n    let loginData;\r\n    try {\r\n      loginData = await authApi.login(phone, password);\r\n    } catch (e) {\r\n      setRequesting(false);\r\n      return;\r\n    }\r\n    const { auth } = loginData.data;\r\n    setRequesting(false);\r\n    if (!auth && loginData.code !== 200) {\r\n      setErrorData(loginData);\r\n      return;\r\n    }\r\n    if (!auth && loginData.code === 200) {\r\n      setOpenCaptcha(true);\r\n      return;\r\n    }\r\n    let c = store.getState().config;\r\n    c.data.auth = auth;\r\n    store.dispatch(setConfig(c));\r\n    if (onSuccess)\r\n      onSuccess();\r\n  };\r\n  return (<Container maxWidth=\"sm\">\r\n    <Typography variant=\"h5\">用户登录</Typography>\r\n    <List>\r\n      <ListItem>\r\n        <TextField fullWidth variant=\"standard\" label=\"手机号\" onChange={e => {\r\n          setPhone(e.target.value);\r\n        }}></TextField>\r\n      </ListItem>\r\n      <ListItem>\r\n        <TextField fullWidth variant=\"standard\" type=\"password\" label=\"密码\" onChange={e => {\r\n          setPassword(e.target.value);\r\n        }}></TextField>\r\n      </ListItem>\r\n      <ListItem>\r\n        <Button fullWidth color=\"primary\" disabled={requesting} variant=\"contained\" onClick={handleLogin}>{requesting ? \"正在登录\" : \"登录\"}</Button>\r\n      </ListItem>\r\n      {onRegist ? <ListItem>\r\n        <Button fullWidth color=\"secondary\" disabled={requesting} variant=\"outlined\" onClick={() => {\r\n          if (onRegist) onRegist();\r\n        }}>注册</Button>\r\n      </ListItem> : undefined}\r\n    </List>\r\n    <Box>\r\n      <Link className={classes.linkAction}>忘记密码</Link>\r\n      <Link className={classes.linkAction} onClick={() => setOpenCaptcha(true)}>输入验证码</Link>\r\n    </Box>\r\n    <Dialog\r\n      open={JSON.stringify(errorData) !== '{}'}\r\n      onClose={() => setErrorData({})}\r\n    >\r\n      <DialogTitle>遇到错误({errorData.code})</DialogTitle>\r\n      <DialogContent>\r\n        <DialogContentText>\r\n          {errorData.message}\r\n        </DialogContentText>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setErrorData({})} color=\"primary\" autoFocus>我知道了</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    {openCaptcha ? <CaptchaComp open={openCaptcha}\r\n      onClose={() => { setOpenCaptcha(false); }}\r\n      onSuccess={resp => {\r\n        console.log(resp);\r\n      }}\r\n      onError={err => {\r\n        setOpenCaptcha(false);\r\n        setErrorData(err);\r\n      }}\r\n      phone={phone}\r\n      password={password}></CaptchaComp> : undefined}\r\n  </Container>);\r\n}\r\n\r\nfunction Verify(props) {\r\n  const [phone, setPhone] = React.useState('');\r\n  const [name, setName] = React.useState('');\r\n  const [email, setEmail] = React.useState('');\r\n  const [address, setAddress] = React.useState('');\r\n  const [password, setPassword] = React.useState('');\r\n  const [authUntil, setAuthUntil] = React.useState('');\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [captchaText, setCaptchaText] = React.useState(\"\");\r\n  const [pageType, setPageType] = React.useState('login');\r\n  if (!store.getState().config.data.auth && pageType === 'login')\r\n    return <LoginComp onRegist={() => { setPageType('regist'); }}></LoginComp>;\r\n  if (!store.getState().config.data.auth && pageType === 'regist')\r\n    return <RegistComp onLogin={() => { setPageType('login'); }}></RegistComp>;\r\n  return (<Container>\r\n\r\n  </Container>);\r\n}\r\n\r\nexport default Verify;","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport LinkText from '@material-ui/core/Link';\r\nimport { ListItem, ListItemText, List } from '@material-ui/core';\r\nimport Button from '@material-ui/core/Button';\r\nimport { API, test } from \"../api/api\"\r\nconst QRCode = require('qrcode.react');\r\n\r\nclass Connect extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.render = this.render.bind(this);\r\n    this.api = new API();\r\n    this.state = {\r\n      qrcodeWidth: window.innerWidth * 0.5 < 250 ? window.innerWidth * 0.5 : 250,\r\n      ips: [],\r\n      url: window.location.protocol + \"//\" + window.location.hostname + \":\" + window.location.port + '/',\r\n    };\r\n    window.addEventListener(\"resize\", () => { this.setState({ qrcodeWidth: window.innerWidth * 0.5 < 250 ? window.innerWidth * 0.5 : 250 }); })\r\n    this.api.get_ips().then(ips => {\r\n      console.log('ips', ips);\r\n      this.setState({ ips: ips });\r\n      if (ips.length > 0) this.setState({ url: window.location.protocol + \"//\" + ips[0] + \":\" + window.location.port + '/' });\r\n    })\r\n  }\r\n  render() {\r\n    let { config } = this.props;\r\n    return (<Container size=\"xs\">\r\n      <Typography variant=\"body1\">请先使手机与电脑在同一内网状态下，如连接同一个WiFi，然后在下面选择一个可能的IP地址，使用移动设备扫码连接。</Typography>\r\n      <Typography variant=\"body1\">温馨提示：</Typography>\r\n      <Typography variant=\"body1\">1. 请先关闭电脑防火墙或对本程序设置防火墙特例，或者添加放行端口({window.location.port})。\r\n      <Typography variant=\"body1\">2. 诸如<code>192.168.*</code>开头的IP地址可能性比较大。</Typography>\r\n      </Typography>\r\n      <List>\r\n        {this.state.ips.map(ip =>\r\n          <ListItem button key={ip} onClick={() => {\r\n            this.setState({ url: window.location.protocol + \"//\" + ip + \":\" + window.location.port + '/' });\r\n          }}>\r\n            <ListItemText primary={ip} />\r\n          </ListItem>\r\n        )}\r\n      </List>\r\n      <QRCode value={this.state.url} size={this.state.qrcodeWidth} />\r\n      <Typography variant=\"body1\">或者使用手机浏览器打开：<LinkText href={this.state.url}>{this.state.url}</LinkText></Typography>\r\n    </Container >)\r\n  }\r\n};\r\n\r\nexport default Connect;","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport Container from '@material-ui/core/Container';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport AlarmIcon from '@material-ui/icons/Alarm';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport StorageIcon from '@material-ui/icons/Storage';\r\nimport VerifiedUserIcon from '@material-ui/icons/VerifiedUser';\r\nimport PhonelinkIcon from '@material-ui/icons/Phonelink';\r\nimport {\r\n  // HashRouter as Router,\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\r\nimport { Provider } from 'react-redux'\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport store from './data/store';\r\nimport { setConfig, setErrorInfo, setMessage, setReserveTableData, setRoomStockData, setShopInfo } from \"./data/action\";\r\n\r\nimport { isIterator, isMobileDevice, sleep } from \"./utils/utils\";\r\nimport { API, AuthAPI } from \"./api/api\";\r\n\r\nimport ListItemLink from \"./components/listItemLink\";\r\nimport LoginDialog from \"./pages/loginDialog\";\r\nimport Launch from \"./pages/launch\";\r\nimport Settings from \"./pages/settings\";\r\nimport Verify from \"./pages/verify\";\r\nimport PlanTime from \"./pages/planTime\";\r\nimport PlanStock from \"./pages/planStock\";\r\nimport Connect from \"./pages/connect\";\r\nimport Config from \"./Config\";\r\nimport './App.css';\r\nimport { Box, Button, Dialog, DialogActions, DialogContent, DialogTitle, ListItem, Snackbar } from '@material-ui/core';\r\n\r\nconst drawerWidth = 240;\r\nmoment.locale('zh-cn');\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n    width: '100%',\r\n    // overflowX: 'auto',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  hide: {\r\n    display: 'none',\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    flexShrink: 0,\r\n    whiteSpace: 'nowrap',\r\n  },\r\n  drawerOpen: {\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerClose: {\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n    width: theme.spacing(7) + 1,\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  toolbar: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // necessary for content to be below app bar\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3),\r\n    width: '100%',\r\n    overflowX: 'auto',\r\n  },\r\n}));\r\n\r\nconst api = new API();\r\nconst authApi = new AuthAPI();\r\napi.get_shop_info().then(shopInfo => {\r\n  console.log('shopInfo', shopInfo);\r\n  if (shopInfo) store.dispatch(setShopInfo(shopInfo));\r\n}).catch(e => {\r\n  store.dispatch(setErrorInfo(e));\r\n})\r\n\r\nlet subscribers = {};\r\n\r\nlet config_last_data = null;\r\n\r\nstore.subscribe(async () => {\r\n  let state = store.getState();\r\n  // console.log('redux update to', state);\r\n  // 保存 config\r\n  if (state.config.data) {\r\n    if (JSON.stringify(state.config.data) != JSON.stringify(config_last_data)) {\r\n      // console.log('Config will change:', state.config.data);\r\n      await api.upload_config();\r\n    } else {\r\n      // console.log('Not change:', state.config.data);\r\n    }\r\n    config_last_data = state.config.data;\r\n  }\r\n  for (let subFunc in subscribers) {\r\n    subscribers[subFunc](state);\r\n  }\r\n});\r\n\r\nconst getShopTitle = function () {\r\n  if (!store.getState().shopInfo.shopName) return null;\r\n  // console.log('getShopTitle', store.getState().shopInfo);\r\n  return `${store.getState().shopInfo.shopName} - ${store.getState().shopInfo.branchName}`\r\n}\r\n\r\nexport default function App() {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [popupLogin, setPopupLogin] = React.useState(false);\r\n  const [errorDialogInfo, setErrorDialogInfo] = React.useState(false);\r\n  const [myMessage, setMyMessage] = React.useState(null);\r\n  const [hasLogin, setHasLogin] = React.useState(false);\r\n  const titleDefault = \"团购杀手 - KTV体验版\";\r\n  const [title, setTitle] = React.useState(getShopTitle() || titleDefault);\r\n\r\n  // 拉大到800会打开，拉小到600关闭\r\n  const triggerWidthOpen = 800;\r\n  const triggerWidthClose = 600;\r\n\r\n  // 注册一个当遇到错误的时候调用的钩子吧，用来显示错误信息\r\n  subscribers['Error'] = function (state) {\r\n    if (state.errorInfo) {\r\n      console.log('Error Hook: ', state.errorInfo);\r\n      setErrorDialogInfo(state.errorInfo);\r\n      // 清空错误信息\r\n      store.dispatch(setErrorInfo(null));\r\n    }\r\n  };\r\n  // 注册一个消息钩子\r\n  subscribers['Message'] = function (state) {\r\n    if (state.message) {\r\n      console.log('message: ', state.message);\r\n      setMyMessage(state.message);\r\n      store.dispatch(setMessage(null));\r\n    }\r\n  };\r\n  // 店信息钩子\r\n  subscribers['ShopInfo'] = function (state) {\r\n    if (state.shopInfo) {\r\n      if (title === titleDefault) {\r\n        setTitle(getShopTitle());\r\n      }\r\n    }\r\n  };\r\n\r\n  // onMount & onUpdate\r\n  React.useEffect(() => {\r\n    const onWindowResize = () => {\r\n      let width = window.innerWidth;\r\n      // console.log(width);\r\n      if (!open && width >= triggerWidthOpen) setOpen(true);\r\n      if (open && width <= triggerWidthClose) setOpen(false);\r\n    };\r\n    window.addEventListener(\"load\", onWindowResize);\r\n    window.addEventListener('resize', onWindowResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"load\", onWindowResize);\r\n      window.removeEventListener(\"resize\", onWindowResize);\r\n    };\r\n  });\r\n\r\n  // console.log(\"store\", store);\r\n  // console.log(\"store.getState()\", store.getState());\r\n\r\n  const handleDrawerOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleDrawerClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  const handleLoginOpen = () => {\r\n    // console.log('handleLoginOpen');\r\n    setPopupLogin(true);\r\n  };\r\n\r\n  const handleLoginClose = () => {\r\n    setPopupLogin(false);\r\n  };\r\n\r\n  const handleClickAction = () => {\r\n    if (window.innerWidth < 600 || window.location.pathname === '/') {\r\n      setOpen(false);\r\n    }\r\n    // authApi.auth(store.getState().config.data.auth).then((check) => {\r\n    //   if (!check && window.location.pathname !== '/verify') {\r\n    //     window.location.pathname = '/verify';\r\n    //   }\r\n    // });\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <ThemeProvider theme={store.getState().config.theme}>\r\n        <Router>\r\n          <MuiPickersUtilsProvider utils={MomentUtils} locale=\"zh-cn\">\r\n            <CssBaseline />\r\n            <AppBar\r\n              position=\"fixed\"\r\n              className={clsx(classes.appBar, {\r\n                [classes.appBarShift]: open,\r\n              })}\r\n            >\r\n              <Toolbar>\r\n                <IconButton\r\n                  color=\"inherit\"\r\n                  aria-label=\"open drawer\"\r\n                  onClick={handleDrawerOpen}\r\n                  edge=\"start\"\r\n                  className={clsx(classes.menuButton, {\r\n                    [classes.hide]: open,\r\n                  })}\r\n                >\r\n                  <MenuIcon />\r\n                </IconButton>\r\n                <Typography variant=\"h6\" noWrap className={classes.title}>\r\n                  {title}\r\n                </Typography>\r\n                <IconButton\r\n                  color=\"inherit\"\r\n                  aria-label=\"login\"\r\n                  onClick={handleLoginOpen}\r\n                >\r\n                  <AccountCircleIcon />\r\n                </IconButton>\r\n              </Toolbar>\r\n            </AppBar>\r\n            <Drawer\r\n              variant=\"permanent\"\r\n              className={clsx(classes.drawer, {\r\n                [classes.drawerOpen]: open,\r\n                [classes.drawerClose]: !open,\r\n              })}\r\n              classes={{\r\n                paper: clsx({\r\n                  [classes.drawerOpen]: open,\r\n                  [classes.drawerClose]: !open,\r\n                }),\r\n              }}\r\n            >\r\n              <div className={classes.toolbar}>\r\n                <IconButton onClick={handleDrawerClose}>\r\n                  {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n                </IconButton>\r\n              </div>\r\n              <Divider />\r\n              <List onClick={handleClickAction}>\r\n                <ListItemLink to=\"/\" primary=\"启动页\" icon={<DashboardIcon />} />\r\n                <ListItemLink to=\"/plan/time\" primary=\"时间计划\" icon={<AlarmIcon />} />\r\n                <ListItemLink to=\"/plan/stock\" primary=\"库存计划\" icon={<StorageIcon />} />\r\n                <ListItemLink to=\"/settings\" primary=\"设置\" icon={<SettingsIcon />} />\r\n                {/* <ListItemLink to=\"/verify\" primary=\"授权\" icon={<VerifiedUserIcon />} /> */}\r\n                {isMobileDevice() ? null : <ListItemLink to=\"/connect\" primary=\"移动设备\" icon={<PhonelinkIcon />} />}\r\n              </List>\r\n            </Drawer>\r\n            <main className={classes.content}>\r\n              <div className={classes.toolbar} />\r\n              {/* <Route render={({ location }) => {\r\n                  console.log('location', location);\r\n                  return (\r\n                    <TransitionGroup>\r\n                      <CSSTransition\r\n                        key={location.key}\r\n                        classNames='fade2'\r\n                        timeout={0}\r\n                      >\r\n                        <Switch>\r\n                          <Route path={\"/\"} exact={true}>\r\n                            <Launch  />\r\n                          </Route>\r\n                          <Route path={\"/plan/time\"} exact={false}>\r\n                            <PlanTime  />\r\n                          </Route>\r\n                          <Route path={\"/plan/stock\"} exact={false}>\r\n                            <PlanStock  />\r\n                          </Route>\r\n                          <Route path={\"/settings\"} exact={false}>\r\n                            <Settings  />\r\n                          </Route>\r\n                          <Route path={\"/verify\"} exact={false}>\r\n                            <Verify  />\r\n                          </Route>\r\n                          <Route path={\"/connect\"} exact={false}>\r\n                            <Connect  />\r\n                          </Route>\r\n                        </Switch>\r\n                      </CSSTransition>\r\n                    </TransitionGroup>\r\n                  );\r\n                }}>\r\n                </Route> */}\r\n              {/* {'' + store.getState().shopInfo} */}\r\n              <Switch>\r\n                <Route path={\"/\"} exact={true}>\r\n                  <Launch />\r\n                </Route>\r\n                <Route path={\"/plan/time\"} exact={false}>\r\n                  <PlanTime />\r\n                </Route>\r\n                <Route path={\"/plan/stock\"} exact={false}>\r\n                  <PlanStock />\r\n                </Route>\r\n                <Route path={\"/settings\"} exact={false}>\r\n                  <Settings />\r\n                </Route>\r\n                <Route path={\"/verify\"} exact={false}>\r\n                  <Verify />\r\n                </Route>\r\n                <Route path={\"/connect\"} exact={false}>\r\n                  <Connect />\r\n                </Route>\r\n              </Switch>\r\n            </main>\r\n          </MuiPickersUtilsProvider>\r\n        </Router>\r\n        <LoginDialog open={popupLogin && store.getState().config.has_login} onClose={handleLoginClose}></LoginDialog>\r\n        <Dialog open={errorDialogInfo ? true : false} onClose={() => { setErrorDialogInfo(null); }}>\r\n          <DialogTitle>遇到错误</DialogTitle>\r\n          <DialogContent>\r\n            <Typography variant=\"body1\">错误信息：</Typography>\r\n            <Box component=\"div\">\r\n              <Box component=\"div\">\r\n                {() => {\r\n                  if (isIterator(errorDialogInfo) && typeof (errorDialogInfo) !== 'string') {\r\n                    return <List>\r\n                      {errorDialogInfo.map((d, i) => <ListItem key={i}>\r\n                        <code>{JSON.stringify(d) === '{}' ? d.toString() : JSON.stringify(d)}</code>\r\n                      </ListItem>)}\r\n                    </List>;\r\n                  } else {\r\n                    return <code>{JSON.stringify(errorDialogInfo) === '{}' ? errorDialogInfo.toString() : JSON.stringify(errorDialogInfo)}</code>;\r\n                  }\r\n                }}\r\n              </Box>\r\n            </Box>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button color=\"primary\" onClick={() => { window.location.reload() }}>刷新</Button>\r\n            <Button color=\"primary\" onClick={() => { setErrorDialogInfo(null); }}>取消</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        <Snackbar\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'right',\r\n          }}\r\n          open={myMessage !== null}\r\n          autoHideDuration={6000}\r\n          // onClose={(e) => { console.log(e); }}\r\n          message={myMessage}\r\n          action={\r\n            <React.Fragment>\r\n              <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={() => setMyMessage(null)}>\r\n                <CloseIcon fontSize=\"small\" />\r\n              </IconButton>\r\n            </React.Fragment>\r\n          }\r\n        />\r\n      </ThemeProvider>\r\n    </div >\r\n  );\r\n}\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from './data/store';\r\nimport { Provider } from 'react-redux';\r\nimport { API, AuthAPI } from './api/api';\r\nimport { setConfig, setErrorInfo, setRoomStockPlans, setTimetableNodes, setTimetablePeriods } from './data/action';\r\nimport { sleep } from './utils/utils';\r\n\r\n// 循环执行函数\r\nasync function cycleFunc(cycle = 1000) {\r\n  const api = new API();\r\n  const authApi = new AuthAPI();\r\n  let authCount = 0;\r\n  while (true) {\r\n    try {\r\n      await api.get_timetable_node().then(nodes => {\r\n        if (nodes)\r\n          store.dispatch(setTimetableNodes(nodes));\r\n      });\r\n      await api.get_timetable_period().then(periods => {\r\n        if (periods)\r\n          store.dispatch(setTimetablePeriods(periods));\r\n      });\r\n      await api.get_room_stock_plan().then(stocks => {\r\n        if (stocks)\r\n          store.dispatch(setRoomStockPlans(stocks));\r\n      });\r\n      // 循环验证\r\n      /*\r\n      if (authCount == 0) {\r\n        if (window.location.pathname !== '/verify') {\r\n          await authApi.auth(store.getState().config.data.auth).then((check) => {\r\n            if (!check && window.location.pathname !== '/verify') {\r\n              setTimeout(() => {\r\n                window.location.pathname = '/verify';\r\n              }, 2000);\r\n              let c = store.getState().config;\r\n              c.data.auth = '';\r\n              store.dispatch(setConfig(c));\r\n            }\r\n          });\r\n          authCount = 20;\r\n        } else authCount = 1;\r\n      }\r\n      authCount--;\r\n      */\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    await sleep(cycle);\r\n  }\r\n}\r\n\r\n// 开始执行的函数\r\nasync function startFunc() {\r\n  const api = new API();\r\n  setTimeout(async () => {\r\n    let c = api.download_config();\r\n    if (!c.settings_async) return;\r\n    const config_frontend = await api.download_config();\r\n    if (!config_frontend) {\r\n      store.dispatch(setErrorInfo(\"同步设置失败\"));\r\n    }\r\n    else store.dispatch(setConfig(config_frontend));\r\n  }, 600);\r\n}\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\nstartFunc().then(() => {\r\n  cycleFunc();\r\n});\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}