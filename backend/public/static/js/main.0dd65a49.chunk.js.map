{"version":3,"sources":["utils/utils.js","data/action.js","api/api.js","data/reducers.js","Config.js","data/store.js","components/ListItemLink.js","components/ListInfo.js","components/Actions.js","components/ListEdit.js","components/Triggers.js","pages/Launch.js","pages/Settings.js","api/remote_login.js","pages/RemoteLogin.js","pages/Login.js","pages/Tasks.js","App.js","reportWebVitals.js","index.js"],"names":["sleep","time_ms","Promise","accept","setTimeout","isIterator","obj","Symbol","iterator","deepCopy","data","undefined","d","i","length","push","k","objectUpdate","origin","update","now","isObjectValueEqual","a","b","aProps","Object","getOwnPropertyNames","bProps","propName","propA","propB","hasOwnProperty","setConfig","dispatch","type","setUser","setDaemon","setErrorInfo","setMessage","updateTypes","typeData","store","getState","types","Date","prototype","setDay","day","day_","this","getDay","setTime","getTime","toDateString","toISOString","slice","api","host","window","location","href","includes","port","api_version","api_prefix","protocol","url","access_token","refresh_token","router","key","method","request","config","api_token","get_token","console","log","set_token","refresh","access","headers","payload","mode","body","JSON","stringify","get_headers","Boolean","fetch","resp","js","json","error","code","status","statusText","message","resp2","js2","update_config","res","user","defaultState","ITEM_NAME","load","bind","save","theme_avaliable","createMuiTheme","palette","primary","main","blueGrey","secondary","grey","data_default","debug","version_frontend","theme_name","settings_async","remote_login","server","theme","parse","localStorage","getItem","Error","e","warn","s","setItem","tasks","daemon","errorInfo","combineReducers","state","action","createStore","reducers","applyMiddleware","thunk","ListItemLink","props","icon","to","renderLink","React","useMemo","forwardRef","itemProps","ref","ListItem","button","component","ListItemIcon","ListItemText","ListInfo","open","onClose","title","keyNames","useState","openChild","setOpenChild","child","setChild","childTitle","setChildTitle","Dialog","fullWidth","DialogTitle","DialogContent","List","style","width","keys","map","v","showName","onClick","ListItemSecondaryAction","Typography","variant","ActionTag","useActions","Card","minWidth","margin","CardContent","name","desc","CardActions","Button","color","Actions","requesting","setRequesting","useReducer","x","forceUpdate","actions","then","content","Box","display","flexDirection","flexWrap","action_type","ListEdit","defaultValue","onSave","setInnerData","TextField","value","onChange","newValue","parseFloat","target","DialogActions","height","justifyContent","isTriggerModified","item","TriggerTag","trigger","selectMode","dialogOpen","setDialogOpen","toUse","setToUse","handleCloseDialog","handleClick","newTrigger","newData","Triggers","triggers","trigger_type","Launch","Container","Settings","themeName","setThemeName","refConfigFileInput","useRef","resetSettingsOpen","setResetSettingsOpen","deleteDataOpen","setDeleteDataOpen","openDaemon","setOpenDaemon","openUser","setOpenUser","resetSettings","c","maxWidth","ListSubheader","username","FormControl","Select","reload","MenuItem","filename","eleLink","document","createElement","download","blob","Blob","URL","createObjectURL","appendChild","click","removeChild","funDownload","toLocaleString","current","hidden","files","file","reader","FileReader","readAsText","onload","evt","fileData","result","Switch","defaultChecked","checked","nick","phone","profile","created_at","updated_at","cookies","shop_info","solution_id","WebSocketAPI","connect","ws","onopen","ondata","cmd","oncode","oncookies","onmessage","onerror","onclose","WebSocket","close","QRCode","require","CenterBox","children","textAlign","RemoteLogin","loginDone","ws_api","setState","uid","Paper","size","Component","LoginFrame","password","captcha","actionType","setInnerState","refUsername","refPassword","actionLogin","handleAction","Divider","label","onKeyDown","querySelector","focus","Fade","in","timeout","exit","enter","Login","TaskTag","task","Tasks","dialogAddTaskOpen","dialogAddTriggerOpen","dialogAddActionOpen","dialogUpdateTrigger","dialogAddTask","newTriggers","IconButton","splice","Grid","container","spacing","lg","sm","drawerWidth","moment","locale","useStyles","makeStyles","root","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","flexGrow","appBarShift","marginLeft","enteringScreen","menuButton","marginRight","hide","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","breakpoints","up","toolbar","alignItems","padding","mixins","subscribers","last_data","subscribe","subFunc","getShopTitle","shopName","branchName","App","classes","useTheme","setOpen","setPopupLogin","errorDialogInfo","setErrorDialogInfo","myMessage","setMyMessage","titleDefault","setTitle","useEffect","onWindowResize","innerWidth","addEventListener","removeEventListener","mainContent","utils","MomentUtils","CssBaseline","AppBar","position","className","clsx","Toolbar","aria-label","edge","noWrap","Drawer","paper","direction","pathname","path","exact","isNowLogining","ThemeProvider","toString","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Fragment","fontSize","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","cycle","load_from_config","ReactDOM","render","getElementById","startFunc","cycleFunc"],"mappings":"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","file":"static/js/main.0dd65a49.chunk.js","sourcesContent":["import moment from 'moment';\r\nimport 'moment/locale/zh-cn'\r\n\r\nexport function isMobileDevice() {\r\n  const sUserAgent = navigator.userAgent;\r\n  return (sUserAgent.indexOf('Android') > -1 || sUserAgent.indexOf('iPhone') > -1 || sUserAgent.indexOf('iPad') > -1 || sUserAgent.indexOf('iPod') > -1 || sUserAgent.indexOf('Symbian') > -1);\r\n}\r\n\r\n/** \r\n* param 将要转为URL参数字符串的对象 \r\n* key URL参数字符串的前缀 \r\n* encode true/false 是否进行URL编码,默认为true \r\n*  \r\n* return URL参数字符串 \r\n*/\r\nexport function urlEncode(param, key, encode) {\r\n  if (param == null) return '';\r\n  var paramStr = '';\r\n  var t = typeof (param);\r\n  if (t === 'string' || t === 'number' || t === 'boolean') {\r\n    paramStr += '&' + key + '=' + ((encode == null || encode) ? encodeURIComponent(param) : param);\r\n  } else {\r\n    for (var i in param) {\r\n      var k = key == null ? i : key + (param instanceof Array ? '[' + i + ']' : '.' + i);\r\n      paramStr += urlEncode(param[i], k, encode);\r\n    }\r\n  }\r\n  return paramStr;\r\n};\r\n\r\nexport function urlEncode2(obj) {\r\n  try {\r\n    return JSON.stringify(obj).replace(/:/g, \"=\").replace(/\"/g, '').replace(/,/g, '&').match(/\\{([^)]*)\\}/)[1];\r\n  } catch (e) {\r\n    console.error(e);\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function parseTimePoint(time) {\r\n  return moment(time).format('LLLL');\r\n}\r\n\r\nexport function parseTimePeriod(time) {\r\n  return moment.duration(time).humanize();\r\n}\r\n\r\nexport function getTextFieldValue(el) {\r\n  return el.current.childNodes[el.current.childElementCount - 1].childNodes[0].value;\r\n}\r\n\r\nexport function sleep(time_ms) {\r\n  return new Promise(accept => {\r\n    setTimeout(accept, time_ms);\r\n  });\r\n}\r\n\r\n// 设置到本周的星期几\r\nDate.prototype.setDay = function (day) {\r\n  let day_ = this.getDay();\r\n  if (day_ === day) return this;\r\n  this.setTime(this.getTime() + 1000 * 60 * 60 * 24 * (day - day_));\r\n  return this;\r\n};\r\n\r\n// 获取 YYYY-MM-DD 格式\r\nDate.prototype.toDateString = function () {\r\n  return this.toISOString().slice(0, 10);\r\n};\r\n\r\n// export function cutString(str, length=10)\r\n\r\nexport function isIterator(obj) {\r\n  return obj != null && typeof obj[Symbol.iterator] === 'function';\r\n}\r\n\r\n// 下载文件方法\r\nexport function funDownload(content, filename) {\r\n  var eleLink = document.createElement('a');\r\n  eleLink.download = filename;\r\n  eleLink.style.display = 'none';\r\n  // 字符内容转变成blob地址\r\n  var blob = new Blob([content]);\r\n  eleLink.href = URL.createObjectURL(blob);\r\n  // 触发点击\r\n  document.body.appendChild(eleLink);\r\n  eleLink.click();\r\n  // 然后移除\r\n  document.body.removeChild(eleLink);\r\n};\r\n\r\n\r\nexport function deepCopy(data) {\r\n  if (data === null || data === undefined) {\r\n    return data;\r\n  } if (isIterator(data) && typeof (data) !== \"string\") {\r\n    let d = [];\r\n    for (let i = 0; i < data.length; i++) {\r\n      d.push(data[i]);\r\n    }\r\n    return d;\r\n  } else if (typeof (data) === \"object\") {\r\n    let d = {};\r\n    for (const k in data) {\r\n      d[k] = deepCopy(data[k]);\r\n    }\r\n    return d;\r\n  } else {\r\n    return data;\r\n  }\r\n}\r\n\r\nexport function objectUpdate(origin, update) {\r\n  let now = deepCopy(origin);\r\n  for (const k in update) {\r\n    now[k] = update[k];\r\n  }\r\n  return now;\r\n}\r\n\r\n// https://www.jianshu.com/p/7407bd65b15d\r\nexport function isObjectValueEqual(a, b) {\r\n  var aProps = Object.getOwnPropertyNames(a);\r\n  var bProps = Object.getOwnPropertyNames(b);\r\n  if (aProps.length !== bProps.length) {\r\n    return false;\r\n  }\r\n  for (var i = 0; i < aProps.length; i++) {\r\n    var propName = aProps[i]\r\n\r\n    var propA = a[propName]\r\n    var propB = b[propName]\r\n    // 2020-11-18更新，这里忽略了值为undefined的情况\r\n    // 故先判断两边都有相同键名\r\n    if (!b.hasOwnProperty(propName)) return false\r\n    if ((propA instanceof Object)) {\r\n      if (isObjectValueEqual(propA, propB)) {\r\n        // return true     这里不能return ,后面的对象还没判断\r\n      } else {\r\n        return false\r\n      }\r\n    } else if (propA !== propB) {\r\n      return false\r\n    } else { }\r\n  }\r\n  return true\r\n}\r\n\r\n// Array.prototype.indexOf = function (val) {\r\n//   for (var i = 0; i < this.length; i++) {\r\n//     if (this[i] == val) return i;\r\n//   }\r\n//   return -1;\r\n// };\r\n\r\n// Array.prototype.remove = function (val) {\r\n//   var index = this.indexOf(val);\r\n//   if (index > -1) {\r\n//     this.splice(index, 1);\r\n//   }\r\n// };\r\n\r\n// Array.prototype.removeIndex = function (index) {\r\n//   this.splice(index, 1);\r\n// };\r\n\r\n// export function arrayRemove(array, data) {\r\n//   if (!isIterator(array)) return;\r\n//   const index = array.indexOf(data);\r\n//   if (index > -1) {\r\n//     array.slice(index, 1);\r\n//   }\r\n// }","import { objectUpdate } from \"../utils/utils\";\r\nimport store from \"./store\";\r\n\r\nexport function setConfig(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_CONFIG\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTasks(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TASKS\", data: data });\r\n  };\r\n}\r\n\r\nexport function setUser(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_USER\", data: data });\r\n  };\r\n}\r\n\r\nexport function setDaemon(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_DAEMON\", data: data });\r\n  };\r\n}\r\n\r\nexport function setErrorInfo(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ERROR_INFO\", data: data });\r\n  };\r\n}\r\n\r\nexport function setMessage(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_MESSAGE\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTypes(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TYPES\", data: data });\r\n  };\r\n}\r\n\r\n\r\nexport function updateTypes(type, typeData) {\r\n  return setTypes(objectUpdate(store.getState().types, { [type]: typeData }));\r\n}\r\n","import { setConfig, setErrorInfo, setUser } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { isIterator, urlEncode } from \"../utils/utils\"\r\n\r\n\r\n\r\nclass API {\r\n  constructor() {\r\n    // this.host = '127.0.0.1';\r\n    this.host = window.location.href.includes(\"localhost\") ? \"localhost\" : null;\r\n    // this.port = 8080;\r\n    this.port = 8880;\r\n    this.api_version = \"v2\";\r\n    this.api_prefix = `/api/${this.api_version}`;\r\n    this.protocol = 'http'\r\n    this.url = this.host ? `${this.protocol}://${this.host}:${this.port}${this.api_prefix}` : `${this.api_prefix}`;\r\n    this.access_token = '';\r\n    this.refresh_token = '';\r\n  }\r\n  set_token(access_token, refresh_token) {\r\n    // this.access_token = access_token || this.access_token;\r\n    // this.refresh_token = refresh_token || this.refresh_token;\r\n    if (access_token !== undefined)\r\n      this.access_token = access_token;\r\n    if (refresh_token !== undefined)\r\n      this.refresh_token = refresh_token;\r\n  }\r\n  get_token() {\r\n    return {\r\n      access_token: this.access_token === '' ? undefined : this.access_token, refresh_token: this.refresh_token === '' ? undefined : this.refresh_token\r\n    }\r\n  }\r\n  request_key(router, key, method = \"GET\", data) {\r\n    return this.request(`${router}/${key}`, method, data);\r\n  }\r\n  update_config() {\r\n    let config = store.getState().config;\r\n    config.data.api_token = this.get_token();\r\n    console.log('config.data.api_token', config.data.api_token)\r\n    // config.save();\r\n    store.dispatch(setConfig(config));\r\n  }\r\n  load_from_config() {\r\n    const config = store.getState().config;\r\n    this.set_token(config.data.api_token.access_token, config.data.api_token.refresh_token);\r\n  }\r\n  get_headers(refresh = false, access = true) {\r\n    let headers = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (refresh) {\r\n      headers['Refresh'] = this.refresh_token;\r\n    }\r\n    if (access) {\r\n      if (this.access_token !== '') headers['Authorization'] = this.access_token;\r\n    }\r\n    return headers;\r\n  }\r\n  async request(router, method = \"GET\", data) {\r\n    const payload = {\r\n      method: method,\r\n      mode: 'cors',\r\n      body: data ? JSON.stringify(data) : undefined,\r\n      // 注销的时候自带 refresh_token\r\n      headers: this.get_headers(Boolean(router === 'session' && method === 'DELETE')),\r\n    };\r\n    // console.log('request', router, method, data, payload);\r\n    // console.log(`${this.url}/${router}`);\r\n    const resp = await fetch(`${this.url}/${router}`, payload);\r\n    let js = null;\r\n    try { js = await resp.json(); } catch (e) {\r\n      console.error(e);\r\n      store.dispatch(setErrorInfo(e));\r\n      return { code: resp.status, error: resp.statusText };\r\n    }\r\n    console.log('raw js:', js);\r\n    if (!js) {\r\n      // console.log(await resp.json());\r\n      js = {};\r\n      js.message = resp.statusText;\r\n    }\r\n    if (js.code === undefined) js.code = resp.status;\r\n    if (js.code === 422) {\r\n      if (this.refresh_token === '') {\r\n        // 过期勒\r\n        return null;\r\n      }\r\n      // ac_token到期，准备更新\r\n      // console.log(this.get_headers(true));\r\n      const resp2 = await fetch(`${this.url}/session`, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: this.get_headers(true),\r\n        // body: JSON.stringify({ refresh_token: this.refresh_token })\r\n      });\r\n      try {\r\n        const js2 = await resp2.json();\r\n        // console.log('updating ac_token', js2);\r\n        if (js2.code === 200) {\r\n          this.set_token(js2.data.access_token, js2.data.refresh_token);\r\n          this.update_config();\r\n          // 更新user\r\n          const res = this.request('user', 'GET');\r\n          if (res.code === 200) {\r\n            store.dispatch(setUser(res.data.user));\r\n          }\r\n        }\r\n        else {\r\n          // 判定为 update_token 也过期，要求重新登录\r\n          store.dispatch(setErrorInfo(\"登录过期，请重新登录\"));\r\n          return null;\r\n        }\r\n      } catch (e) {\r\n        // console.error(e);\r\n        return { code: resp2.status, error: resp2.statusText };\r\n      }\r\n      return this.request(router, method, data);\r\n    }\r\n    if (js.code === 200) {\r\n      // 登录自动储存 JWT 数据\r\n      if (router === 'session' && method === 'POST') {\r\n        const { access_token, refresh_token } = js.data;\r\n        // console.log('jwt', access_token, refresh_token);\r\n        this.set_token(access_token, refresh_token);\r\n        this.update_config();\r\n      } else if (router === 'session' && method === 'DELETE') {\r\n        // 注销\r\n        // console.warn('注销');\r\n        this.set_token('', '');\r\n        this.update_config();\r\n      }\r\n    } else {\r\n      store.dispatch(setErrorInfo(js));\r\n    }\r\n    return js;\r\n  }\r\n}\r\n\r\nconst api = new API();\r\n\r\nexport { API, api };","import { combineReducers } from 'redux'\r\nimport Config from \"../Config\"\r\n\r\nconst defaultState = {\r\n  config: new Config(),\r\n  tasks: [],\r\n  user: null,\r\n  daemon: null,\r\n  errorInfo: null,\r\n  message: null,\r\n  types: {},\r\n}\r\n\r\nfunction types(state = defaultState.types, action) {\r\n  switch (action.type) {\r\n    case \"SET_TYPES\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction config(state = defaultState.config, action) {\r\n  switch (action.type) {\r\n    case \"SET_CONFIG\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction user(state = defaultState.user, action) {\r\n  switch (action.type) {\r\n    case \"SET_USER\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction tasks(state = defaultState.tasks, action) {\r\n  switch (action.type) {\r\n    case \"SET_TASKS\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction daemon(state = defaultState.daemon, action) {\r\n  switch (action.type) {\r\n    case \"SET_DAEMON\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction errorInfo(state = defaultState.errorInfo, action) {\r\n  switch (action.type) {\r\n    case \"SET_ERROR_INFO\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction message(state = defaultState.message, action) {\r\n  switch (action.type) {\r\n    case \"SET_MESSAGE\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default combineReducers({ config, errorInfo, message, daemon, user, tasks, types });\r\n","import { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport { orange, grey, blueGrey } from '@material-ui/core/colors';\r\nimport { api } from \"./api/api\";\r\n\r\nclass Config {\r\n  ITEM_NAME = \"group_bying_config\";\r\n  constructor() {\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.theme_avaliable = {\r\n      \"默认主题\": createMuiTheme({}),\r\n      '黑暗模式': createMuiTheme({\r\n        palette: {\r\n          type: \"dark\",\r\n          primary: {\r\n            main: blueGrey[500],\r\n          },\r\n          secondary: {\r\n            main: grey[500],\r\n          },\r\n        },\r\n      }),\r\n    }\r\n    // 在构造函数执行的时候加载保存的数据\r\n    this.data_default = {\r\n      debug: false,\r\n      version_frontend: 0.1,\r\n      // 显示主题\r\n      // theme_name: \"黑暗模式\",\r\n      theme_name: \"默认主题\",\r\n      theme_avaliable: [\r\n        '默认主题',\r\n        '黑暗模式'\r\n      ],\r\n      // 设置同步\r\n      settings_async: true,\r\n      // 远程登录服务器\r\n      remote_login: {\r\n        server: \"ws://127.0.0.1:8081\"\r\n      },\r\n      api_token: {}\r\n    };\r\n    this.data = this.data_default;\r\n    this.theme = this.theme_avaliable[\"默认主题\"];\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    console.log(\"Config: loading config...\");\r\n    if (this.data.debug) {\r\n      console.log(\"Config: load default config.\");\r\n      this.save();\r\n    }\r\n    try {\r\n      this.data = JSON.parse(localStorage.getItem(this.ITEM_NAME));\r\n      if (!this.data) throw new Error(\"Null data\");\r\n      console.log(\"Got data:\", this.data);\r\n      if (!this.data.version_frontend || this.data.version_frontend < this.data_default.version_frontend) {\r\n        // 版本升级，增量更新\r\n        console.log(`Config: update ${this.data.version_frontend} -> ${this.data_default.version_frontend}`);\r\n        this.data.version_frontend = this.data_default.version_frontend;\r\n        for (let k in this.data_default) {\r\n          if (!this.data[k]) {\r\n            console.log(`    Config: add value ${k}`);\r\n            this.data[k] = this.data_default[k];\r\n          }\r\n        }\r\n        this.save();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Can not find ${this.ITEM_NAME} in localStorage, use default config.`);\r\n      this.data = this.data_default;\r\n      this.save();\r\n    }\r\n    this.theme = this.theme_avaliable[this.data.theme_name];\r\n    if (!this.theme) this.theme = this.theme_avaliable[\"default\"];\r\n    api.set_token(this.data.api_token.access_token, this.data.api_token.refresh_token);\r\n  }\r\n\r\n  save() {\r\n    console.log(\"Config: saving config...\");\r\n    this.data.api_token = api.get_token();\r\n    const s = JSON.stringify(this.data);\r\n    localStorage.setItem(this.ITEM_NAME, s);\r\n    return s;\r\n  }\r\n};\r\n\r\nexport default Config;","// applyMiddleware: redux通过该函数来使用中间件\r\n// createStore: 用于创建store实例\r\nimport { applyMiddleware, createStore } from 'redux'\r\n\r\n// 中间件，作用：如果不使用该中间件，当我们dispatch一个action时，需要给dispatch函数传入action        \r\n// 对象；但如果我们使用了这个中间件，那么就可以传入一个函数，这个函数接收两个参数:dispatch和    \r\n// getState。这个dispatch可以在将来的异步请求完成后使用，对于异步action很有用\r\nimport thunk from 'redux-thunk'\r\n\r\n// 引入reducer\r\nimport reducers from './reducers.js'\r\n\r\n// 创建store实例\r\nlet store = createStore(\r\n    reducers,\r\n    applyMiddleware(thunk)\r\n)\r\nexport default store","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\n\r\nfunction ListItemLink(props) {\r\n  const { icon, primary, to } = props;\r\n\r\n  const renderLink = React.useMemo(\r\n    () => React.forwardRef((itemProps, ref) => <RouterLink to={to} ref={ref} {...itemProps} />),\r\n    [to],\r\n  );\r\n\r\n  return (\r\n    <li>\r\n      <ListItem button component={renderLink}>\r\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\r\n        <ListItemText primary={primary} />\r\n      </ListItem>\r\n    </li>\r\n  );\r\n}\r\n\r\nListItemLink.propTypes = {\r\n  icon: PropTypes.element,\r\n  primary: PropTypes.string.isRequired,\r\n  to: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default ListItemLink;\r\n\r\n","import { Container, Dialog, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nexport default function ListInfo(props) {\r\n  const { data, open, onClose, title, keyNames } = props;\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  // console.log(data);\r\n  // Object.keys(data).map((v, k) => { console.log(`v: ${v}, k: ${k}`) })\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          if (!data[v]) return undefined;\r\n          if (typeof (data[v]) === 'object') {\r\n            return <ListItem key={k} button onClick={() => {\r\n              setChild(data[v]);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            const s = `${data[v]}`;\r\n            return <ListItem key={k}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                <Typography variant=\"body1\">{s.slice(0, 20) + (s.length > 20 ? \"...\" : \"\")}</Typography>\r\n              </ListItemSecondaryAction>\r\n            </ListItem>\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListInfo data={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListInfo> : undefined}\r\n    </DialogContent>\r\n  </Dialog>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { objectUpdate } from \"../utils/utils\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nfunction ActionTag(props) {\r\n  const { action, useActions } = props;\r\n  if (!action) return null;\r\n  return <Card style={{ minWidth: 200, margin: 10 }}>\r\n    <CardContent>\r\n      <Typography variant=\"h5\">{action.name}</Typography>\r\n      <Typography variant=\"body1\">{action.desc}</Typography>\r\n    </CardContent>\r\n    {useActions ? <CardActions>\r\n      <Button color=\"primary\">使用</Button>\r\n    </CardActions> : null}\r\n  </Card>\r\n}\r\n\r\nexport default function Actions(props) {\r\n  const { useActions } = props;\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const actions = store.getState().types.actions;\r\n  if (!actions && !requesting) {\r\n    setRequesting(true);\r\n    api.request(\"action\", 'GET').then(resp => {\r\n      // console.log(\"resp\", resp);\r\n      store.dispatch(updateTypes(\"actions\", resp.data.actions));\r\n      forceUpdate();\r\n    });\r\n  }\r\n  // console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!actions) {\r\n    content = <Typography variant=\"body1\">正在加载Action类型...</Typography>\r\n  } else {\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(actions).map((action_type, k) => <ActionTag key={k} useActions={useActions} action={actions[action_type]}></ActionTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Box, Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, TextField, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { objectUpdate } from \"../utils/utils\";\r\n\r\nexport default function ListEdit(props) {\r\n  const { defaultValue, open, onClose, title, keyNames } = props;\r\n  const onSave = props.onSave ? props.onSave : null;\r\n  const [data, setInnerData] = React.useState(defaultValue);\r\n  const setData = (update) => setInnerData(objectUpdate(data, update));\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n\r\n  const handleSave = () => {\r\n    onSave(data);\r\n  }\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          if (((typeof (data[v]) !== \"string\")) && !data[v]) return undefined;\r\n          if (typeof (data[v]) === 'object') {\r\n            return <ListItem key={k} button onClick={() => {\r\n              setChild(data[v]);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            return <ListItem key={k}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                <TextField value={`${data[v]}`} onChange={e => {\r\n                  const newValue = (typeof (data[v]) === \"number\" ? parseFloat(e.target.value) : `${e.target.value}`);\r\n                  setData({ [v]: newValue });\r\n                }}></TextField>\r\n              </ListItemSecondaryAction>\r\n            </ListItem>\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListEdit defaultValue={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListEdit> : undefined}\r\n    </DialogContent>\r\n    {onSave ? <DialogActions>\r\n      <Button color=\"primary\" onClick={handleSave}>保存</Button>\r\n      <Button onClick={onClose}>取消</Button>\r\n    </DialogActions> : <DialogActions><Box style={{ width: \"100%\", height: \"100%\", display: \"flex\", justifyContent: \"center\" }}><Typography style={{ height: \"100%\" }} variant=\"body1\" color=\"secondary\">无法保存</Typography></Box></DialogActions>}\r\n  </Dialog>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { deepCopy, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\nimport ListEdit from \"./ListEdit\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nexport function isTriggerModified(item, type = \"triggers\") {\r\n  return !isObjectValueEqual(item.data, store.getState().types[type][item.type].data);\r\n}\r\n\r\nexport function TriggerTag(props) {\r\n  let { trigger, selectMode, onClick, onSave } = props;\r\n  const [dialogOpen, setDialogOpen] = React.useState(false);\r\n  const [toUse, setToUse] = React.useState(false);\r\n  onClick = onClick ? onClick : () => { };\r\n  if (!trigger) return null;\r\n  const handleCloseDialog = () => { setDialogOpen(false); };\r\n  const handleClick = newTrigger => {\r\n    onClick(newTrigger ? newTrigger : trigger, selectMode);\r\n  };\r\n  return <Card style={{ minWidth: 200, margin: 10 }}>\r\n    <CardContent onClick={selectMode ? () => { } : () => { handleClick(); }}>\r\n      <Typography variant=\"h5\">{trigger.name}</Typography>\r\n      <Typography variant=\"body1\">{trigger.desc}</Typography>\r\n      <ListEdit open={dialogOpen} onClose={handleCloseDialog} defaultValue={trigger.data} onSave={newData => {\r\n        let newTrigger = deepCopy(trigger);\r\n        newTrigger.data = newData;\r\n        console.log(newData);\r\n        onSave && onSave(newTrigger);\r\n        handleCloseDialog();\r\n        if (toUse) handleClick(newTrigger);\r\n      }}></ListEdit>\r\n    </CardContent>\r\n    {selectMode ? <CardActions>\r\n      <Button color=\"primary\" onClick={selectMode ? () => { handleClick(); } : () => { }}>使用</Button>\r\n      <Button color=\"primary\" onClick={() => { setDialogOpen(true); setToUse(true); }}>修改设置并使用</Button>\r\n    </CardActions> : <CardActions>\r\n      <Button color={isTriggerModified(trigger, \"triggers\") ? \"primary\" : \"secondary\"} onClick={() => { setDialogOpen(true); }}>修改设置</Button>\r\n    </CardActions>}\r\n  </Card>\r\n}\r\n\r\nexport default function Triggers(props) {\r\n  let { selectMode, onClick } = props;\r\n  onClick = onClick ? onClick : () => { };\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const triggers = store.getState().types.triggers;\r\n  if (!triggers && !requesting) {\r\n    setRequesting(true);\r\n    api.request(\"trigger\", 'GET').then(resp => {\r\n      // console.log(\"resp\", resp);\r\n      store.dispatch(updateTypes(\"triggers\", resp.data.triggers));\r\n      forceUpdate();\r\n    });\r\n  }\r\n  // console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!triggers) {\r\n    content = <Typography variant=\"body1\">正在加载触发器类型...</Typography>\r\n  } else {\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(triggers).map((trigger_type, k) => <TriggerTag onClick={onClick} key={k} selectMode={selectMode} trigger={triggers[trigger_type]}></TriggerTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Container } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport Actions from \"../components/Actions\";\r\nimport Triggers from \"../components/Triggers\";\r\n\r\nexport default function Launch(props) {\r\n  return <Container>\r\n    <Triggers useActions={false} onClick={(trigger) => {\r\n      console.log(trigger);\r\n    }}></Triggers>\r\n    <Actions useActions={true}></Actions>\r\n  </Container>\r\n}","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { funDownload } from \"../utils/utils\";\r\nimport ListInfo from \"../components/ListInfo\";\r\n\r\nfunction Settings(props) {\r\n  const [themeName, setThemeName] = React.useState(store.getState().config.data.theme_name);\r\n  const refConfigFileInput = React.useRef();\r\n  const [resetSettingsOpen, setResetSettingsOpen] = React.useState(false);\r\n  const [deleteDataOpen, setDeleteDataOpen] = React.useState(false);\r\n  const [openDaemon, setOpenDaemon] = React.useState(false);\r\n  const [openUser, setOpenUser] = React.useState(false);\r\n\r\n  const resetSettings = function () {\r\n    let c = store.getState().config;\r\n    c.data = c.data_default;\r\n    c.save();\r\n    c.load();\r\n    store.dispatch(setConfig(c));\r\n  }\r\n\r\n  const user = store.getState().user;\r\n\r\n  return (<Container maxWidth=\"md\">\r\n    <List>\r\n      <ListSubheader>用户账号</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"用户名\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          {user.username}\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenUser(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button>\r\n        <ListItemText primary=\"修改信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>用户门店</ListSubheader>\r\n      <ListItem button onClick={() => { setOpenDaemon(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>外观</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"主题设置\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <FormControl>\r\n            {/* <InputLabel></InputLabel> */}\r\n            <Select value={themeName} onChange={e => {\r\n              setThemeName(e.target.value);\r\n              let c = store.getState().config;\r\n              c.data.theme_name = e.target.value;\r\n              c.theme = c.theme_avaliable[c.data.theme_name];\r\n              c.save();\r\n              store.dispatch(setConfig(c));\r\n              setTimeout(() => { window.location.reload(); }, 200);\r\n            }}>\r\n              {store.getState().config.data.theme_avaliable.map((v, k) => <MenuItem key={k} value={v}>{v}</MenuItem>)}\r\n            </Select>\r\n          </FormControl>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListSubheader>数据管理</ListSubheader>\r\n      <ListItem button onClick={() => {\r\n        funDownload(store.getState().config.save(), `团购杀手配置数据(${new Date().toLocaleString()}).json`);\r\n      }}>\r\n        <ListItemText primary=\"数据导出\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        // console.log(refConfigFileInput)\r\n        refConfigFileInput.current.click();\r\n      }}>\r\n        <ListItemText primary=\"数据导入\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <input type=\"file\" accept=\".json\" hidden name=\"file-gbk-data\" ref={refConfigFileInput} onChange={e => {\r\n            // console.log(e);\r\n            let files = e.target.files;\r\n            if (files.length === 0) {\r\n              store.dispatch(setMessage(\"未选择文件\"));\r\n              return;\r\n            }\r\n            try {\r\n              let file = files[0];\r\n              let reader = new FileReader();\r\n              reader.readAsText(file, 'UTF-8');\r\n              reader.onload = evt => {\r\n                const fileData = evt.target.result;\r\n                try {\r\n                  const js = JSON.parse(fileData);\r\n                  if (!js.version_frontend) {\r\n                    store.dispatch(setMessage(\"文件类型错误或者文件已经损坏\"));\r\n                    return;\r\n                  }\r\n                  if (js.version_frontend > store.getState().config.data.version_frontend) {\r\n                    store.dispatch(setMessage(`存档文件版本(${js.version_frontend}高于当前版本${store.getState().config.data.version_frontend})，请更新到最新版`));\r\n                    return;\r\n                  }\r\n                  let c = store.getState().config;\r\n                  c.data = js;\r\n                  store.dispatch(setConfig(c));\r\n                  store.dispatch(setMessage(\"数据导入完成\"));\r\n                } catch (e) {\r\n                  store.dispatch(setErrorInfo(e));\r\n                }\r\n              };\r\n            } catch (e) {\r\n              store.dispatch(setErrorInfo(e));\r\n            }\r\n          }}></input>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置数据同步\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Switch defaultChecked={store.getState().config.data.settings_async} onChange={e => {\r\n            let c = store.getState().config;\r\n            c.data.settings_async = e.target.checked;\r\n            c.save();\r\n            store.dispatch(setConfig(c));\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setResetSettingsOpen(true)}>\r\n        <ListItemText primary=\"回到默认设置\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setDeleteDataOpen(true)}>\r\n        <ListItemText primary=\"删除所有数据\"></ListItemText>\r\n      </ListItem>\r\n    </List>\r\n    <ListInfo data={store.getState().user} open={openUser} keyNames={{\r\n      username: '用户名', nick: '昵称', phone: '用户手机号', profile: '详细信息', state: '用户状态', created_at: '创建于', updated_at: '更新于'\r\n    }} title=\"用户信息\" onClose={() => { setOpenUser(false); }}></ListInfo>\r\n    <ListInfo data={store.getState().daemon} open={openDaemon} keyNames={{\r\n      cookies: '远程登录凭据', shop_info: \"门店详细信息\", solution_id: \"解决方案编号\"\r\n    }} title=\"门店信息\" onClose={() => { setOpenDaemon(false); }}></ListInfo>\r\n    <Dialog open={resetSettingsOpen} onClose={() => setResetSettingsOpen(false)}>\r\n      <DialogTitle>\r\n        回到默认设置\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除所有设置数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setResetSettingsOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={deleteDataOpen} onClose={() => setDeleteDataOpen(false)}>\r\n      <DialogTitle>\r\n        删除所有数据\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除软件数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setDeleteDataOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  </Container>)\r\n}\r\n\r\nexport default Settings;","import store from \"../data/store\";\r\n\r\n\r\nclass WebSocketAPI {\r\n  constructor(url) {\r\n    this.connect = this.connect.bind(this);\r\n    this.url = url || store.getState().config.data.remote_login.server || \"ws://127.0.0.1:8081\";\r\n    this.ws = null;\r\n    this.onopen = () => {\r\n      console.log('Connection started');\r\n    };\r\n    this.ondata = e => {\r\n      if (e.cmd === 'code') {\r\n        this.oncode(e.data);\r\n      } else if (e.cmd === 'cookies') {\r\n        this.oncookies(e.data);\r\n      }\r\n    };\r\n    this.onmessage = e => {\r\n      // console.log('onmessage', e);\r\n      this.ondata(JSON.parse(e.data));\r\n    };\r\n    this.onerror = e => {\r\n      console.error(e);\r\n    };\r\n    this.onclose = () => {\r\n      console.log('Connection closed');\r\n    };\r\n    this.oncode = code => { console.log('code', code); }\r\n    this.oncookies = cookies => { console.log('cookies', cookies); }\r\n  }\r\n  connect() {\r\n    this.ws = this.ws || new WebSocket(this.url);\r\n    this.ws.onopen = this.onopen;\r\n    this.ws.onclose = this.onclose;\r\n    this.ws.onerror = this.onerror;\r\n    this.ws.onmessage = this.onmessage;\r\n  }\r\n  close() {\r\n    if (this.ws) this.ws.close();\r\n  }\r\n}\r\n\r\nexport { WebSocketAPI };","import { Box, Container, Paper } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { WebSocketAPI } from '../api/remote_login';\r\nimport { setConfig, setDaemon } from '../data/action';\r\nimport store from '../data/store';\r\nconst QRCode = require('qrcode.react');\r\n\r\nfunction CenterBox(props) {\r\n  const { children } = props;\r\n  return <Box style={{ width: '100%', height: '100%', display: \"flex\", justifyContent: \"center\", flexDirection: \"column\" }}><Box style={{ width: '100%', textAlign: \"center\" }}>{children}</Box></Box>;\r\n}\r\n\r\nexport default class RemoteLogin extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      code: null,\r\n      loginDone: false\r\n    };\r\n    this.ws_api = null;\r\n    // this.unsubscribe = store.subscribe(async () => {\r\n    //   if (this.loginDone) return;\r\n    //   let state = store.getState();\r\n    //   if (state.daemon) {\r\n    //     this.setState({ loginDone: true });\r\n    //     if (this.ws_api) this.ws_api.close();\r\n    //   }\r\n    // });\r\n    setTimeout(async () => {\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      const res = await api.request('remote_login', \"PATCH\");\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      const server = res.data.server;\r\n      let config = store.getState().config;\r\n      config.data.remote_login.server = server;\r\n      store.dispatch(setConfig(config));\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      this.ws_api = new WebSocketAPI(server);\r\n      this.ws_api.oncode = code => {\r\n        // console.log('code', code);\r\n        if (store.getState().daemon || this.state.loginDone) return;\r\n        this.setState({ code });\r\n      };\r\n      this.ws_api.oncookies = async cookies => {\r\n        const resp = await api.request('remote_login', \"POST\", { cookies });\r\n        console.log('done', resp);\r\n        if (store.getState().daemon || this.state.loginDone) return;\r\n        this.setState({ loginDone: true });\r\n        const daemon = await api.request('remote_login', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        }\r\n      }\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      this.ws_api.connect();\r\n    }, 1000);\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.ws_api) this.ws_api.close();\r\n    // this.unsubscribe();\r\n  }\r\n  render() {\r\n    let content = null;\r\n    if (this.state.loginDone) {\r\n      content = <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>登录完成</CenterBox>\r\n      </Paper>;\r\n    } else {\r\n      content = this.state.code ? <QRCode value={JSON.stringify(this.state.code)} size={200} /> : <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>正在加载二维码...</CenterBox>\r\n      </Paper>;\r\n    }\r\n    return (<Container>\r\n      {content}\r\n    </Container>);\r\n  }\r\n}","import { Box, Button, Container, Divider, TextField, Typography, Zoom, Fade } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { setMessage, setUser } from '../data/action';\r\nimport store from '../data/store';\r\nimport { objectUpdate } from '../utils/utils';\r\n\r\n\r\nfunction LoginFrame(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    captcha: \"\",\r\n    actionType: 'login'\r\n  });\r\n  const refUsername = React.useRef();\r\n  const refPassword = React.useRef();\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n  // style={{ display: \"flex\", justifyContent: 'center', alignItems: \"center\", flexDirection: \"column\", }}\r\n  const actionLogin = state.actionType === 'login' ? true : false;\r\n  const handleAction = async () => {\r\n    // console.log('handle', actionLogin);\r\n    if (actionLogin) {\r\n      const res = await api.request('session', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code !== 200) return;\r\n      // 获取user\r\n      const user = await api.request('user', 'GET');\r\n      if (user.code !== 200) return;\r\n      console.log('user', user.data.user);\r\n      store.dispatch(setUser(user.data.user));\r\n    } else {\r\n      // 注册，注册成功则跳转登录\r\n      const res = await api.request('user', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code === 200) {\r\n        // 弹窗\r\n        store.dispatch(setMessage(\"注册成功\"));\r\n        setState({actionType: 'login'});\r\n      }\r\n    }\r\n  }\r\n\r\n  return (<Box>\r\n    <Typography variant=\"h4\">{actionLogin ? \"登录\" : \"注册\"}</Typography>\r\n    <br />\r\n    <Divider></Divider>\r\n    <br />\r\n    <TextField fullWidth ref={refUsername} label=\"用户名\" variant=\"outlined\" value={state.username} onChange={e => {\r\n      setState({ username: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        refPassword.current.querySelector(\"input\").focus();\r\n      }\r\n    }} />\r\n    <br /><br />\r\n    <TextField fullWidth ref={refPassword} label=\"密码\" variant=\"outlined\" value={state.password} type=\"password\" onChange={e => {\r\n      setState({ password: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        handleAction();\r\n      }\r\n    }} />\r\n    <Fade in={actionLogin} style={{ display: actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>登录</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => setState({ actionType: \"sign_in\" })}>注册</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n    <Fade in={!actionLogin} style={{ display: !actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>注册</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" onClick={() => setState({ actionType: 'login' })}>返回登录</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n  </Box >);\r\n}\r\n\r\nexport default function Login(props) {\r\n  return <Container maxWidth=\"sm\">\r\n    <LoginFrame></LoginFrame>\r\n  </Container>\r\n}","import { Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListSubheader, Typography } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport React from \"react\";\r\nimport Actions from \"../components/Actions\";\r\nimport Triggers from \"../components/Triggers\";\r\nimport { TriggerTag, isTriggerModified } from \"../components/Triggers\";\r\nimport store from \"../data/store\";\r\nimport { arrayRemove, deepCopy, objectUpdate } from \"../utils/utils\";\r\n\r\n\r\nfunction TaskTag(props) {\r\n  const { task } = props;\r\n  return <code>{JSON.stringify(task)}</code>;\r\n}\r\n\r\nexport default function Tasks(props) {\r\n  const tasks = store.getState().tasks;\r\n  const [state, setInnerState] = React.useState({\r\n    dialogAddTaskOpen: false,\r\n    dialogAddTriggerOpen: false,\r\n    dialogAddActionOpen: false,\r\n    dialogUpdateTrigger: false,\r\n    triggers: []\r\n  });\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n\r\n  const dialogAddTask = <Dialog fullWidth open={state.dialogAddTaskOpen} onClose={() => setState({ dialogAddTaskOpen: false })}>\r\n    <DialogTitle>添加新任务</DialogTitle>\r\n    <DialogContent>\r\n      <List>\r\n        <ListSubheader>触发器列表</ListSubheader>\r\n        {state.triggers.map((trigger, k) => <ListItem key={k}>\r\n          <TriggerTag trigger={trigger} onSave={data => {\r\n            console.log('saveing', data);\r\n            let newTriggers = deepCopy(state.triggers);\r\n            newTriggers[k] = data;\r\n            console.log(\"newTriggers\", newTriggers);\r\n            setState({ triggers: newTriggers });\r\n          }}></TriggerTag>\r\n          <ListItemSecondaryAction>\r\n            <IconButton onClick={() => {\r\n              let newTriggers = deepCopy(state.triggers);\r\n              newTriggers.splice(k, 1);\r\n              console.log(\"newTriggers\", newTriggers);\r\n              setState({ triggers: newTriggers });\r\n            }}>\r\n              <DeleteIcon></DeleteIcon>\r\n            </IconButton>\r\n          </ListItemSecondaryAction>\r\n        </ListItem>)}\r\n        <ListItem>\r\n          <Button onClick={() => { setState({ dialogAddTriggerOpen: true }) }} color=\"primary\" variant=\"outlined\">添加触发器</Button>\r\n        </ListItem>\r\n      </List>\r\n      <Dialog open={state.dialogAddTriggerOpen} onClose={() => setState({ dialogAddTriggerOpen: false })}>\r\n        <DialogTitle>选择一个触发器</DialogTitle>\r\n        <DialogContent>\r\n          <Triggers onClick={trigger => {\r\n            console.log(\"trigger\", trigger);\r\n            let triggers = deepCopy(state.triggers);\r\n            triggers.push(trigger);\r\n            setState({ dialogAddTriggerOpen: false, triggers: triggers });\r\n          }} selectMode></Triggers>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button color=\"primary\">确定</Button>\r\n      <Button onClick={() => setState({ dialogAddTaskOpen: false })}>取消</Button>\r\n    </DialogActions>\r\n  </Dialog>;\r\n\r\n  return <Container>\r\n    <Grid container spacing={3}>\r\n      <Grid item lg={8} sm={12}>\r\n        <Typography variant=\"h4\">任务列表</Typography>\r\n        <List>\r\n          {tasks.map((task, k) => <ListItem><TaskTag task={task} key={k}></TaskTag></ListItem>)}\r\n        </List>\r\n      </Grid>\r\n      <Grid item lg={4} sm={12}>\r\n        <Container maxWidth=\"xs\">\r\n          <List>\r\n            <ListSubheader>新任务</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => { setState({ dialogAddTaskOpen: true }) }}>添加新任务</Button>\r\n            </ListItem>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\">设置默认任务</Button>\r\n            </ListItem>\r\n\r\n            <ListSubheader>全部任务管理</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"outlined\">删除全部任务</Button>\r\n            </ListItem>\r\n          </List>\r\n        </Container>\r\n      </Grid>\r\n    </Grid>\r\n    {dialogAddTask}\r\n  </Container>\r\n}","import React from 'react';\r\nimport \"@fontsource/roboto\";\r\nimport clsx from 'clsx';\r\nimport Container from '@material-ui/core/Container';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport AssignmentIcon from '@material-ui/icons/Assignment';\r\nimport AlarmIcon from '@material-ui/icons/Alarm';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport StorageIcon from '@material-ui/icons/Storage';\r\nimport VerifiedUserIcon from '@material-ui/icons/VerifiedUser';\r\nimport PhonelinkIcon from '@material-ui/icons/Phonelink';\r\nimport {\r\n  HashRouter as Router,\r\n  // BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\r\nimport { Provider } from 'react-redux'\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport store from './data/store';\r\nimport { setConfig, setDaemon, setErrorInfo, setMessage, setReserveTableData, setRoomStockData, setShopInfo } from \"./data/action\";\r\n\r\nimport { isIterator, isMobileDevice, sleep } from \"./utils/utils\";\r\nimport { api } from \"./api/api\";\r\n\r\nimport ListItemLink from \"./components/ListItemLink\";\r\nimport Launch from \"./pages/Launch\";\r\nimport Settings from \"./pages/Settings\";\r\nimport './App.css';\r\nimport { Box, Button, Dialog, DialogActions, DialogContent, DialogTitle, ListItem, Snackbar } from '@material-ui/core';\r\nimport RemoteLogin from './pages/RemoteLogin';\r\nimport Login from './pages/Login';\r\nimport Tasks from \"./pages/Tasks\";\r\n\r\nconst drawerWidth = 240;\r\nmoment.locale('zh-cn');\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n    width: '100%',\r\n    // overflowX: 'auto',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  hide: {\r\n    display: 'none',\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    flexShrink: 0,\r\n    whiteSpace: 'nowrap',\r\n  },\r\n  drawerOpen: {\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerClose: {\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n    width: theme.spacing(7) + 1,\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  toolbar: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // necessary for content to be below app bar\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3),\r\n    width: '100%',\r\n    overflowX: 'auto',\r\n  },\r\n}));\r\n\r\n// const api = new API();\r\n// const authApi = new AuthAPI();\r\n// api.get_shop_info().then(shopInfo => {\r\n//   console.log('shopInfo', shopInfo);\r\n//   if (shopInfo) store.dispatch(setShopInfo(shopInfo));\r\n// }).catch(e => {\r\n//   store.dispatch(setErrorInfo(e));\r\n// })\r\n\r\nlet subscribers = {};\r\n\r\nlet last_data = {\r\n  config: null,\r\n  user: null,\r\n  daemon: null\r\n};\r\n\r\nstore.subscribe(async () => {\r\n  let state = store.getState();\r\n  // console.log('redux update to', state);\r\n  // 保存 config\r\n  if (state.config.data) {\r\n    if (JSON.stringify(state.config.data) !== JSON.stringify(last_data.config)) {\r\n      // console.log('Config will change:', state.config.data);\r\n      state.config.save();\r\n      if (store.getState().user && store.getState().config.data.settings_async) {\r\n        await api.request('sync', 'POST', { config: state.config.data });\r\n      }\r\n    } else {\r\n      // console.log('Not change:', state.config.data);\r\n    }\r\n    last_data.config = state.config.data;\r\n  }\r\n  for (let subFunc in subscribers) {\r\n    subscribers[subFunc](state);\r\n  }\r\n});\r\n\r\nconst getShopTitle = function () {\r\n  if (!(store.getState().daemon && store.getState().daemon.shop_info && store.getState().daemon.shop_info.shopName)) return null;\r\n  // console.log('getShopTitle', store.getState().daemon.shop_info);\r\n  const title = `${store.getState().daemon.shop_info.shopName} - ${store.getState().daemon.shop_info.branchName}`;\r\n  // console.log(title);\r\n  return title;\r\n}\r\n\r\nexport default function App() {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [popupLogin, setPopupLogin] = React.useState(false);\r\n  const [errorDialogInfo, setErrorDialogInfo] = React.useState(false);\r\n  const [myMessage, setMyMessage] = React.useState(null);\r\n  const [hasLogin, setHasLogin] = React.useState(false);\r\n  const titleDefault = \"团购杀手 - KTV体验版\";\r\n  const [title, setTitle] = React.useState(getShopTitle() || titleDefault);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n\r\n  // 拉大到800会打开，拉小到600关闭\r\n  const triggerWidthOpen = 800;\r\n  const triggerWidthClose = 600;\r\n\r\n  // 注册一个当遇到错误的时候调用的钩子吧，用来显示错误信息\r\n  subscribers['Error'] = function (state) {\r\n    if (state.errorInfo) {\r\n      console.log('Error Hook: ', state.errorInfo);\r\n      setErrorDialogInfo(state.errorInfo);\r\n      // 清空错误信息\r\n      store.dispatch(setErrorInfo(null));\r\n    }\r\n  };\r\n  // 注册一个消息钩子\r\n  subscribers['Message'] = function (state) {\r\n    if (state.message) {\r\n      console.log('message: ', state.message);\r\n      setMyMessage(state.message);\r\n      store.dispatch(setMessage(null));\r\n    }\r\n  };\r\n  subscribers['User'] = async function (state) {\r\n    if (state.user) {\r\n      if (JSON.stringify(state.user) != JSON.stringify(last_data.user)) {\r\n        forceUpdate();\r\n        // 登录信息完成，触发获取daemon\r\n        // if (!last_data.user) \r\n        if (!last_data.user) {\r\n          // store.dispatch(setDaemon(false));\r\n          console.log('trigger');\r\n        }\r\n      }\r\n      last_data.user = state.user;\r\n    }\r\n  };\r\n  subscribers['Daemon'] = async function (state) {\r\n    if (state.daemon) {\r\n      if (JSON.stringify(state.daemon) != JSON.stringify(last_data.daemon)) {\r\n        forceUpdate();\r\n      }\r\n      last_data.daemon = state.daemon;\r\n      if (state.daemon.shop_info) {\r\n        if (title === titleDefault) {\r\n          setTitle(getShopTitle());\r\n        }\r\n      }\r\n    }\r\n    // if (state.daemon === false) {\r\n    //   store.dispatch(setDaemon(null));\r\n    //   const daemon = await api.request('daemon', 'GET');\r\n    //   if (daemon.code === 200 && daemon.data.uid) {\r\n    //     store.dispatch(setDaemon(daemon.data));\r\n    //   } else store.dispatch(setDaemon(null));\r\n    // }\r\n  };\r\n  // onMount & onUpdate\r\n  React.useEffect(() => {\r\n    const onWindowResize = () => {\r\n      let width = window.innerWidth;\r\n      // console.log(width);\r\n      if (!open && width >= triggerWidthOpen) setOpen(true);\r\n      if (open && width <= triggerWidthClose) setOpen(false);\r\n    };\r\n    window.addEventListener(\"load\", onWindowResize);\r\n    window.addEventListener('resize', onWindowResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"load\", onWindowResize);\r\n      window.removeEventListener(\"resize\", onWindowResize);\r\n    };\r\n  });\r\n\r\n\r\n  const handleLoginOpen = () => {\r\n    // console.log('handleLoginOpen');\r\n    setPopupLogin(true);\r\n  };\r\n\r\n  const handleLoginClose = () => {\r\n    setPopupLogin(false);\r\n  };\r\n\r\n  const handleClickAction = () => {\r\n    if (window.innerWidth < 600 || window.location.pathname === '/') {\r\n      setOpen(false);\r\n    }\r\n  };\r\n\r\n  const mainContent = <Router>\r\n    <MuiPickersUtilsProvider utils={MomentUtils} locale=\"zh-cn\">\r\n      <CssBaseline />\r\n      <AppBar\r\n        position=\"fixed\"\r\n        className={clsx(classes.appBar, {\r\n          [classes.appBarShift]: open,\r\n        })}\r\n      >\r\n        <Toolbar>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={() => { setOpen(true); }}\r\n            edge=\"start\"\r\n            className={clsx(classes.menuButton, {\r\n              [classes.hide]: open,\r\n            })}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" noWrap className={classes.title}>\r\n            {title}\r\n          </Typography>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"login\"\r\n            onClick={handleLoginOpen}\r\n          >\r\n            <AccountCircleIcon />\r\n          </IconButton>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        className={clsx(classes.drawer, {\r\n          [classes.drawerOpen]: open,\r\n          [classes.drawerClose]: !open,\r\n        })}\r\n        classes={{\r\n          paper: clsx({\r\n            [classes.drawerOpen]: open,\r\n            [classes.drawerClose]: !open,\r\n          }),\r\n        }}\r\n      >\r\n        <div className={classes.toolbar}>\r\n          <IconButton onClick={() => { setOpen(false); }}>\r\n            {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List onClick={handleClickAction}>\r\n          <ListItemLink to=\"/\" primary=\"启动页\" icon={<DashboardIcon />} />\r\n          <ListItemLink to=\"/tasks\" primary=\"任务\" icon={<AssignmentIcon />} />\r\n          <ListItemLink to=\"/settings\" primary=\"设置\" icon={<SettingsIcon />} />\r\n        </List>\r\n      </Drawer>\r\n      <main className={classes.content}>\r\n        <div className={classes.toolbar} />\r\n        <Switch>\r\n          <Route path={\"/\"} exact={true}>\r\n            <Launch />\r\n          </Route>\r\n          <Route path={\"/tasks\"} exact={true}>\r\n            <Tasks />\r\n          </Route>\r\n          <Route path={\"/settings\"} exact={false}>\r\n            <Settings />\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n    </MuiPickersUtilsProvider>\r\n  </Router>;\r\n\r\n  const user = store.getState().user;\r\n  const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n  let content = isNowLogining ? <Box>正在登录...</Box> : (user ? mainContent : <Login></Login>);\r\n  if ((!isNowLogining && user) && !store.getState().daemon) {\r\n    content = <RemoteLogin></RemoteLogin>\r\n  }\r\n  // console.log('app.js user', user, 'content', content);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <ThemeProvider theme={store.getState().config.theme}>\r\n        {content}\r\n        <Dialog open={errorDialogInfo ? true : false} onClose={() => { setErrorDialogInfo(null); }}>\r\n          <DialogTitle>遇到错误</DialogTitle>\r\n          <DialogContent>\r\n            <Typography variant=\"body1\">错误信息</Typography>\r\n            <Box component=\"div\">\r\n              <Box component=\"div\">\r\n                {() => {\r\n                  if (isIterator(errorDialogInfo) && typeof (errorDialogInfo) !== 'string') {\r\n                    return <List>\r\n                      {errorDialogInfo.map((d, i) => <ListItem key={i}>\r\n                        <code>{JSON.stringify(d) === '{}' ? d.toString() : JSON.stringify(d)}</code>\r\n                      </ListItem>)}\r\n                    </List>;\r\n                  } else {\r\n                    return <code>{JSON.stringify(errorDialogInfo) === '{}' ? errorDialogInfo.toString() : JSON.stringify(errorDialogInfo)}</code>;\r\n                  }\r\n                }}\r\n              </Box>\r\n            </Box>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button color=\"primary\" onClick={() => { window.location.reload() }}>刷新</Button>\r\n            <Button color=\"primary\" onClick={() => { setErrorDialogInfo(null); }}>取消</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        <Snackbar\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'right',\r\n          }}\r\n          open={myMessage !== null}\r\n          autoHideDuration={6000}\r\n          // onClose={(e) => { console.log(e); }}\r\n          message={myMessage}\r\n          action={\r\n            <React.Fragment>\r\n              <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={() => setMyMessage(null)}>\r\n                <CloseIcon fontSize=\"small\" />\r\n              </IconButton>\r\n            </React.Fragment>\r\n          }\r\n        />\r\n      </ThemeProvider>\r\n    </div >\r\n  );\r\n}\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from './data/store';\r\nimport { Provider } from 'react-redux';\r\nimport { api } from './api/api';\r\nimport { setConfig, setDaemon, setErrorInfo, setRoomStockPlans, setTimetableNodes, setTimetablePeriods, setUser } from './data/action';\r\nimport { sleep } from './utils/utils';\r\n\r\n// 循环执行函数\r\nasync function cycleFunc(cycle = 1000) {\r\n  while (true) {\r\n    try {\r\n\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    await sleep(cycle);\r\n  }\r\n}\r\n\r\n// 开始执行的函数\r\nasync function startFunc() {\r\n  setTimeout(async () => {\r\n    const user = store.getState().user;\r\n    const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n    if (isNowLogining) {\r\n      api.load_from_config();\r\n      const res = await api.request('user', 'GET');\r\n      // console.log('index res', res)\r\n      if (res.code === 200) {\r\n        // console.log('saving user', res.data.user)\r\n        store.dispatch(setUser(res.data.user));\r\n        const daemon = await api.request('daemon', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        } else store.dispatch(setDaemon(null));\r\n      }\r\n    }\r\n    // let c = api.download_config();\r\n    // if (!c.settings_async) return;\r\n    // const config_frontend = await api.download_config();\r\n    // if (!config_frontend) {\r\n    //   store.dispatch(setErrorInfo(\"同步设置失败\"));\r\n    // }\r\n    // else store.dispatch(setConfig(config_frontend));\r\n  }, 0);\r\n}\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\nstartFunc().then(() => {\r\n  cycleFunc();\r\n});\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}