{"version":3,"sources":["utils/utils.js","data/action.js","api/api.js","data/reducers.js","Config.js","data/store.js","components/ListItemLink.js","components/ListEdit.js","components/ListInfo.js","components/Actions.js","components/Triggers.js","components/TaskDialog.js","pages/Tasks.js","components/ReserveTable.js","components/ReserveTables.js","pages/Launch.js","pages/Settings.js","api/remote_login.js","pages/RemoteLogin.js","pages/Login.js","pages/Predicts.js","App.js","reportWebVitals.js","index.js"],"names":["sleep","time_ms","Promise","accept","setTimeout","isIterator","obj","Symbol","iterator","deepCopy","data","undefined","d","i","length","push","k","objectUpdate","origin","update","now","isObjectValueEqual","a","b","aProps","Object","getOwnPropertyNames","bProps","propName","propA","propB","hasOwnProperty","Date","prototype","setDay","day","day_","this","getDay","setTime","getTime","toDateString","toISOString","slice","timedeltaUnits","getTimedeltaString","timedelta","unit","keys","getTimedeltaUnit","toFixed","weekDayList","setConfig","dispatch","type","setTasks","setUser","setDaemon","setErrorInfo","setMessage","updateTypes","typeData","store","getState","types","api","host","window","location","href","includes","port","api_version","api_prefix","protocol","url","access_token","refresh_token","router","key","method","request","config","api_token","get_token","console","log","set_token","refresh","access","headers","payload","mode","body","JSON","stringify","get_headers","Boolean","fetch","resp","js","json","error","code","status","statusText","message","resp2","js2","update_config","res","user","defaultState","ITEM_NAME","load","bind","save","theme_avaliable","createMuiTheme","palette","primary","main","blueGrey","secondary","grey","data_default","debug","version_frontend","theme_name","settings_async","remote_login","server","theme","parse","localStorage","getItem","Error","e","warn","s","setItem","tasks","daemon","errorInfo","combineReducers","state","action","createStore","reducers","applyMiddleware","thunk","ListItemLink","props","icon","to","renderLink","React","useMemo","forwardRef","itemProps","ref","ListItem","button","component","ListItemIcon","ListItemText","ListEdit","defaultValue","open","onClose","title","keyNames","dataType","typeName","dismiss","onSave","useState","setInnerData","setData","openChild","setOpenChild","child","setChild","childTitle","setChildTitle","timedeltaUnit","setTimedeltaUnit","Dialog","fullWidth","DialogTitle","DialogContent","List","style","width","map","v","indexOf","args","editable","showName","value","onClick","actionData","startsWith","Button","Box","DateTimePicker","onChange","moment","format","IconButton","val","updateFixed","TextField","parseFloat","target","isNaN","newValue","onBlur","Select","MenuItem","ListItemSecondaryAction","DialogActions","color","height","display","justifyContent","Typography","variant","ListInfo","isActionModified","item","updateActionData","callback","then","actions","wrapAction","actionType","action_type","newActionData","getDataString","calendar","ActionTag","selectMode","targets","dialogOpen","setDialogOpen","roomItem","tmp","item_id","itemId","target_price","price","actionTemp","toUse","setToUse","handleCloseDialog","handleClick","newAction","selected","Card","minWidth","margin","CardContent","name","desc","newData","CardActions","Actions","requesting","setRequesting","useReducer","x","forceUpdate","content","flexDirection","flexWrap","updateTriggerData","triggers","isTriggerModified","getTriggerType","trigger","interval","run_date","wrapTrigger","triggerType","triggerData","newTriggerData","TriggerTag","newTrigger","Triggers","trigger_type","taskDialogUpdate","setTaskDialogUpdate","TaskDialog","addMode","onRefresh","taskOld","baseTaskName","taskName","realDefaultTask","task_name","defaultTask","dialogAddTaskOpen","dialogAddTriggerOpen","dialogAddActionOpen","dialogUpdateTrigger","task","requestingTaskData","defaultTid","setInnerState","setState","taskData","task_data","tid","handleAddTask","resolve","reject","ListSubheader","newTask","splice","Grid","container","spacing","xs","lg","disabled","wrapTask","taskWrapped","TaskTag","onUpdate","request_key","getTargetTasks","result","TaskList","marks","getTargetTasksMarks","Tasks","requestingTasks","Container","sm","maxWidth","tids","assign","useStyles","makeStyles","table","foodDesc","overflow","whiteSpace","contentOverflow","planButton","MyTableCell","styles","padding","noBorder","borderBottom","TableCell","align","colSpan","requestedDayData","setUpdateTimer","ReserveTable","classes","requestingDaemon","setRequestingDaemon","requestingUpdate","setRequestingUpdate","date","dayData","setDayData","reserve_table","roomList","setRoomList","setDialogAddTaskOpen","dialogTasksListOpen","setDialogTasksListOpen","roomItemNow","setRoomItemNow","LinearProgress","daemon_args","update_all","TasksListDialog","Period","maxRow","roomNameList","roomData","roomMapItemEntry","roomName","targetRowCenter","parseInt","rows","cells","key2","periodId","className","stock","planCount","Link","parent","arg","TableRow","updateData","reserveTableData","tableHeaderCells","tableHeader","TableHead","roomCapacity","periodList","TableContainer","Paper","Table","stickyHeader","TableBody","roomType","periodDesc","TabPanel","children","index","other","role","hidden","id","aria-labelledby","root","overflowX","flexGrow","background","paper","formControl","selectEmpty","marginTop","ReserveTables","tabValue","setTableValue","showTable","setShowTable","fullShow","setFullShow","Tabs","indicatorColor","textColor","scrollButtons","aria-label","Tab","label","FormControl","InputLabel","event","float","innerWidth","fullScreen","edge","StateNow","unsubscribe","subscribe","timetableNodes","timetablePeriods","roomStockPlans","Component","Launch","Settings","themeName","setThemeName","refConfigFileInput","useRef","resetSettingsOpen","setResetSettingsOpen","deleteDataOpen","setDeleteDataOpen","openDaemon","setOpenDaemon","openUser","setOpenUser","resetSettings","c","username","reload","filename","eleLink","document","createElement","download","blob","Blob","URL","createObjectURL","appendChild","click","removeChild","funDownload","toLocaleString","current","files","file","reader","FileReader","readAsText","onload","evt","fileData","Switch","defaultChecked","checked","nick","phone","profile","created_at","updated_at","cookies","shop_info","solution_id","WebSocketAPI","connect","ws","onopen","ondata","cmd","oncode","oncookies","onmessage","onerror","onclose","WebSocket","close","QRCode","require","CenterBox","textAlign","RemoteLogin","loginDone","ws_api","uid","size","LoginFrame","password","captcha","refUsername","refPassword","actionLogin","handleAction","Divider","onKeyDown","querySelector","focus","Fade","in","timeout","exit","enter","Login","Predicts","useSpan","setUseSpan","openHelp","setOpenHelp","labels","labelShows","predictsResult","setPredictsResult","defaultValues","labelsTemp","labelValues","temp","inputValues","setInputValues","getTempValues","tempValues","items","inputProps","FormControlLabel","control","Checkbox","predict_data","drawerWidth","locale","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","enteringScreen","menuButton","marginRight","hide","flexShrink","drawerOpen","drawerClose","breakpoints","up","toolbar","alignItems","mixins","subscribers","last_data","subFunc","getShopTitle","shopName","branchName","App","useTheme","setOpen","setPopupLogin","errorDialogInfo","setErrorDialogInfo","myMessage","setMyMessage","titleDefault","setTitle","useEffect","onWindowResize","addEventListener","removeEventListener","mainContent","utils","MomentUtils","CssBaseline","AppBar","position","clsx","Toolbar","noWrap","Drawer","direction","pathname","path","exact","isNowLogining","ThemeProvider","toString","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Fragment","fontSize","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","cycle","load_from_config","ReactDOM","render","getElementById","startFunc","cycleFunc"],"mappings":"0pBAmDO,SAASA,GAAMC,GACpB,OAAO,IAAIC,SAAQ,SAAAC,GACjBC,WAAWD,EAAQF,MAmBhB,SAASI,GAAWC,GACzB,OAAc,MAAPA,GAA+C,oBAAzBA,EAAIC,OAAOC,UAmBnC,SAASC,GAASC,GACvB,GAAa,OAATA,QAA0BC,IAATD,EACnB,OAAOA,EACP,GAAIL,GAAWK,IAA2B,kBAAVA,EAAoB,CAEpD,IADA,IAAIE,EAAI,GACCC,EAAI,EAAGA,EAAIH,EAAKI,OAAQD,IAC/BD,EAAEG,KAAKL,EAAKG,IAEd,OAAOD,EACF,GAAsB,kBAAVF,EAAoB,CACrC,IAAIE,EAAI,GACR,IAAK,IAAMI,KAAKN,EACdE,EAAEI,GAAKP,GAASC,EAAKM,IAEvB,OAAOJ,EAEP,OAAOF,EAIJ,SAASO,GAAaC,EAAQC,GACnC,IAAIC,EAAMX,GAASS,GACnB,IAAK,IAAMF,KAAKG,EACdC,EAAIJ,GAAKG,EAAOH,GAElB,OAAOI,EAIF,SAASC,GAAmBC,EAAGC,GACpC,IAAIC,EAASC,OAAOC,oBAAoBJ,GACpCK,EAASF,OAAOC,oBAAoBH,GACxC,GAAIC,EAAOV,SAAWa,EAAOb,OAC3B,OAAO,EAET,IAAK,IAAID,EAAI,EAAGA,EAAIW,EAAOV,OAAQD,IAAK,CACtC,IAAIe,EAAWJ,EAAOX,GAElBgB,EAAQP,EAAEM,GACVE,EAAQP,EAAEK,GAGd,IAAKL,EAAEQ,eAAeH,GAAW,OAAO,EACxC,GAAKC,aAAiBJ,QACpB,IAAIJ,GAAmBQ,EAAOC,GAG5B,OAAO,OAEJ,GAAID,IAAUC,EACnB,OAAO,EAGX,OAAO,EAvFTE,KAAKC,UAAUC,OAAS,SAAUC,GAChC,IAAIC,EAAOC,KAAKC,SAChB,OAAIF,IAASD,GACbE,KAAKE,QAAQF,KAAKG,UAAY,OAAuBL,EAAMC,IADlCC,MAM3BL,KAAKC,UAAUQ,aAAe,WAC5B,OAAOJ,KAAKK,cAAcC,MAAM,EAAG,KA2G9B,IAAMC,GAAiB,CAC5B,SAAK,EAAG,SAAK,GAAI,SAAK,KACtB,SAAK,MAAc,SAAK,QAgBnB,SAASC,GAAmBC,GACjC,GAA2B,kBAAfA,EAAyB,MAAO,GAC5C,IAAMC,EAdD,SAA0BD,GAC/B,GAA2B,kBAAfA,EAAyB,OAAO,KAC5C,GAAIA,GAAaF,GAAenB,OAAOuB,KAAKJ,IAAgBnB,OAAOuB,KAAKJ,IAAgB9B,OAAS,IAC/F,OAAOW,OAAOuB,KAAKJ,IAAgBnB,OAAOuB,KAAKJ,IAAgB9B,OAAS,GAC1E,IAAK,IAAID,EAAI,EAAGA,EAAIY,OAAOuB,KAAKJ,IAAgB9B,OAAQD,IACtD,GAAIiC,EAAYF,GAAenB,OAAOuB,KAAKJ,IAAgB/B,IACzD,OAAOY,OAAOuB,KAAKJ,IAAgB/B,EAAI,GAG3C,OAAOY,OAAOuB,KAAKJ,IAAgB,GAKtBK,CAAiBH,GAC9B,OAAa,OAATC,EAAsB,GAEpB,GAAN,QAAWD,EAAYF,GAAeG,IAAOG,QAAQ,IAArD,OAA0DH,GAGrD,IAAMI,GAAc,CAAC,SAAK,SAAK,SAAK,SAAK,SAAK,SAAK,UCrMnD,SAASC,GAAU1C,GACxB,OAAO,SAAA2C,GACLA,EAAS,CAAEC,KAAM,aAAc5C,KAAMA,KAIlC,SAAS6C,GAAS7C,GACvB,OAAO,SAAA2C,GACLA,EAAS,CAAEC,KAAM,YAAa5C,KAAMA,KAIjC,SAAS8C,GAAQ9C,GACtB,OAAO,SAAA2C,GACLA,EAAS,CAAEC,KAAM,WAAY5C,KAAMA,KAIhC,SAAS+C,GAAU/C,GACxB,OAAO,SAAA2C,GACLA,EAAS,CAAEC,KAAM,aAAc5C,KAAMA,KAIlC,SAASgD,GAAahD,GAC3B,OAAO,SAAA2C,GACLA,EAAS,CAAEC,KAAM,iBAAkB5C,KAAMA,KAItC,SAASiD,GAAWjD,GACzB,OAAO,SAAA2C,GACLA,EAAS,CAAEC,KAAM,cAAe5C,KAAMA,KAWnC,SAASkD,GAAYN,EAAMO,GAChC,OARuBnD,EAQPO,GAAa6C,GAAMC,WAAWC,MAAlB,eAA4BV,EAAOO,IAPxD,SAAAR,GACLA,EAAS,CAAEC,KAAM,YAAa5C,KAAMA,KAFjC,IAAkBA,E,ICmGnBuD,GAAM,I,WAnIV,aAAe,oBAEb5B,KAAK6B,KAAOC,OAAOC,SAASC,KAAKC,SAAS,aAAe,YAAc,KAEvEjC,KAAKkC,KAAO,KACZlC,KAAKmC,YAAc,KACnBnC,KAAKoC,WAAL,eAA0BpC,KAAKmC,aAC/BnC,KAAKqC,SAAW,OAChBrC,KAAKsC,IAAMtC,KAAK6B,KAAL,UAAe7B,KAAKqC,SAApB,cAAkCrC,KAAK6B,KAAvC,YAA+C7B,KAAKkC,MAApD,OAA2DlC,KAAKoC,YAAhE,UAAkFpC,KAAKoC,YAClGpC,KAAKuC,aAAe,GACpBvC,KAAKwC,cAAgB,G,6CAEvB,SAAUD,EAAcC,QAGDlE,IAAjBiE,IACFvC,KAAKuC,aAAeA,QACAjE,IAAlBkE,IACFxC,KAAKwC,cAAgBA,K,uBAEzB,WACE,MAAO,CACLD,aAAoC,KAAtBvC,KAAKuC,kBAAsBjE,EAAY0B,KAAKuC,aAAcC,cAAsC,KAAvBxC,KAAKwC,mBAAuBlE,EAAY0B,KAAKwC,iB,yBAGxI,SAAYC,EAAQC,GAA4B,IAAvBC,EAAsB,uDAAb,MAAOtE,EAAM,uCAC7C,OAAO2B,KAAK4C,QAAL,UAAgBH,EAAhB,YAA0BC,GAAOC,EAAQtE,K,2BAElD,WACE,IAAIwE,EAASpB,GAAMC,WAAWmB,OAC9BA,EAAOxE,KAAKyE,UAAY9C,KAAK+C,YAC7BC,QAAQC,IAAI,wBAAyBJ,EAAOxE,KAAKyE,WAEjDrB,GAAMT,SAASD,GAAU8B,M,8BAE3B,WACE,IAAMA,EAASpB,GAAMC,WAAWmB,OAChC7C,KAAKkD,UAAUL,EAAOxE,KAAKyE,UAAUP,aAAcM,EAAOxE,KAAKyE,UAAUN,iB,yBAE3E,WAA6C,IAAjCW,EAAgC,wDAAfC,IAAe,yDACtCC,EAAU,CACZ,eAAgB,oBAQlB,OANIF,IACFE,EAAO,QAAcrD,KAAKwC,eAExBY,GACwB,KAAtBpD,KAAKuC,eAAqBc,EAAO,cAAoBrD,KAAKuC,cAEzDc,I,4DAET,WAAcZ,GAAd,+CAAAxD,EAAA,6DAAsB0D,EAAtB,+BAA+B,MAAOtE,EAAtC,uBACQiF,EAAU,CACdX,OAAQA,EACRY,KAAM,OACNC,KAAMnF,EAAOoF,KAAKC,UAAUrF,QAAQC,EAEpC+E,QAASrD,KAAK2D,YAAYC,QAAmB,YAAXnB,GAAmC,WAAXE,KAN9D,SAUqBkB,MAAM,GAAD,OAAI7D,KAAKsC,IAAT,YAAgBG,GAAUa,GAVpD,cAUQQ,EAVR,OAWMC,EAAK,KAXX,mBAYmBD,EAAKE,OAZxB,QAYQD,EAZR,gEAaIf,QAAQiB,MAAR,MACAxC,GAAMT,SAASK,GAAa,EAAD,KAd/B,kBAeW,CAAE6C,KAAMJ,EAAKK,OAAQF,MAAOH,EAAKM,aAf5C,WAiBEpB,QAAQC,IAAI,UAAWc,GAClBA,KAEHA,EAAK,IACFM,QAAUP,EAAKM,iBAEJ9F,IAAZyF,EAAGG,OAAoBH,EAAGG,KAAOJ,EAAKK,QAC1B,MAAZJ,EAAGG,KAxBT,oBAyB+B,KAAvBlE,KAAKwC,cAzBb,0CA2Ba,MA3Bb,yBA+BwBqB,MAAM,GAAD,OAAI7D,KAAKsC,IAAT,YAAwB,CAC/CK,OAAQ,MACRY,KAAM,OACNF,QAASrD,KAAK2D,aAAY,KAlChC,eA+BUW,EA/BV,2BAsCwBA,EAAMN,OAtC9B,WAwCuB,OAFXO,EAtCZ,QAwCcL,KAxCd,iBAyCQlE,KAAKkD,UAAUqB,EAAIlG,KAAKkE,aAAcgC,EAAIlG,KAAKmE,eAC/CxC,KAAKwE,gBAGY,OADXC,EAAMzE,KAAK4C,QAAQ,OAAQ,QACzBsB,MACNzC,GAAMT,SAASG,GAAQsD,EAAIpG,KAAKqG,OA9C1C,+BAmDQjD,GAAMT,SAASK,GAAa,iEAnDpC,kBAoDe,MApDf,oFAwDa,CAAE6C,KAAMI,EAAMH,OAAQF,MAAOK,EAAMF,aAxDhD,iCA0DWpE,KAAK4C,QAAQH,EAAQE,EAAQtE,IA1DxC,eA4DkB,MAAZ0F,EAAGG,KAEU,YAAXzB,GAAmC,SAAXE,GAAoB,EACNoB,EAAG1F,KAAnCkE,EADqC,EACrCA,aAAcC,EADuB,EACvBA,cAEtBxC,KAAKkD,UAAUX,EAAcC,GAC7BxC,KAAKwE,iBACe,YAAX/B,GAAmC,WAAXE,IAGjC3C,KAAKkD,UAAU,GAAI,IACnBlD,KAAKwE,iBAGP/C,GAAMT,SAASK,GAAa0C,IA1EhC,kBA4ESA,GA5ET,kE,+DCvDIY,GAAe,CACnB9B,OAAQ,I,WCER,aAAe,yBADf+B,UAAY,qBAEV5E,KAAK6E,KAAO7E,KAAK6E,KAAKC,KAAK9E,MAC3BA,KAAK+E,KAAO/E,KAAK+E,KAAKD,KAAK9E,MAC3BA,KAAKgF,gBAAkB,CACrB,2BAAQC,aAAe,IACvB,2BAAQA,aAAe,CACrBC,QAAS,CACPjE,KAAM,OACNkE,QAAS,CACPC,KAAMC,KAAS,MAEjBC,UAAW,CACTF,KAAMG,KAAK,UAMnBvF,KAAKwF,aAAe,CAClBC,OAAO,EACPC,iBAAkB,GAGlBC,WAAY,2BACZX,gBAAiB,CACf,2BACA,4BAGFY,gBAAgB,EAEhBC,aAAc,CACZC,OAAQ,uBAEVhD,UAAW,IAEb9C,KAAK3B,KAAO2B,KAAKwF,aACjBxF,KAAK+F,MAAQ/F,KAAKgF,gBAAgB,4BAClChF,KAAK6E,O,wCAGP,WACE7B,QAAQC,IAAI,6BACRjD,KAAK3B,KAAKoH,QACZzC,QAAQC,IAAI,gCACZjD,KAAK+E,QAEP,IAEE,GADA/E,KAAK3B,KAAOoF,KAAKuC,MAAMC,aAAaC,QAAQlG,KAAK4E,aAC5C5E,KAAK3B,KAAM,MAAM,IAAI8H,MAAM,aAEhC,GADAnD,QAAQC,IAAI,YAAajD,KAAK3B,OACzB2B,KAAK3B,KAAKqH,kBAAoB1F,KAAK3B,KAAKqH,iBAAmB1F,KAAKwF,aAAaE,iBAAkB,CAIlG,IAAK,IAAI/G,KAFTqE,QAAQC,IAAR,yBAA8BjD,KAAK3B,KAAKqH,iBAAxC,eAA+D1F,KAAKwF,aAAaE,mBACjF1F,KAAK3B,KAAKqH,iBAAmB1F,KAAKwF,aAAaE,iBACjC1F,KAAKwF,aACZxF,KAAK3B,KAAKM,KACbqE,QAAQC,IAAR,gCAAqCtE,IACrCqB,KAAK3B,KAAKM,GAAKqB,KAAKwF,aAAa7G,IAGrCqB,KAAK+E,QAEP,MAAOqB,GACPpD,QAAQqD,KAAR,uBAA6BrG,KAAK4E,UAAlC,0CACA5E,KAAK3B,KAAO2B,KAAKwF,aACjBxF,KAAK+E,OAEP/E,KAAK+F,MAAQ/F,KAAKgF,gBAAgBhF,KAAK3B,KAAKsH,YACvC3F,KAAK+F,QAAO/F,KAAK+F,MAAQ/F,KAAKgF,gBAAL,SAC9BpD,GAAIsB,UAAUlD,KAAK3B,KAAKyE,UAAUP,aAAcvC,KAAK3B,KAAKyE,UAAUN,iB,kBAGtE,WACEQ,QAAQC,IAAI,4BACZjD,KAAK3B,KAAKyE,UAAYlB,GAAImB,YAC1B,IAAMuD,EAAI7C,KAAKC,UAAU1D,KAAK3B,MAE9B,OADA4H,aAAaM,QAAQvG,KAAK4E,UAAW0B,GAC9BA,M,MD/ETE,MAAO,GACP9B,KAAM,KACN+B,OAAQ,KACRC,UAAW,KACXrC,QAAS,KACT1C,MAAO,IAkEMgF,mBAAgB,CAAE9D,OAtDjC,WAAsD,IAAtC+D,EAAqC,uDAA7BjC,GAAa9B,OAAQgE,EAAQ,uCACnD,OAAQA,EAAO5F,MACb,IAAK,aACH,OAAO4F,EAAOxI,KAChB,QACE,OAAOuI,IAiD4BF,UAlBzC,WAA4D,IAAzCE,EAAwC,uDAAhCjC,GAAa+B,UAAWG,EAAQ,uCACzD,OAAQA,EAAO5F,MACb,IAAK,iBACH,OAAO4F,EAAOxI,KAChB,QACE,OAAOuI,IAauCvC,QATpD,WAAwD,IAAvCuC,EAAsC,uDAA9BjC,GAAaN,QAASwC,EAAQ,uCACrD,OAAQA,EAAO5F,MACb,IAAK,cACH,OAAO4F,EAAOxI,KAChB,QACE,OAAOuI,IAIgDH,OA3B7D,WAAsD,IAAtCG,EAAqC,uDAA7BjC,GAAa8B,OAAQI,EAAQ,uCACnD,OAAQA,EAAO5F,MACb,IAAK,aACH,OAAO4F,EAAOxI,KAChB,QACE,OAAOuI,IAsBwDlC,KA7CrE,WAAkD,IAApCkC,EAAmC,uDAA3BjC,GAAaD,KAAMmC,EAAQ,uCAC/C,OAAQA,EAAO5F,MACb,IAAK,WACH,OAAO4F,EAAOxI,KAChB,QACE,OAAOuI,IAwC8DJ,MApC3E,WAAoD,IAArCI,EAAoC,uDAA5BjC,GAAa6B,MAAOK,EAAQ,uCACjD,OAAQA,EAAO5F,MACb,IAAK,YACH,OAAO4F,EAAOxI,KAChB,QACE,OAAOuI,IA+BqEjF,MA/DlF,WAAoD,IAArCiF,EAAoC,uDAA5BjC,GAAahD,MAAOkF,EAAQ,uCACjD,OAAQA,EAAO5F,MACb,IAAK,YACH,OAAO4F,EAAOxI,KAChB,QACE,OAAOuI,MEDEnF,GAJHqF,YACRC,GACAC,YAAgBC,M,sCCcLC,OAxBf,SAAsBC,GAAQ,IACpBC,EAAsBD,EAAtBC,KAAMjC,EAAgBgC,EAAhBhC,QAASkC,EAAOF,EAAPE,GAEjBC,EAAaC,IAAMC,SACvB,kBAAMD,IAAME,YAAW,SAACC,EAAWC,GAAZ,OAAoB,eAAC,IAAD,aAAYN,GAAIA,EAAIM,IAAKA,GAASD,SAC7E,CAACL,IAGH,OACE,8BACE,gBAACO,GAAA,EAAD,CAAUC,QAAM,EAACC,UAAWR,EAA5B,UACGF,EAAO,eAACW,GAAA,EAAD,UAAeX,IAAuB,KAC9C,eAACY,GAAA,EAAD,CAAc7C,QAASA,U,8YCThB,SAAS8C,GAASd,GAAQ,IAC/Be,EAAqEf,EAArEe,aAAcC,EAAuDhB,EAAvDgB,KAAMC,EAAiDjB,EAAjDiB,QAASC,EAAwClB,EAAxCkB,MAAOC,EAAiCnB,EAAjCmB,SAAUC,EAAuBpB,EAAvBoB,SAAUC,EAAarB,EAAbqB,SAC1DC,EAAUtB,EAAMsB,SAAWzK,GAAWmJ,EAAMsB,SAAWtB,EAAMsB,QAAU,GACvEC,EAASvB,EAAMuB,OAASvB,EAAMuB,OAAS,KAHP,EAITnB,IAAMoB,SAAST,GAJN,mBAI/B7J,EAJ+B,KAIzBuK,EAJyB,KAKhCC,EAAU,SAAC/J,GAAD,OAAY8J,EAAahK,GAAaP,EAAMS,KALtB,EAMJyI,IAAMoB,UAAS,GANX,mBAM/BG,EAN+B,KAMpBC,EANoB,OAOZxB,IAAMoB,SAAS,MAPH,mBAO/BK,EAP+B,KAOxBC,EAPwB,OAQF1B,IAAMoB,SAAS,MARb,mBAQ/BO,EAR+B,KAQnBC,EARmB,OASI5B,IAAMoB,SAAS,IATnB,mBAS/BS,EAT+B,KAShBC,EATgB,KAetC,OAAO,gBAACC,GAAA,EAAD,CAAQC,WAAS,EAACpB,KAAMA,EAAMC,QAASA,EAAvC,UACL,eAACoB,GAAA,EAAD,UAAcnB,IACd,gBAACoB,GAAA,EAAD,WACE,eAACC,EAAA,EAAD,CAAMC,MAAO,CAAEC,MAAO,QAAtB,SACGxK,OAAOuB,KAAKtC,GAAMwL,KAAI,SAACC,EAAGnL,GACzB,GAAI8J,EAAQsB,QAAQD,IAAM,EAAG,OAAO,KAGpC,IAAME,EAAOzB,GAAYC,GAAY/G,GAAMC,WAAWC,MAAM6G,GAAUD,GAAUyB,KAAKF,GACnFrI,GAAMC,WAAWC,MAAM6G,GAAUD,GAAUyB,KAAKF,GAAK,KAEvD,GAAIvB,GAAYC,GAAYwB,IAASA,EAAKC,SAAU,OAAO,KAC3D,IAAMC,EAAW5B,GAAYA,EAASwB,IAAYA,EAE9CK,EAAQ9L,EAAKyL,GAIjB,IAHMK,GAA4B,kBAAXA,GAAwB5B,GAAYC,GAAYwB,IACrEG,EAAK,UAAMH,EAAK/I,KAAX,YAAmB+I,EAAKG,MAAQH,EAAKG,MAAQ,KAE7B,kBAAXA,EACV,OAAO,eAACvC,GAAA,EAAD,CAAkBC,QAAM,EAACuC,QAAS,WACvCnB,EAASkB,GACThB,EAAce,GACdnB,GAAa,IAHR,SAIHmB,GAJkBvL,GAMtB,IAAI0L,EAAa,KACjB,GAAuB,kBAAXF,GAAuBA,EAAMG,WAAW,aAElDD,EAAaF,EAAM7J,MAAM,YAAY7B,aAChC,GAAuB,kBAAX0L,GAAuBA,EAAMG,WAAW,aAGvDD,EADY,cAAVF,EACW,eAACI,GAAA,EAAD,CAAQH,QAAS,WAC5BvB,EAAQ,eAAGiB,EAAJ,oBAAoB,IAAInK,MAAOU,kBAD3B,sCAIA,gBAACmK,GAAA,EAAD,WACX,eAACC,GAAA,EAAD,CACEN,MAAOA,EAAM7J,MAAM,YAAY7B,QAC/BiM,SAAU,SAAAtE,GACRpD,QAAQC,IAAI,IAAKmD,GAEjBpD,QAAQC,IAAR,mBAAwB0H,IAAOvE,GAAGwE,OAAO,sCACzC/B,EAAQ,eAAGiB,EAAJ,mBAAoBa,IAAOvE,GAAGwE,OAAO,0CAGhD,eAACC,EAAA,EAAD,CAAYT,QAAS,WACnBvB,EAAQ,eAAGiB,EAAI,QADjB,SAGE,eAAC,KAAD,cAID,GAAuB,kBAAXK,GAAuBA,EAAMG,WAAW,cAAe,CACxE,IAAMQ,EAAMX,EAAM7J,MAAM,aAAa7B,QAC/BiC,EAAO0I,EAAcU,GAAKV,EAAcU,GAAK1K,OAAOuB,KAAKJ,IAAgBnB,OAAOuB,KAAKJ,IAAgB9B,OAAS,GAC9GsM,EAAc,aAMpBV,EAAa,gBAACG,GAAA,EAAD,WACX,eAACQ,GAAA,EAAD,CAAWb,MAAK,UAAKc,WAAWH,GAAOvK,GAAeG,IAASgK,SAAU,SAAAtE,GACvE,IAAI0E,EAAM1E,EAAE8E,OAAOf,MACnB,GAAIgB,MAAMF,WAAWH,IACnB,IAAIA,EAAIrM,OAAS,EAAG,OACfqM,EAAM,EACb,IAAMM,EAAQ,oBAAgBH,WAAWH,GAAOvK,GAAeG,IAC/DmI,EAAQ,eAAGiB,EAAIsB,KACdC,OAAQN,IACX,eAACO,GAAA,EAAD,CAAQnB,MAAOzJ,EACbgK,SAAU,SAAAtE,GACRiD,EAAiBzK,GAAawK,EAAD,eAAmBU,EAAI1D,EAAE8E,OAAOf,UAC5DkB,OAAQN,EAHb,SAIG3L,OAAOuB,KAAKJ,IAAgBsJ,KAAI,SAACnH,EAAK/D,GAAN,OAAY,eAAC4M,GAAA,EAAD,CAAkBpB,MAAOzH,EAAzB,SAC1CA,GADyD/D,gBAMhE0L,EAAa,eAACW,GAAA,EAAD,CAAWb,MAAK,UAAKA,GAASO,SAAU,SAAAtE,GACnD,IAAMgF,EAAqC,IAA1BhF,EAAE8E,OAAOf,MAAM1L,OAAe,EAAwB,kBAAX0L,EAAsBc,WAAW7E,EAAE8E,OAAOf,OAAlD,UAA8D/D,EAAE8E,OAAOf,OACvHgB,MAAMC,IACVvC,EAAQ,eAAGiB,EAAIsB,OAGnB,OAAO,gBAACxD,GAAA,EAAD,WACL,eAACI,GAAA,EAAD,UAAekC,IACf,eAACsB,GAAA,EAAD,UACGnB,MAHiB1L,QAU1BqK,GAASE,EAAc,eAACjB,GAAD,CAAUC,aAAcc,EAAOb,KAAMW,EAAWV,QAAS,WAAQW,GAAa,IAAWV,MAAOa,SAA0B5K,KAEpJoK,EAAS,gBAAC+C,GAAA,EAAD,WACR,eAAClB,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAxGT,WACjB1B,GAAUA,EAAOrK,IAuGf,0BACA,eAACkM,GAAA,EAAD,CAAQH,QAAShC,EAAjB,6BACiB,eAACqD,GAAA,EAAD,UAAe,eAACjB,GAAA,EAAD,CAAKb,MAAO,CAAEC,MAAO,OAAQ+B,OAAQ,OAAQC,QAAS,OAAQC,eAAgB,UAA9E,SAA0F,eAACC,EAAA,EAAD,CAAYnC,MAAO,CAAEgC,OAAQ,QAAUI,QAAQ,QAAQL,MAAM,YAA7D,6CC1HjH,SAASM,GAAS7E,GAAQ,IAC/B9I,EAAyC8I,EAAzC9I,KAAM8J,EAAmChB,EAAnCgB,KAAMC,EAA6BjB,EAA7BiB,QAASC,EAAoBlB,EAApBkB,MAAOC,EAAanB,EAAbmB,SADE,EAEJf,IAAMoB,UAAS,GAFX,mBAE/BG,EAF+B,KAEpBC,EAFoB,OAGZxB,IAAMoB,SAAS,MAHH,mBAG/BK,EAH+B,KAGxBC,EAHwB,OAIF1B,IAAMoB,SAAS,MAJb,mBAI/BO,EAJ+B,KAInBC,EAJmB,KAQtC,OAAO,gBAACG,GAAA,EAAD,CAAQC,WAAS,EAACpB,KAAMA,EAAMC,QAASA,EAAvC,UACL,eAACoB,GAAA,EAAD,UAAcnB,IACd,gBAACoB,GAAA,EAAD,WACE,eAACC,EAAA,EAAD,CAAMC,MAAO,CAAEC,MAAO,QAAtB,SACGxK,OAAOuB,KAAKtC,GAAMwL,KAAI,SAACC,EAAGnL,GACzB,IAAMuL,EAAW5B,GAAYA,EAASwB,IAAYA,EAClD,GAAKzL,EAAKyL,GAAV,CACA,GAAyB,kBAAbzL,EAAKyL,GACf,OAAO,eAAClC,GAAA,EAAD,CAAkBC,QAAM,EAACuC,QAAS,WACvCnB,EAAS5K,EAAKyL,IACdX,EAAce,GACdnB,GAAa,IAHR,SAIHmB,GAJkBvL,GAMtB,IAAM2H,EAAC,UAAMjI,EAAKyL,IAClB,OAAO,gBAAClC,GAAA,EAAD,WACL,eAACI,GAAA,EAAD,UAAekC,IACf,eAACsB,GAAA,EAAD,UACE,eAACM,EAAA,EAAD,CAAYC,QAAQ,QAApB,SAA6BzF,EAAEhG,MAAM,EAAG,KAAOgG,EAAE7H,OAAS,GAAK,MAAQ,UAHrDE,SAU1BqK,GAASE,EAAc,eAAC8C,GAAD,CAAU3N,KAAM2K,EAAOb,KAAMW,EAAWV,QAAS,WAAQW,GAAa,IAAWV,MAAOa,SAA0B5K,QC1BjJ,IAAMgK,GAAW,CACf,QAAW,6BACX,aAAgB,4BAGX,SAAS2D,GAAiBC,GAAyB,IAAnBjL,EAAkB,uDAAX,UAC5C,IACE,OAAQjC,GAAmBkN,EAAK7N,KAAMoD,GAAMC,WAAWC,MAAMV,GAAMiL,EAAKjL,MAAM5C,MAC9E,MAAO+H,GACP,OAAO,GAIJ,SAAS+F,GAAiBC,GAC/B,OAAOxK,GAAIgB,QAAQ,SAAU,OAAOyJ,MAAK,SAAAvI,GAEvCrC,GAAMT,SAASO,GAAY,UAAWuC,EAAKzF,KAAKiO,UAChDF,GAAYA,EAAStI,EAAKzF,KAAKiO,YAI5B,SAAeC,GAAtB,mC,8CAAO,WAA0B1F,GAA1B,iBAAA5H,EAAA,yDACCuN,EAAa3F,EAAO4F,YACtBpC,EAAa,KACZ5I,GAAMC,WAAWC,MAAM2K,SAAY7K,GAAMC,WAAWC,MAAM2K,QAAQE,GAHlE,gCAIGL,IAAiB,SAACO,GAAoBrC,EAAaqC,EAAcF,MAJpE,6BAKEnC,EAAa5I,GAAMC,WAAWC,MAAM2K,QAAQE,GAL9C,gCAME5N,GAAayL,EAAY,CAAEhM,KAAMwI,KANnC,4C,sBAUP,SAASrG,GAAmBC,GAC1B,GAA2B,kBAAfA,EAAyB,MAAO,GAK5C,IAJA,IAAMF,EAAiB,CACrB,SAAK,EAAG,SAAK,GAAI,SAAK,KACtB,SAAK,MAAc,SAAK,QAEjB/B,EAAI,EAAGA,EAAIY,OAAOuB,KAAKJ,GAAgB9B,OAAQD,IACtD,GAAIiC,EAAYF,EAAenB,OAAOuB,KAAKJ,GAAgB/B,IACzD,MAAM,GAAN,QAAWiC,EAAYF,EAAenB,OAAOuB,KAAKJ,GAAgB/B,EAAI,KAAKqC,QAAQ,IAAnF,OAAwFzB,OAAOuB,KAAKJ,GAAgB/B,EAAI,IAG5H,MAAM,GAAN,QAAWiC,EAAYF,EAAenB,OAAOuB,KAAKJ,GAAgBnB,OAAOuB,KAAKJ,GAAgB9B,OAAS,KAAKoC,QAAQ,IAApH,OAAyHzB,OAAOuB,KAAKJ,GAAgBnB,OAAOuB,KAAKJ,GAAgB9B,OAAS,IAG5L,SAASkO,GAActO,EAAMmK,EAAUD,GACrC,IAAI9D,EAAM,GACV,GAAsB,kBAAVpG,EAAZ,CACA,IAAK,IAAMqE,KAAOrE,EAAM,CACtB,IAAM6L,EAAW5B,IAAYA,GAAS5F,IAAgBA,EAChDsH,EAAOzB,GAAYC,GAAY/G,GAAMC,WAAWC,MAAM6G,GAAUD,GAAUyB,KAAKtH,GACnFjB,GAAMC,WAAWC,MAAM6G,GAAUD,GAAUyB,KAAKtH,GAAO,KACzD,IAAIsH,GAASA,EAAKC,SAAlB,CACA,IAAIE,EAAQ9L,EAAKqE,IACZyH,GAA4B,kBAAXA,KACC,kBAAXA,IACNA,EAAMG,WAAW,aACnBH,EAAQQ,IAAOR,EAAM7J,MAAM,YAAY7B,SAASmO,WACvCzC,EAAMG,WAAW,gBAC1BH,EAAQ3J,GAAmByK,WAAWd,EAAM7J,MAAM,aAAa7B,YAGnEgG,EAAG,UAAsB,IAAfA,EAAIhG,OAAe,GAAMgG,EAAM,KAAtC,OAA8CyF,EAA9C,YAA0DC,KAE/D,OAAO1F,GAGF,SAASoI,GAAU1F,GAAQ,IAC1BN,EAA4DM,EAA5DN,OAAQiG,EAAoD3F,EAApD2F,WAAY1C,EAAwCjD,EAAxCiD,QAAS1B,EAA+BvB,EAA/BuB,OAAQa,EAAuBpC,EAAvBoC,UAAWwD,EAAY5F,EAAZ4F,QADvB,EAEKxF,IAAMoB,UAAS,GAFpB,mBAExBqE,EAFwB,KAEZC,EAFY,OAIK1F,IAAMoB,SAAU,WAClD,GAAgC,iBAA5B9B,EAAOxI,KAAKoO,aAAkCM,GAAWA,EAAQG,SAAU,CAC7E,IAAIC,EAAM/O,GAASyI,GAGnB,OAFAsG,EAAI9O,KAAK+O,QAAUL,EAAQG,SAASG,OACpCF,EAAI9O,KAAKiP,aAAeP,EAAQG,SAASK,MAClCJ,EACF,OAAOtG,EANoC,IAJrB,mBAIxB2G,EAJwB,aAYLjG,IAAMoB,UAAS,IAZV,mBAYxB8E,EAZwB,KAYjBC,EAZiB,KAc/B,GADAtD,EAAUA,GAAoB,cACzBvD,EAAQ,OAAO,KACpB,IAAM8G,EAAoB,WAAQV,GAAc,IAC1CW,EAAc,SAAAC,GAClB,IAAIC,EAAW1P,GAASyP,GAAwBL,GAChDxK,QAAQC,IAAI,mBAAoB6K,GAChC1D,EAAQ0D,EAAUhB,IAEpB,OAAO,gBAACiB,GAAA,EAAD,CAAMpE,MAAO,CAAEqE,SAAU,IAAKC,OAAQ,GAAIrE,MAAQL,EAAY,OAAS,QAAvE,UACL,gBAAC2E,GAAA,EAAD,CAAa9D,QAAS0C,EAAa,aAAY,WAAQc,KAAvD,UACE,eAAC9B,EAAA,EAAD,CAAYC,QAAQ,KAApB,SAA0BlF,EAAOsH,OAChClC,GAAiBpF,EAAQ,WACxB8F,GAAc9F,EAAOxI,KAAM,UAAWwI,EAAO5F,MAC7C,eAAC6K,EAAA,EAAD,CAAYC,QAAQ,QAApB,SAA6BlF,EAAOuH,OAEtC,eAACnG,GAAD,CAEEK,SAAUA,GACVH,KAAM6E,EACNzE,SAAU1B,EAAO5F,KACjBuH,SAAS,UACTJ,QAASuF,EAETzF,aAAcsF,EAAWnP,KACzBqK,OAAQ,SAAA2F,GACN,IAAIR,EAAYzP,GAASyI,GACzBgH,EAAUxP,KAAOgQ,EACjBrL,QAAQC,IAAI,UAAWoL,GACvB3F,GAAUA,EAAOmF,GACjBF,IACIF,GAAOG,EAAYC,SAG5Bf,EAAa,gBAACwB,GAAA,EAAD,WACZ,eAAC/D,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAAS0C,EAAa,WAAQc,KAAmB,aAAzE,0BACA,eAACrD,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAAS,WAAQ6C,GAAc,GAAOS,GAAS,IAAvE,2DACe,eAACY,GAAA,EAAD,UACf,eAAC/D,GAAA,EAAD,CAAQmB,MAAOO,GAAiBpF,EAAQ,WAAa,UAAY,YAAauD,QAAS,WAAQ6C,GAAc,IAA7G,2CAKS,SAASsB,GAAQpH,GAAQ,IAChC2F,EAAiC3F,EAAjC2F,WAAY1C,EAAqBjD,EAArBiD,QAAS2C,EAAY5F,EAAZ4F,QAC3B3C,EAAUA,GAAoB,aAFO,MAGD7C,IAAMoB,UAAS,GAHd,mBAG9B6F,EAH8B,KAGlBC,EAHkB,OAINlH,IAAMmH,YAAW,SAAAC,GAAC,OAAIA,EAAI,IAAG,GAJvB,mBAIrBC,GAJqB,WAK/BtC,EAAU7K,GAAMC,WAAWC,MAAM2K,QAClCA,GAAYkC,IACfC,GAAc,GACdtC,KAAmBE,MAAK,WAAQuC,QAGlC,IAAIC,EAAU,KAQd,OAJEA,EAHGvC,EAGO,eAAC9B,GAAA,EAAD,CAAKb,MAAO,CAAEiC,QAAS,OAAQkD,cAAe,MAAOC,SAAU,QAA/D,SACP3P,OAAOuB,KAAK2L,GAASzC,KAAI,SAAC4C,EAAa9N,GAAd,OAAoB,eAACkO,GAAD,CAAWE,QAASA,EAAS3C,QAASA,EAAiB0C,WAAYA,EAAYjG,OAAQyF,EAAQG,IAA3C9N,QAH1F,eAACmN,EAAA,EAAD,CAAYC,QAAQ,QAApB,2DAML,eAACvB,GAAA,EAAD,UACJqE,IC9IL,IAAMvG,GAAW,CACf,WAAc,2BACd,SAAY,2BACZ,SAAY,eACZ,SAAY,4BAGP,SAAS0G,GAAkB5C,GAChC,OAAOxK,GAAIgB,QAAQ,UAAW,OAAOyJ,MAAK,SAAAvI,GAExCrC,GAAMT,SAASO,GAAY,WAAYuC,EAAKzF,KAAK4Q,WACjD7C,GAAYA,EAAStI,EAAKzF,KAAK4Q,aAI5B,SAASC,GAAkBhD,GAA0B,IAApBjL,EAAmB,uDAAZ,WAC7C,IACE,OAAQjC,GAAmBkN,EAAK7N,KAAMoD,GAAMC,WAAWC,MAAMV,GAAMiL,EAAKjL,MAAM5C,MAC9E,MAAO+H,GACP,OAAO,GAIJ,SAAS+I,GAAeC,GAC7B,OAAIA,EAAQC,SAAiB,WACzBD,EAAQE,SAAiB,OACtB,OAGF,SAAeC,GAAtB,mC,8CAAO,WAA2BH,GAA3B,iBAAAnQ,EAAA,yDACCuQ,EAAcL,GAAeC,GAC/BK,EAAc,KACbhO,GAAMC,WAAWC,MAAMsN,UAAaxN,GAAMC,WAAWC,MAAMsN,SAASO,GAHpE,gCAIGR,IAAkB,SAACU,GAAqBD,EAAcC,EAAeF,MAJxE,6BAKEC,EAAchO,GAAMC,WAAWC,MAAMsN,SAASO,GALhD,gCAME5Q,GAAa6Q,EAAa,CAAEpR,KAAM+Q,KANpC,4C,sBASP,SAASzC,GAActO,EAAMmK,EAAUD,GACrC,IAAI9D,EAAM,GACV,GAAsB,kBAAVpG,EAAZ,CACA,IAAK,IAAMqE,KAAOrE,EAAM,CACtB,IAAM6L,EAAW5B,IAAYA,GAAS5F,IAAgBA,EAChDsH,EAAOzB,GAAYC,GAAY/G,GAAMC,WAAWC,MAAM6G,GAAUD,GAAUyB,KAAKtH,GACnFjB,GAAMC,WAAWC,MAAM6G,GAAUD,GAAUyB,KAAKtH,GAAO,KACzD,IAAIsH,GAASA,EAAKC,SAAlB,CACA,IAAIE,EAAQ9L,EAAKqE,GACZyH,IACDA,EAAMG,WAAW,aACnBH,EAAQQ,IAAOR,EAAM7J,MAAM,YAAY7B,SAASmO,WACvCzC,EAAMG,WAAW,gBAC1BH,EAAQ3J,GAAmByK,WAAWd,EAAM7J,MAAM,aAAa7B,WAEjEgG,EAAG,UAAsB,IAAfA,EAAIhG,OAAe,GAAMgG,EAAM,KAAtC,OAA8CyF,EAA9C,YAA0DC,KAE/D,OAAO1F,GAGF,SAASkL,GAAWxI,GAAQ,IAC3BiI,EAAoDjI,EAApDiI,QAAStC,EAA2C3F,EAA3C2F,WAAY1C,EAA+BjD,EAA/BiD,QAAS1B,EAAsBvB,EAAtBuB,OAAQa,EAAcpC,EAAdoC,UADZ,EAEIhC,IAAMoB,UAAS,GAFnB,mBAEzBqE,EAFyB,KAEbC,EAFa,OAGN1F,IAAMoB,UAAS,GAHT,mBAGzB8E,EAHyB,KAGlBC,EAHkB,KAKhC,GADAtD,EAAUA,GAAoB,cACzBgF,EAAS,OAAO,KACrB,IAAMzB,EAAoB,WAAQV,GAAc,IAC1CW,EAAc,SAAAgC,GAClBxF,EAAQwF,GAA0BR,EAAStC,IAE7C,OAAO,gBAACiB,GAAA,EAAD,CAAMpE,MAAO,CAAEqE,SAAU,IAAKC,OAAQ,GAAIrE,MAAQL,EAAY,OAAS,QAAvE,UACL,gBAAC2E,GAAA,EAAD,CAAa9D,QAAS0C,EAAa,aAAY,WAAQc,KAAvD,UACE,eAAC9B,EAAA,EAAD,CAAYC,QAAQ,KAApB,SAA0BqD,EAAQjB,OACjCe,GAAkBE,EAAS,YAC1BzC,GAAcyC,EAAQ/Q,KAAM,WAAY+Q,EAAQnO,MAChD,eAAC6K,EAAA,EAAD,CAAYC,QAAQ,QAApB,SAA6BqD,EAAQhB,OAEvC,eAACnG,GAAD,CACEQ,QAAS,CAAC,UAAW,YACrBH,SAAUA,GACVH,KAAM6E,EACNzE,SAAU6G,EAAQnO,KAClBuH,SAAS,WACTJ,QAASuF,EACTzF,aAAckH,EAAQ/Q,KACtBqK,OAAQ,SAAA2F,GACN,IAAIuB,EAAaxR,GAASgR,GAC1BQ,EAAWvR,KAAOgQ,EAClBrL,QAAQC,IAAIoL,GACZ3F,GAAUA,EAAOkH,GACjBjC,IACIF,GAAOG,EAAYgC,SAG5B9C,EAAa,gBAACwB,GAAA,EAAD,WACZ,eAAC/D,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAAS0C,EAAa,WAAQc,KAAmB,aAAzE,0BACA,eAACrD,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAAS,WAAQ6C,GAAc,GAAOS,GAAS,IAAvE,2DACe,eAACY,GAAA,EAAD,UACf,eAAC/D,GAAA,EAAD,CAAQmB,MAAOwD,GAAkBE,EAAS,YAAc,UAAY,YAAahF,QAAS,WAAQ6C,GAAc,IAAhH,2CAKS,SAAS4C,GAAS1I,GAAQ,IACjC2F,EAAwB3F,EAAxB2F,WAAY1C,EAAYjD,EAAZiD,QAClBA,EAAUA,GAAoB,aAFQ,MAGF7C,IAAMoB,UAAS,GAHb,mBAG/B6F,EAH+B,KAGnBC,EAHmB,OAIPlH,IAAMmH,YAAW,SAAAC,GAAC,OAAIA,EAAI,IAAG,GAJtB,mBAItBC,GAJsB,WAKhCK,EAAWxN,GAAMC,WAAWC,MAAMsN,SACnCA,GAAaT,IAChBC,GAAc,GACdO,KAAoB3C,MAAK,WAAQuC,QAGnC,IAAIC,EAAU,KAQd,OAJEA,EAHGI,EAGO,eAACzE,GAAA,EAAD,CAAKb,MAAO,CAAEiC,QAAS,OAAQkD,cAAe,MAAOC,SAAU,QAA/D,SACP3P,OAAOuB,KAAKsO,GAAUpF,KAAI,SAACiG,EAAcnR,GAAf,OAAqB,eAACgR,GAAD,CAAYvF,QAASA,EAAiB0C,WAAYA,EAAYsC,QAASH,EAASa,IAA7CnR,QAH3E,eAACmN,EAAA,EAAD,CAAYC,QAAQ,QAApB,uEAML,eAACvB,GAAA,EAAD,UACJqE,ICvHL,IAAIkB,IAAmB,EAEhB,SAASC,GAAoBlF,GAAOiF,GAAmBjF,EAE/C,SAASmF,GAAW9I,GAAQ,IACjC+I,EAAgE/I,EAAhE+I,QAAS/H,EAAuDhB,EAAvDgB,KAAMC,EAAiDjB,EAAjDiB,QAAS+H,EAAwChJ,EAAxCgJ,UAAWzH,EAA6BvB,EAA7BuB,OAAQ0H,EAAqBjJ,EAArBiJ,QAASrD,EAAY5F,EAAZ4F,QAEtDsD,EAAgBtD,GAAWA,EAAQuD,SAAYvD,EAAQuD,SAAW,iCAClEC,EAAkB,CACtBC,UAAWH,EACXpB,SAAU,GACV3C,QAAS,IAELmE,EAAcP,EAAW/I,EAAMsJ,YAActJ,EAAMsJ,YAAcF,EAAmBH,IAAqBjJ,EAAMsJ,YAActJ,EAAMsJ,YAAcF,GAT/G,EAUThJ,IAAMoB,SAAS,CAC5C+H,mBAAmB,EACnBC,sBAAsB,EACtBC,qBAAqB,EACrBC,qBAAqB,EACrBC,KAAML,EACNM,oBAAoB,EACpBC,WAAY,OAjB0B,mBAUjCpK,EAViC,KAU1BqK,EAV0B,KAqBlCC,EAAW,SAACpS,GAAD,OAAYmS,EAAcrS,GAAagI,EAAO9H,KArBvB,EAsBTyI,IAAMmH,YAAW,SAAAC,GAAC,OAAIA,EAAI,IAAG,GAtBpB,mBAsBxBC,GAtBwB,WAuBlCuC,EAAW1P,GAAMC,WAAWC,MAAMyP,YAGnClB,IAAYH,IAAqB/Q,GAAmB4H,EAAMkK,KAAMP,KAAqBvR,GAAmByR,EAAaF,KAG/GR,MAFTA,IAAmB,EACnBmB,EAAS,CAAEJ,KAAML,KAMd7J,EAAMmK,oBAAuBI,IAChCD,EAAS,CAAEH,oBAAoB,IAC/BnP,GAAIgB,QAAQ,OAAQ,SAASyJ,MAAK,SAAAvI,GAEhC,IAAIqN,EAAWrN,EAAKzF,KAAK+S,UACzBD,EAASE,IAAM,KACf5P,GAAMT,SAASO,GAAY,YAAa4P,IACxCvC,QAIJ,IAAM0C,EAAgBpB,EAAU,WAE9B,IAAKiB,EAGH,OAFA9P,GAAa,2CACb2B,QAAQiB,MAAM,sCAIhB,IAAM6M,EAAOlS,GAAauS,EAAUvK,EAAMkK,MAE1C,OADA9N,QAAQC,IAAI,OAAQ6N,GACblP,GAAIgB,QAAQ,OAAQ,OAAQ,CAAEkO,SAAQzE,MAAK,SAAAvI,GAEhD,GAAkB,MAAdA,EAAKI,KAAT,CACA,IAAM8M,EAAalN,EAAKzF,KAAKgT,IAAOvN,EAAKzF,KAAKgT,IAAM,EAAK,KACzDH,EAAS,CACPF,aACAV,SAAU7O,GAAMC,WAAWC,MAAMyP,UAAvB,UAAsCf,GAAtC,OAAqDW,GAA0B,IAAOX,IAElGF,GAAaA,SAEb,WACF,GAAKC,EAAL,CACA,IAAMU,EAAOlS,GAAawR,EAASxJ,EAAMkK,MAEzC,OADA9N,QAAQC,IAAI,OAAQ6N,GAChBpI,EACKA,EAAOoI,GACJ,IAAIjT,SAAQ,SAAC0T,EAASC,GAAaD,SAGjD,OAAO,gBAACjI,GAAA,EAAD,CAAQC,WAAS,EAACpB,KAAMA,EAAMC,QAAS,WAAQA,GAAWA,KAA1D,UACL,eAACoB,GAAA,EAAD,UAAc0G,EAAU,iCAAU,6BAClC,gBAACzG,GAAA,EAAD,WACE,gBAACC,EAAA,EAAD,WACE,eAAC+H,GAAA,EAAD,uCACA,eAAC7J,GAAA,EAAD,UACE,eAACoD,GAAA,EAAD,CAAWb,MAAOvD,EAAMkK,KAAKN,UAAW9F,SAAU,SAAAtE,GAChD,IAAIsL,EAAUtT,GAASwI,EAAMkK,MAC7BY,EAAQlB,UAAYpK,EAAE8E,OAAOf,MAC7B+G,EAAS,CAAEJ,KAAMY,SAGrB,eAACD,GAAA,EAAD,6CACC7K,EAAMkK,KAAK7B,SAASpF,KAAI,SAACuF,EAASzQ,GAAV,OAAgB,gBAACiJ,GAAA,EAAD,WACvC,eAAC+H,GAAD,CAAYpG,WAAS,EAAC6F,QAASA,EAAS1G,OAAQ,SAAArK,GAC9C2E,QAAQC,IAAI,UAAW5E,GACvB,IAAIqT,EAAUtT,GAASwI,EAAMkK,MAC7BY,EAAQzC,SAAStQ,GAAKN,EACtB6S,EAAS,CAAEJ,KAAMY,OAEnB,eAAClG,GAAA,EAAD,UACE,eAACX,EAAA,EAAD,CAAYT,QAAS,WACnB,IAAIsH,EAAUtT,GAASwI,EAAMkK,MAC7BY,EAAQzC,SAAS0C,OAAOhT,EAAG,GAC3BuS,EAAS,CAAEJ,KAAMY,KAHnB,SAKE,eAAC,KAAD,UAbkD/S,MAiBxD,eAAC8S,GAAA,EAAD,kCACC7K,EAAMkK,KAAKxE,QAAQzC,KAAI,SAAChD,EAAQlI,GAAT,OAAe,gBAACiJ,GAAA,EAAD,WACrC,eAACiF,GAAD,CAAWtD,WAAS,EAAC1C,OAAQA,EAAQ6B,OAAQ,SAAArK,GAC3C2E,QAAQC,IAAI,UAAW5E,GACvB,IAAIqT,EAAUtT,GAASwI,EAAMkK,MAC7BY,EAAQpF,QAAQ3N,GAAKN,EACrB6S,EAAS,CAAEJ,KAAMY,OAEnB,eAAClG,GAAA,EAAD,UACE,eAACX,EAAA,EAAD,CAAYT,QAAS,WACnB,IAAIsH,EAAUtT,GAASwI,EAAMkK,MAC7BY,EAAQpF,QAAQqF,OAAOhT,EAAG,GAC1BuS,EAAS,CAAEJ,KAAMY,KAHnB,SAKE,eAAC,KAAD,UAbgD/S,MAiBtD,eAACiJ,GAAA,EAAD,UACE,gBAACgK,GAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACE,eAACF,GAAA,EAAD,CAAM1F,MAAI,EAAC6F,GAAI,GAAIC,GAAI,EAAvB,SACE,eAACzH,GAAA,EAAD,CAAQhB,WAAS,EAACa,QAAS,WAAQ8G,EAAS,CAAEP,sBAAsB,KAAWjF,MAAM,UAAUK,QAAQ,WAAvG,8CAEF,eAAC6F,GAAA,EAAD,CAAM1F,MAAI,EAAC6F,GAAI,GAAIC,GAAI,EAAvB,SACE,eAACzH,GAAA,EAAD,CAAQhB,WAAS,EAACa,QAAS,WAAQ8G,EAAS,CAAEN,qBAAqB,KAAWlF,MAAM,UAAUK,QAAQ,WAAtG,0CAKR,gBAACzC,GAAA,EAAD,CAAQnB,KAAMvB,EAAM+J,qBAAsBvI,QAAS,kBAAM8I,EAAS,CAAEP,sBAAsB,KAA1F,UACE,eAACnH,GAAA,EAAD,yDACA,eAACC,GAAA,EAAD,UACE,eAACoG,GAAD,CAAU9C,QAASA,EAAS3C,QAAS,SAAAgF,GACnCpM,QAAQC,IAAI,UAAWmM,GACvB,IAAIsC,EAAUtT,GAASwI,EAAMkK,MAC7BY,EAAQzC,SAASvQ,KAAK0Q,GACtB8B,EAAS,CAAEP,sBAAsB,EAAOG,KAAMY,KAC7C5E,YAAU,SAGjB,gBAACxD,GAAA,EAAD,CAAQnB,KAAMvB,EAAMgK,oBAAqBxI,QAAS,kBAAM8I,EAAS,CAAEN,qBAAqB,KAAxF,UACE,eAACpH,GAAA,EAAD,6CACA,eAACC,GAAA,EAAD,UACE,eAAC8E,GAAD,CAASxB,QAASA,EAAS3C,QAAS,SAAAvD,GAClC7D,QAAQC,IAAI,SAAU4D,GACtB,IAAI6K,EAAUtT,GAASwI,EAAMkK,MAC7BY,EAAQpF,QAAQ5N,KAAKmI,GACrBqK,EAAS,CAAEN,qBAAqB,EAAOE,KAAMY,KAC5C5E,YAAU,YAInB,gBAACrB,GAAA,EAAD,WACE,eAAClB,GAAA,EAAD,CAAQmB,MAAM,UAAUuG,SAAyC,IAA/BrL,EAAMkK,KAAK7B,SAASxQ,QAA8C,IAA9BmI,EAAMkK,KAAKxE,QAAQ7N,OAAc2L,QAAO,sBAAE,sBAAAnL,EAAA,sDAE9GqS,IAAgBjF,MAAK,WACnB6E,EAAS,CAAEJ,KAAML,IACjBrI,GAAWA,OAJiG,2CAAhH,0BAOA,eAACmC,GAAA,EAAD,CAAQH,QAAS,WAAQhC,GAAWA,KAApC,gC,SCtKS8J,G,iFAAf,WAAwBpB,GAAxB,qBAAA7R,EAAA,yDACQkS,EAAW1P,GAAMC,WAAWC,MAAMyP,UAD1C,iDAGMe,EAAcvT,GAAauS,EAAUL,GAEhCtS,EAAI,EALf,YAKkBA,EAAI2T,EAAYlD,SAASxQ,QAL3C,iCAMoC8Q,GAAY4C,EAAYlD,SAASzQ,IANrE,OAMI2T,EAAYlD,SAASzQ,GANzB,cAKmDA,IALnD,uBAQWA,EAAI,EARf,aAQkBA,EAAI2T,EAAY7F,QAAQ7N,QAR1C,kCASmC8N,GAAW4F,EAAY7F,QAAQ9N,IATlE,QASI2T,EAAY7F,QAAQ9N,GATxB,eAQkDA,IARlD,4BAUM2T,EAAYlD,SAAShN,SAAS,QAASkQ,EAAY7F,QAAQrK,SAAS,MAV1E,0CAUwF,MAVxF,iCAWSkQ,GAXT,6C,sBAeA,SAASC,GAAQjL,GAAQ,IACf2J,EAA4B3J,EAA5B2J,KAAMuB,EAAsBlL,EAAtBkL,SAAUjI,EAAYjD,EAAZiD,QAExB,OAAO,gBAACxC,GAAA,EAAD,CAAUC,QAAM,EAACuC,QAAO,sBAAE,4BAAAnL,EAAA,6DAC/B+D,QAAQC,IAAI,cAAe6N,GADI,SAELoB,GAASpB,GAFJ,OAEzBqB,EAFyB,OAG/BnP,QAAQC,IAAI,aAAckP,GAC1B/H,GAAWA,EAAQ+H,GAJY,2CAA1B,UAML,gBAACnK,GAAA,EAAD,WACE,eAACwC,GAAA,EAAD,UACE,eAACsB,EAAA,EAAD,CAAYC,QAAQ,KAApB,SAA0B+E,EAAKN,cAEjC,eAAChG,GAAA,EAAD,UACE,eAACsB,EAAA,EAAD,CAAYC,QAAQ,QAApB,uBAAoC+E,EAAKO,IAAzC,+BAAoDP,EAAK7B,SAASxQ,OAAlE,mBAAmFqS,EAAKxE,QAAQ7N,eAGpG,eAAC+M,GAAA,EAAD,UACE,eAACX,EAAA,EAAD,CAAYT,QAAS,WACnBxI,GAAI0Q,YAAY,OAAQxB,EAAKO,IAAK,UAAUhF,MAAK,SAAAvI,GAC7B,MAAdA,EAAKI,MAAczC,GAAMT,SAASK,GAAayC,IACnDuO,GAAYA,QAHhB,SAME,eAAC,KAAD,WAMD,SAASE,GAAexF,GAC7B,IAAMvG,EAAQ/E,GAAMC,WAAW8E,MAC/B,IAAKuG,IAAYA,EAAQG,UAAaH,EAAQG,UAAiD,OAArCzJ,KAAKC,UAAUqJ,EAAQG,UAAqB,OAAO1G,EAC7G,IAHsC,EAGlCgM,EAAS,GAHyB,eAInBhM,GAJmB,IAItC,2BAA0B,CAAC,IAAD,EAAfsK,EAAe,uBACHA,EAAKxE,SADF,IACxB,2BAAmC,CAAC,IAAzBzF,EAAwB,QAC3BqE,EAASrE,EAAOxI,KAAOwI,EAAOxI,KAAOwI,EAC3C,GAA2B,iBAAvBqE,EAAOuB,aACLM,EAAQG,UAAYhC,EAAOkC,UAAYL,EAAQG,SAASG,OAAQ,CAClEmF,EAAO9T,KAAKoS,GACZ,QANkB,gCAJY,8BAiBtC,OAFI0B,EAAO/T,OAAS,GAClBuE,QAAQC,IAAI,iBAAkBuP,EAAQzF,EAASvG,GAC1CgM,EAqCF,SAASC,GAAStL,GAAQ,IACvBiD,EAA0CjD,EAA1CiD,QAASiI,EAAiClL,EAAjCkL,SAAUtF,EAAuB5F,EAAvB4F,QAASxD,EAAcpC,EAAdoC,UAE9B/C,EAAQW,EAAMX,MAAQW,EAAMX,MAAQ/E,GAAMC,WAAW8E,MACrDkM,EAtCD,SAA6B3F,GA+BlC,OA9BIA,GAAS/J,QAAQC,IAAI8J,GACXtL,GAAMC,WAAW8E,MACXqD,KAAI,SAACiH,EAAMnS,GAAO,IAAD,iBACdmS,EAAKxE,SADS,IACnC,2BAAmC,CAAC,IAAzBzF,EAAwB,QAC3BqE,EAASrE,EAAOxI,KAAOwI,EAAOxI,KAAOwI,EAC3C,GAA2B,iBAAvBqE,EAAOuB,YAAgC,CACzC,GAAIM,GAAWA,EAAQG,UAAYhC,EAAOkC,UAAYL,EAAQG,SAASG,OAErE,OADArK,QAAQC,IAAI,QAAS6N,IACd,EACF,IAAK/D,EAAS,OAAO,IAPG,8BAUnC,OAAO,KAyBK4F,CAAoB5F,GAGlC,OAFIA,GAAWA,EAAQG,UAAiD,OAArCzJ,KAAKC,UAAUqJ,EAAQG,WAAoBlK,QAAQC,IAAI,QAAS8J,EAASvG,GACxGA,EAAM/H,OAAS,GAAGuE,QAAQC,IAAIuD,EAAOkM,GAClClM,EAAM/H,OAAS,EAAI,eAACiL,EAAA,EAAD,UACvBlD,EAAMqD,KAAI,SAACiH,EAAMnS,GAAP,OAAa+T,EAAM/T,GAAK,eAACyT,GAAD,CAAShI,QAASA,EAASiI,SAAUA,EAAkBvB,KAAMA,GAATnS,GAA4B,UAC3G,eAAC+K,EAAA,EAAD,CAAMC,MAAO,CAAEC,MAAOL,EAAY,OAAS,MAA3C,SACR,eAAC3B,GAAA,EAAD,UACE,eAACkE,EAAA,EAAD,CAAYC,QAAQ,QAAQL,MAAM,gBAAlC,oCAKS,SAASkH,GAAMzL,GAAQ,IAAD,EACJI,IAAMoB,SAAS,CAC5CkK,iBAAiB,EACjBnC,mBAAmB,EACnBR,SAAS,EACTY,KAAM,OAL2B,mBAC5BlK,EAD4B,KACrBqK,EADqB,KAO7BzK,EAAQ/E,GAAMC,WAAW8E,MAPI,EAQJe,IAAMmH,YAAW,SAAAC,GAAC,OAAIA,EAAI,IAAG,GARzB,mBAQnBC,GARmB,WAS7BsC,EAAW,SAACpS,GAAD,OAAYmS,EAAcrS,GAAagI,EAAO9H,KAc/D,OAZK8H,EAAMiM,kBACT3B,EAAS,CAAE2B,iBAAiB,IAC5BjR,GAAIgB,QAAQ,OAAQ,OAAOyJ,MAAK,SAAAvI,GACZ,MAAdA,EAAKI,MAITzC,GAAMT,SAASE,GAAS4C,EAAKzF,KAAKmI,QAClCoI,KAJEnN,GAAMT,SAASK,GAAayC,QAQ3B,gBAACgP,GAAA,EAAD,WACL,gBAAClB,GAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACE,gBAACF,GAAA,EAAD,CAAM1F,MAAI,EAAC8F,GAAI,EAAGe,GAAI,GAAtB,UACE,eAACjH,EAAA,EAAD,CAAYC,QAAQ,KAApB,sCAYA,eAAC0G,GAAD,CAAUrI,QAAS,SAAA0G,GACjB9N,QAAQC,IAAI,gBAAiB6N,GAC7Bd,IAAoB,GACpBkB,EAAS,CAAER,mBAAmB,EAAMR,SAAS,EAAOY,UACnDuB,SAAU,WAAQnB,EAAS,CAAE2B,iBAAiB,UAEnD,eAACjB,GAAA,EAAD,CAAM1F,MAAI,EAAC8F,GAAI,EAAGe,GAAI,GAAtB,SACE,eAACD,GAAA,EAAD,CAAWE,SAAS,KAApB,SACE,gBAACtJ,EAAA,EAAD,WACE,eAAC+H,GAAA,EAAD,iCACA,eAAC7J,GAAA,EAAD,UACE,eAAC2C,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAAYL,MAAM,YAAYtB,QAAS,WAC/D4F,IAAoB,GACpBkB,EAAS,CAAER,mBAAmB,EAAMR,SAAS,KAF/C,8CAKF,eAACtI,GAAA,EAAD,UACE,eAAC2C,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAA1B,oDAGF,eAAC0F,GAAA,EAAD,mDACA,eAAC7J,GAAA,EAAD,UACE,eAAC2C,GAAA,EAAD,CAAQhB,WAAS,EAAC0I,SAA2B,IAAjBzL,EAAM/H,OAAcsN,QAAQ,WAAW3B,QAAS,WAC1E,IAAI6I,EAAO,GACXzM,EAAMqD,KAAI,SAAAiH,GAAgE,OAAtDmC,EAAO7T,OAAO8T,OAAOD,EAAd7T,OAAA,IAAAA,CAAA,GAAuB0R,EAAKO,IAAMP,EAAKO,MAAe,QACjFzP,GAAIgB,QAAQ,OAAQ,SAAU,CAAEqQ,SAAQ5G,MAAK,SAAAvI,GAE3CoN,EAAS,CAAE2B,iBAAiB,QALhC,8DAaV,eAAC5C,GAAD,CAAYG,QAASxJ,EAAMkK,KACzBZ,QAAStJ,EAAMsJ,QACf/H,KAAMvB,EAAM8J,kBACZP,UAAW,WAAQe,EAAS,CAAE2B,iBAAiB,KAC/CzK,QAAS,WAAQ8I,EAAS,CAAER,mBAAmB,KAC/ChI,OAAQ,SAAAoI,GACN,OAAOlP,GAAI0Q,YAAY,OAAQxB,EAAKO,IAAK,OAAQ,CAAEP,SAAQzE,MAAK,SAAAvI,GAC9DoN,EAAS,CAAE2B,iBAAiB,aC/LtC,IAAMM,GAAYC,YAAW,CAC3BC,MAAO,CACLrF,SAAU,MAEZsF,SAAU,CACRC,SAAU,SACVC,WAAY,SACZC,gBAAiB,WACjBT,SAAU,KAEZU,WAAY,CACVH,SAAU,SACVC,WAAY,SACZC,gBAAiB,WACjBT,SAAU,OAId,SAASW,GAAYxM,GACnB,IAAIyM,EAAS,CAAEC,QAAS,GAGxB,OADI1M,EAAM2M,WAAUF,EAAOG,aAAe,KACnC,eAACC,GAAA,EAAD,CAAWC,MAAO9M,EAAM8M,MAAOC,QAAS/M,EAAM+M,QAASvK,MAAOiK,EAA9D,SAAuEzM,EAAM0H,UAQtF,IAAIsF,GAAmB,KAEnBC,GAAiB,KAqONC,OAnOf,SAAsBlN,GACpB,IAAMmN,EAAUnB,KADW,EAGqB5L,IAAMoB,UAAS,GAHpC,mBAGpB4L,EAHoB,KAGFC,EAHE,OAIqBjN,IAAMoB,UAAS,GAJpC,mBAIpB8L,EAJoB,KAIFC,EAJE,OAKInN,IAAMmH,YAAW,SAAAC,GAAC,OAAIA,EAAI,IAAG,GALjC,mBAKXC,GALW,WAMnB9O,EAAcqH,EAAdrH,IAAKzB,EAAS8I,EAAT9I,KACPsW,GAAO,IAAIhV,MAAOE,OAAOC,GAAKM,eAPT,EASGmH,IAAMoB,SAAStK,GATlB,mBASpBuW,EAToB,KASXC,EATW,OAUKtN,IAAMoB,SAAUlH,GAAMC,WAAW+E,QAC/DhF,GAAMC,WAAW+E,OAAOqO,eACxBrT,GAAMC,WAAW+E,OAAOqO,cAAcH,GAASlT,GAAMC,WAAW+E,OAAOqO,cAAcH,GAAMI,SAAW,IAZ7E,mBAUpBA,EAVoB,KAUVC,EAVU,OAauBzN,IAAMoB,UAAS,GAbtC,mBAapB+H,EAboB,KAaDuE,EAbC,OAc2B1N,IAAMoB,SAAS,MAd1C,mBAcpBuM,EAdoB,KAcCC,EAdD,OAeW5N,IAAMoB,SAAS,IAf1B,mBAepByM,EAfoB,KAePC,EAfO,KAiB3B,IAAK5T,GAAMC,WAAW+E,OAQpB,OAPK8N,IACHC,GAAoB,GACpB5S,GAAIgB,QAAQ,SAAU,OAAOyJ,MAAK,SAAAvI,GACd,MAAdA,EAAKI,MACTzC,GAAMT,SAASI,GAAU0C,EAAKzF,WAG3B,eAACiX,GAAA,EAAD,IAET,IAAK7T,GAAMC,WAAW+E,OAAOqO,cAQ3B,OAPKL,IACHC,GAAoB,GACpB9S,GAAIgB,QAAQ,SAAU,OAAQ,CAAE2S,YAAa,CAAEC,YAAY,KAAUnJ,MAAK,SAAAvI,GACtD,MAAdA,EAAKI,MACTzC,GAAMT,SAASI,GAAU0C,EAAKzF,WAG3B,eAACiX,GAAA,EAAD,IAGTnB,GAAmF,OAAhE1Q,KAAKC,UAAUjC,GAAMC,WAAW+E,OAAOqO,cAAcH,UAAmFrW,IAAhEmF,KAAKC,UAAUjC,GAAMC,WAAW+E,OAAOqO,cAAcH,IAIhJ,IAAMc,EAAkB,gBAACnM,GAAA,EAAD,CAAQnB,OAAQ+M,EAAqB9M,QAAS,WAAQ+M,EAAuB,OAA7E,UACtB,eAAC3L,GAAA,EAAD,uCACA,eAACC,GAAA,EAAD,UACG2L,GAA+C,OAAhC3R,KAAKC,UAAU0R,GAAwB,eAAC3C,GAAD,CAAUlJ,WAAS,EAAC/C,MAAO0O,EAAqB9K,QAAS,SAAA0G,GAC9G9N,QAAQC,IAAI,aAAc6N,IACzBuB,SAAU,WACXzQ,GAAIgB,QAAQ,OAAQ,OAAOyJ,MAAK,SAAAvI,GACZ,MAAdA,EAAKI,OACTzC,GAAMT,SAASE,GAAS4C,EAAKzF,KAAKmI,QAClCoI,WAEa,UAIf8G,EAAS,SAAUvO,GACvB,IAAMmN,EAAUnB,KACR9U,EAAmB8I,EAAnB9I,KAAM0W,EAAa5N,EAAb4N,SAGVY,EAAS,EACTC,EAAe,GACnBb,EAASlL,KAAI,SAACgM,EAAUrX,GACtBmX,EAASA,EAAStX,EAAKyX,iBAAiBD,EAASE,UAAUtX,OAASkX,EAAStX,EAAKyX,iBAAiBD,EAASE,UAAUtX,OACtHmX,EAAalX,KAAKmX,EAASE,aAG7B,IAAIC,EAAkBC,SAASN,EAAS,GACpCK,EAAkB,IAAGA,EAAkB,GAG3C,IADA,IAAIE,EAAO,GAfmB,WAgBrB1X,GACP,IAjB4B,EAiBxB2X,EAAQ,CAAC,eAACxC,GAAD,CAAwByC,KAAK,OAAOnC,MAAM,SAASC,QAAS,EAAGrF,QAASmH,IAAoBxX,EAAIH,EAAKgY,SAAW,KAAMvC,SAAU6B,EAAS,IAAMnX,GAA9H,SAjBF,eAkBXoX,GAlBW,yBAkBnBzH,EAlBmB,QAoB1B,IAAM9P,EAAKyX,iBAAiB3H,GAAM3P,GAGhC,OADA2X,EAAMzX,KAAK,eAACiV,GAAD,CAAkDO,QAAS,GAAzC7V,EAAKgY,SAAWlI,EAAO3P,EAAI,MACxD,WAEF,IAAI0O,EAAW7O,EAAKyX,iBAAiB3H,GAAM3P,GAE3C2X,EAAMzX,KAAK,eAACiV,GAAD,CAAwEM,MAAM,SAASC,QAAS,EAAGrF,QAAS,SAAM3B,EAASK,OAAzGlP,EAAKgY,SAAWlI,EAAOjB,EAASG,OAAS7O,EAAI,UAE1E2X,EAAMzX,KAAK,eAACiV,GAAD,CAAuEM,MAAM,SAASC,QAAS,EAAGrF,QAAS,eAACrE,GAAA,EAAD,CAAK1C,UAAU,MAAMwO,UAAWhC,EAAQhB,SAAxC,SACnHpG,EAASoG,YADiBjV,EAAKgY,SAAWlI,EAAOjB,EAASG,OAAS7O,EAAI,SAG1E2X,EAAMzX,KAAK,eAACiV,GAAD,CAAwEM,MAAM,SAASC,QAAS,EAAGrF,QAASrQ,IAAMwX,EAAmB9I,EAASqJ,MAAQ,SAAO,GAAIzC,SAAU6B,EAAS,IAAMnX,GAAxKH,EAAKgY,SAAWlI,EAAOjB,EAASG,OAAS7O,EAAI,UAE1E2X,EAAMzX,KAAK,eAACiV,GAAD,CAAuEM,MAAM,SAASC,QAAS,EAAGrF,QAC1G,WACC,IAAI2H,EAAYjE,GAAe,CAAErF,aAAYzO,OAC7C,OAAQ,gBAACgY,GAAA,EAAD,CAAoErM,QAAuB,IAAdoM,EAAkB,WAGrG,IAAIE,EAAS,GACb,IAAK,IAAMC,KAAOtY,EACJ,qBAARsY,IACFD,EAAOC,GAAOtY,EAAKsY,IACvBzJ,EAASwJ,OAASA,EAElBrB,EAAenI,GACf8C,IAAoB,GACpBiF,GAAqB,IACnB,WAAQE,EAAuB5C,GAAe,CAAErF,eAAiBoJ,UAAWhC,EAAQZ,WAZhF,yBAY+F8C,EAAY,EAAZ,WAAqBA,EAArB,KAAqC,KAZzHnY,EAAKgY,SAAWlI,EAAOjB,EAASG,OAAS7O,EAAI,YAFjE,IAD0BH,EAAKgY,SAAWlI,EAAOjB,EAASG,OAAS7O,EAAI,UAhB5E,2BAA+B,IAlBH,8BA4D5B0X,EAAKxX,KAAK,eAACkY,GAAA,EAAD,UAAmCT,GAApB9X,EAAKgY,SAAW7X,KA5ClCA,EAAI,EAAGA,EAAImX,EAAQnX,IAAM,EAAzBA,GA8CT,OAAO0X,GAGJ9B,KACHA,IAAiB,EAEjBrW,YAAW,WACJ8Y,GACLA,MACC,MAGL,IAAMA,EAAa,WAEjB,GAAK1C,GAQE,CACL,IAAI2C,EAAmBrV,GAAMC,WAAW+E,OAAOqO,cAAcH,GAEzDmC,IACFjC,EAAWiC,GACX9B,EAAY8B,EAAiB/B,UAE7BnT,GAAIgB,QAAQ,SAAU,OAAQ,CAAE2S,YAAa,CAAET,cAAe,CAAEH,WAAYtI,MAAK,SAAAvI,GAC7D,MAAdA,EAAKI,OACTzC,GAAMT,SAASI,GAAU0C,EAAKzF,OAC9B8V,IAAmB,EACnBvF,cAlBJuF,IAAmB,EACnBvS,GAAIgB,QAAQ,SAAU,OAAQ,CAAE2S,YAAa,CAAET,cAAe,CAAEH,WAAYtI,MAAK,SAAAvI,GAC7D,MAAdA,EAAKI,OACTzC,GAAMT,SAASI,GAAU0C,EAAKzF,OAC9B8V,IAAmB,EACnBvF,SAqBN,IAAKgG,EAEH,OADAiC,IACQ,eAAC/D,GAAA,EAAD,UACN,eAACwC,GAAA,EAAD,MAGJ,IAAIyB,EAAmB,CAAC,eAAC/C,GAAA,EAAD,CAAsBC,MAAM,SAASC,QAAS,EAA9C,yBAAe,SACvCa,EAASlL,KAAI,SAACtL,EAAGC,GACfuY,EAAiBrY,KAAK,eAACsV,GAAA,EAAD,CAA6BC,MAAM,SAASC,QAAS,EAArD,qCAAgB,IAAM3V,EAAIC,IAChDuY,EAAiBrY,KAAK,eAACsV,GAAA,EAAD,CAA6BC,MAAM,SAASC,QAAS,EAArD,yBAAgB,IAAM3V,EAAIC,IAChDuY,EAAiBrY,KAAK,eAACsV,GAAA,EAAD,CAA6BC,MAAM,SAASC,QAAS,EAArD,yBAAgB,IAAM3V,EAAIC,OAGlD,IAAMwY,EAAc,gBAACC,GAAA,EAAD,WAClB,gBAACL,GAAA,EAAD,WACE,gBAAC5C,GAAA,EAAD,CAAWC,MAAM,SAASC,QAAS,EAAnC,cAAwCS,EAAKrU,MAAMqU,EAAKlW,OAAS,EAAGkW,EAAKlW,QAAzE,SAAmF,SAAM,CAAC,SAAK,SAAK,SAAK,SAAK,SAAK,SAAK,UAAKqB,GAA7H,OACCiV,EAASlL,KAAI,SAACtL,EAAGC,GAAJ,OACZ,gBAACwV,GAAA,EAAD,CAAWC,MAAM,SAAiBC,QAAS,EAA3C,UAA+C3V,EAAEwX,SAAjD,IAA4DxX,EAAE2Y,aAA9D,MAA+B1Y,SAGnC,eAACoY,GAAA,EAAD,UACGG,OAGL,OAAKnC,GAAYA,EAAQuC,WASvB,gBAACrE,GAAA,EAAD,WACE,eAACsE,GAAA,EAAD,CAAgBtP,UAAWuP,KAA3B,SACE,gBAACC,GAAA,EAAD,CAAOC,cAAY,EAACjB,UAAWhC,EAAQjB,MAAvC,UACG2D,EACD,eAACQ,GAAA,EAAD,UACG5C,EAAQuC,WAAWtN,KAAI,SAACtL,EAAGC,GAAJ,OACtB,eAACkX,EAAD,CAA2BrX,KAAME,EAAGwW,SAAUA,GAAjC,SAAWvW,aAK/BiX,EACD,eAACxF,GAAD,CACEC,SAAO,EACPnD,QAAS,CAAEG,SAAUkI,EAAa9E,SAAW8E,GAA+C,OAAhC3R,KAAKC,UAAU0R,GAA/B,UAA2DA,EAAYqC,SAAvE,iBAAmF3W,IAAY,IAAInB,MAAOM,WAA1G,OAAsHmV,EAAYsB,OAAOgB,YAAe,MACpMvP,KAAMuI,EACNP,UAAW,WAET0G,IACAjV,GAAIgB,QAAQ,OAAQ,OAAOyJ,MAAK,SAAAvI,GACZ,MAAdA,EAAKI,MAITzC,GAAMT,SAASE,GAAS4C,EAAKzF,KAAKmI,QAClCoI,KAJEnN,GAAMT,SAASK,GAAayC,QAOlCsE,QAAS,WAAQ6M,GAAqB,SAnClC,gBAACnC,GAAA,EAAD,WACN,4BACA,eAACwC,GAAA,EAAD,QC5NN,SAASqC,GAASxQ,GAAQ,IAChByQ,EAAqCzQ,EAArCyQ,SAAUzN,EAA2BhD,EAA3BgD,MAAO0N,EAAoB1Q,EAApB0Q,MAAUC,EADZ,aACsB3Q,EADtB,8BAGvB,OACE,8CACE4Q,KAAK,WACLC,OAAQ7N,IAAU0N,EAClBI,GAAE,mCAA8BJ,GAChCK,kBAAA,8BAAwCL,IACpCC,GALN,aAOG3N,IAAU0N,GACT,eAACrN,GAAA,EAAD,UAEGoN,OAaX,IAAMzE,GAAYC,aAAW,SAACrN,GAAD,YAAY,CACvCoS,MAAI,GACFC,UAAW,OACXxM,QAAS,QACThC,MAAO,OACPyO,SAAU,GAJR,sBAKK,QALL,gCAMetS,EAAMb,QAAQoT,WAAWC,OANxC,GAQJC,YAAa,CACXvK,OAAQlI,EAAM+L,QAAQ,GACtB9D,SAAU,KAEZyK,YAAa,CACXC,UAAW3S,EAAM+L,QAAQ,QAWd,SAAS6G,GAAcxR,GACpC,IAAMmN,EAAUnB,KAD2B,EAET5L,IAAMoB,UAAS,IAAIhJ,MAAOM,UAFjB,mBAEpC2Y,EAFoC,KAE1BC,EAF0B,OAGTtR,IAAMoB,UAAS,GAHN,mBAGpCmQ,EAHoC,KAGzBC,EAHyB,OAIXxR,IAAMoB,UAAS,GAJJ,mBAIpCqQ,EAJoC,KAI1BC,EAJ0B,KAQrC5F,EAAQ,uBAAKiD,UAAWhC,EAAQ6D,KAAxB,UACZ,eAACe,GAAA,EAAD,CACE/O,MAAOyO,EACPlO,SAAU,SAACtE,EAAG0E,GAAJ,OAAY+N,EAAc/N,IACpCqO,eAAe,UACfC,UAAU,UACVrN,QAAQ,aACRsN,cAAc,OACdC,aAAW,+BAPb,SASG,CAAC,SAAK,SAAK,SAAK,SAAK,SAAK,SAAK,UAAKzP,KAAI,SAACtL,EAAGC,GAC3C,OAAQ,eAAC+a,GAAA,EAAD,aAAKC,MAAO,SAAMjb,GAzBzB,CACL0Z,GAAG,uBAAD,OAFaJ,EA0BwCrZ,GAvBvD,gBAAgB,4BAAhB,OAA6CqZ,KAuBPrZ,GA1B1C,IAAmBqZ,OA6Bd,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAGhO,KAAI,SAACtL,EAAGC,GAAJ,OAAU,eAACmZ,GAAD,CAAkBxN,MAAOyO,EAAUf,MAAOtZ,EAA1C,SACnC,eAAC,GAAD,CAAcuB,IAAK8Y,KAD+Bpa,SAItD,OAEE,eADA,CACA,iBACE,gBAACib,GAAA,EAAD,CAAanD,UAAWhC,EAAQkE,YAAhC,UACE,eAACkB,GAAA,EAAD,uCACA,eAACpO,GAAA,EAAD,CACEnB,MAAOyO,EACPlO,SA5Ba,SAACiP,GACpBd,EAAcc,EAAMzO,OAAOf,QAyBvB,SAIGrJ,GAAY+I,KAAI,SAACtL,EAAGC,GAAJ,OAAU,eAAC+M,GAAA,EAAD,CAAkBpB,MAAO3L,EAAzB,SAA6B,SAAMD,GAApBC,WAG9C,eAACqM,EAAA,EAAD,CAAYlB,MAAO,CAAEiQ,MAAO,SAAW7N,QAAQ,YAAY3B,QAAS,WAClE2O,GAAa,GACbE,GAAY,IAFd,SAGG,eAAC,KAAD,MACDnX,OAAO+X,YAAc,IAAMxG,EAAQ,gBAAC9I,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAAY3B,QAAS,WAAQ2O,GAAcD,IAArE,yBAAuFA,EAAY,eAAO,eAA1G,kBACrC,gBAACxP,GAAA,EAAD,CAAQwQ,WAAYd,EAAU5Q,QAAS,WAAQ2Q,GAAa,IAAW5Q,KAAM2Q,EAA7E,UACE,gBAACtP,GAAA,EAAD,WACE,gBAACgB,GAAA,EAAD,CAAK1C,UAAU,OAAf,mBAAwBhH,GAAY8X,GAApC,KAAgD,IAAIjZ,MAAOE,OAAO+Y,GAAUxY,eAA5E,mBACC4Y,EAAW,eAACnO,EAAA,EAAD,CAAYkP,KAAK,MAAMpQ,MAAO,CAAEiQ,MAAO,SAAWxP,QAAS,WACrE6O,GAAY,GACZF,GAAa,IAFH,SAGT,eAAC,KAAD,MAAsC,eAAClO,EAAA,EAAD,CAAYlB,MAAO,CAAEiQ,MAAO,SAAW7N,QAAQ,YAAY3B,QAAS,WAC3G2O,GAAa,GACbE,GAAY,IAF2B,SAGtC,eAAC,KAAD,SACJ5F,Q,ICvHH2G,G,oDACJ,WAAY7S,GAAQ,IAAD,8BACjB,cAAMA,IACDP,MAAQnF,GAAMC,WACnB,EAAKuY,YAAcxY,GAAMyY,WAAU,WACjC,EAAKhJ,SAAS,CACZiJ,eAAgB1Y,GAAMC,WAAWyY,eACjCC,iBAAkB3Y,GAAMC,WAAW0Y,iBACnCC,eAAgB5Y,GAAMC,WAAW2Y,oBAPpB,E,wDAWnB,WACEra,KAAKia,gB,oBAEP,WACE,OAAQ,eAAC3C,GAAA,EAAD,UACN,gBAACE,GAAA,EAAD,WACE,gBAACZ,GAAA,EAAD,WACE,eAAC5C,GAAA,EAAD,CAAWC,MAAM,SAAjB,sCACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,oBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,uBAEF,gBAAC2C,GAAA,EAAD,WACE,gBAAC5C,GAAA,EAAD,CAAWC,MAAM,SAAjB,UAA2BxS,GAAMC,WAAW8E,MAAM/H,OAAlD,YACA,eAACuV,GAAA,EAAD,CAAWC,MAAM,SAAjB,oBACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,gC,GA1Ba1M,IAAM+S,WA2CdC,OAVf,WACE,OAAQ,gBAACzH,GAAA,EAAD,CAAWnJ,MAAO,CAAEyO,UAAW,OAAQxO,MAAO,QAA9C,UACN,eAACkC,EAAA,EAAD,CAAYC,QAAQ,KAApB,sCACA,eAAC,GAAD,IACA,wBACA,eAACD,EAAA,EAAD,CAAYC,QAAQ,KAApB,sCACA,eAAC4M,GAAD,Q,UC8HW6B,OAnKf,SAAkBrT,GAAQ,IAAD,EACWI,IAAMoB,SAASlH,GAAMC,WAAWmB,OAAOxE,KAAKsH,YADvD,mBAChB8U,EADgB,KACLC,EADK,KAEjBC,EAAqBpT,IAAMqT,SAFV,EAG2BrT,IAAMoB,UAAS,GAH1C,mBAGhBkS,EAHgB,KAGGC,EAHH,OAIqBvT,IAAMoB,UAAS,GAJpC,mBAIhBoS,EAJgB,KAIAC,EAJA,OAKazT,IAAMoB,UAAS,GAL5B,mBAKhBsS,EALgB,KAKJC,EALI,OAMS3T,IAAMoB,UAAS,GANxB,mBAMhBwS,EANgB,KAMNC,EANM,KAQjBC,EAAgB,WACpB,IAAIC,EAAI7Z,GAAMC,WAAWmB,OACzByY,EAAEjd,KAAOid,EAAE9V,aACX8V,EAAEvW,OACFuW,EAAEzW,OACFpD,GAAMT,SAASD,GAAUua,KAGrB5W,EAAOjD,GAAMC,WAAWgD,KAE9B,OAAQ,gBAACoO,GAAA,EAAD,CAAWE,SAAS,KAApB,UACN,gBAACtJ,EAAA,EAAD,WACE,eAAC+H,GAAA,EAAD,uCACA,gBAAC7J,GAAA,EAAD,WACE,eAACI,GAAA,EAAD,CAAc7C,QAAQ,uBACtB,eAACqG,GAAA,EAAD,UACG9G,EAAK6W,cAGV,eAAC3T,GAAA,EAAD,CAAUC,QAAM,EAACuC,QAAS,WAAQgR,GAAY,IAA9C,SACE,eAACpT,GAAA,EAAD,CAAc7C,QAAQ,+BAExB,eAACyC,GAAA,EAAD,CAAUC,QAAM,EAAhB,SACE,eAACG,GAAA,EAAD,CAAc7C,QAAQ,+BAExB,eAACsM,GAAA,EAAD,uCACA,eAAC7J,GAAA,EAAD,CAAUC,QAAM,EAACuC,QAAS,WAAQ8Q,GAAc,IAAhD,SACE,eAAClT,GAAA,EAAD,CAAc7C,QAAQ,+BAExB,eAACsM,GAAA,EAAD,2BACA,gBAAC7J,GAAA,EAAD,WACE,eAACI,GAAA,EAAD,CAAc7C,QAAQ,6BACtB,eAACqG,GAAA,EAAD,UACE,eAACiO,GAAA,EAAD,UAEE,eAACnO,GAAA,EAAD,CAAQnB,MAAOsQ,EAAW/P,SAAU,SAAAtE,GAClCsU,EAAatU,EAAE8E,OAAOf,OACtB,IAAImR,EAAI7Z,GAAMC,WAAWmB,OACzByY,EAAEjd,KAAKsH,WAAaS,EAAE8E,OAAOf,MAC7BmR,EAAEvV,MAAQuV,EAAEtW,gBAAgBsW,EAAEjd,KAAKsH,YACnC2V,EAAEvW,OACFtD,GAAMT,SAASD,GAAUua,IACzBvd,YAAW,WAAQ+D,OAAOC,SAASyZ,WAAa,MAPlD,SASG/Z,GAAMC,WAAWmB,OAAOxE,KAAK2G,gBAAgB6E,KAAI,SAACC,EAAGnL,GAAJ,OAAU,eAAC4M,GAAA,EAAD,CAAkBpB,MAAOL,EAAzB,SAA6BA,GAAdnL,eAKnF,eAAC8S,GAAA,EAAD,uCACA,eAAC7J,GAAA,EAAD,CAAUC,QAAM,EAACuC,QAAS,YhBWzB,SAAqByE,EAAS4M,GACnC,IAAIC,EAAUC,SAASC,cAAc,KACrCF,EAAQG,SAAWJ,EACnBC,EAAQ/R,MAAMiC,QAAU,OAExB,IAAIkQ,EAAO,IAAIC,KAAK,CAAClN,IACrB6M,EAAQ1Z,KAAOga,IAAIC,gBAAgBH,GAEnCH,SAASnY,KAAK0Y,YAAYR,GAC1BA,EAAQS,QAERR,SAASnY,KAAK4Y,YAAYV,GgBrBpBW,CAAY5a,GAAMC,WAAWmB,OAAOkC,OAAzB,4DAA6C,IAAIpF,MAAO2c,iBAAxD,YADb,SAGE,eAACtU,GAAA,EAAD,CAAc7C,QAAQ,+BAExB,gBAACyC,GAAA,EAAD,CAAUC,QAAM,EAACuC,QAAS,WAExBuQ,EAAmB4B,QAAQJ,SAF7B,UAIE,eAACnU,GAAA,EAAD,CAAc7C,QAAQ,6BACtB,eAACqG,GAAA,EAAD,UACE,wBAAOvK,KAAK,OAAOnD,OAAO,QAAQka,QAAM,EAAC7J,KAAK,gBAAgBxG,IAAKgT,EAAoBjQ,SAAU,SAAAtE,GAE/F,IAAIoW,EAAQpW,EAAE8E,OAAOsR,MACrB,GAAqB,IAAjBA,EAAM/d,OAIV,IACE,IAAIge,EAAOD,EAAM,GACbE,EAAS,IAAIC,WACjBD,EAAOE,WAAWH,EAAM,SACxBC,EAAOG,OAAS,SAAAC,GACd,IAAMC,EAAWD,EAAI5R,OAAOsH,OAC5B,IACE,IAAMzO,EAAKN,KAAKuC,MAAM+W,GACtB,IAAKhZ,EAAG2B,iBAEN,YADAjE,GAAMT,SAASM,GAAW,yFAG5B,GAAIyC,EAAG2B,iBAAmBjE,GAAMC,WAAWmB,OAAOxE,KAAKqH,iBAErD,YADAjE,GAAMT,SAASM,GAAW,wCAAD,OAAWyC,EAAG2B,iBAAd,+CAAuCjE,GAAMC,WAAWmB,OAAOxE,KAAKqH,iBAApE,uDAG3B,IAAI4V,EAAI7Z,GAAMC,WAAWmB,OACzByY,EAAEjd,KAAO0F,EACTtC,GAAMT,SAASD,GAAUua,IACzB7Z,GAAMT,SAASM,GAAW,yCAC1B,MAAO8E,GACP3E,GAAMT,SAASK,GAAa+E,MAGhC,MAAOA,GACP3E,GAAMT,SAASK,GAAa+E,SA5B5B3E,GAAMT,SAASM,GAAW,2CAiClC,gBAACsG,GAAA,EAAD,WACE,eAACI,GAAA,EAAD,CAAc7C,QAAQ,yCACtB,eAACqG,GAAA,EAAD,UACE,eAACwR,GAAA,EAAD,CAAQC,eAAgBxb,GAAMC,WAAWmB,OAAOxE,KAAKuH,eAAgB8E,SAAU,SAAAtE,GAC7E,IAAIkV,EAAI7Z,GAAMC,WAAWmB,OACzByY,EAAEjd,KAAKuH,eAAiBQ,EAAE8E,OAAOgS,QACjC5B,EAAEvW,OACFtD,GAAMT,SAASD,GAAUua,YAI/B,eAAC1T,GAAA,EAAD,CAAUC,QAAM,EAACuC,QAAS,kBAAM0Q,GAAqB,IAArD,SACE,eAAC9S,GAAA,EAAD,CAAc7C,QAAQ,2CAExB,eAACyC,GAAA,EAAD,CAAUC,QAAM,EAACuC,QAAS,kBAAM4Q,GAAkB,IAAlD,SACE,eAAChT,GAAA,EAAD,CAAc7C,QAAQ,8CAG1B,eAAC6G,GAAD,CAAU3N,KAAMoD,GAAMC,WAAWgD,KAAMyD,KAAMgT,EAAU7S,SAAU,CAC/DiT,SAAU,qBAAO4B,KAAM,eAAMC,MAAO,iCAASC,QAAS,2BAAQzW,MAAO,2BAAQ0W,WAAY,qBAAOC,WAAY,sBAC3GlV,MAAM,2BAAOD,QAAS,WAAQgT,GAAY,MAC7C,eAACpP,GAAD,CAAU3N,KAAMoD,GAAMC,WAAW+E,OAAQ0B,KAAM8S,EAAY3S,SAAU,CACnEkV,QAAS,uCAAUC,UAAW,uCAAUC,YAAa,wCACpDrV,MAAM,2BAAOD,QAAS,WAAQ8S,GAAc,MAC/C,gBAAC5R,GAAA,EAAD,CAAQnB,KAAM0S,EAAmBzS,QAAS,kBAAM0S,GAAqB,IAArE,UACE,eAACtR,GAAA,EAAD,mDAGA,eAACC,GAAA,EAAD,UACE,eAACqC,EAAA,EAAD,CAAYC,QAAQ,QAApB,kIAEF,gBAACN,GAAA,EAAD,WACE,eAAClB,GAAA,EAAD,CAAQH,QAAS,kBAAM0Q,GAAqB,IAA5C,0BACA,eAACvQ,GAAA,EAAD,CAAQH,QAAS,WACfiR,IACAvZ,OAAOC,SAASyZ,UAFlB,gCAMJ,gBAAClS,GAAA,EAAD,CAAQnB,KAAM4S,EAAgB3S,QAAS,kBAAM4S,GAAkB,IAA/D,UACE,eAACxR,GAAA,EAAD,mDAGA,eAACC,GAAA,EAAD,UACE,eAACqC,EAAA,EAAD,CAAYC,QAAQ,QAApB,sHAEF,gBAACN,GAAA,EAAD,WACE,eAAClB,GAAA,EAAD,CAAQH,QAAS,kBAAM4Q,GAAkB,IAAzC,0BACA,eAACzQ,GAAA,EAAD,CAAQH,QAAS,WACfiR,IACAvZ,OAAOC,SAASyZ,UAFlB,oC,mBC/JFmC,G,WACJ,WAAYrb,GAAM,IAAD,2BACftC,KAAK4d,QAAU5d,KAAK4d,QAAQ9Y,KAAK9E,MACjCA,KAAKsC,IAAMA,GAAOb,GAAMC,WAAWmB,OAAOxE,KAAKwH,aAAaC,QAAU,sBACtE9F,KAAK6d,GAAK,KACV7d,KAAK8d,OAAS,WACZ9a,QAAQC,IAAI,uBAEdjD,KAAK+d,OAAS,SAAA3X,GACE,SAAVA,EAAE4X,IACJ,EAAKC,OAAO7X,EAAE/H,MACK,YAAV+H,EAAE4X,KACX,EAAKE,UAAU9X,EAAE/H,OAGrB2B,KAAKme,UAAY,SAAA/X,GAEf,EAAK2X,OAAOta,KAAKuC,MAAMI,EAAE/H,QAE3B2B,KAAKoe,QAAU,SAAAhY,GACbpD,QAAQiB,MAAMmC,IAEhBpG,KAAKqe,QAAU,WACbrb,QAAQC,IAAI,sBAEdjD,KAAKie,OAAS,SAAA/Z,GAAUlB,QAAQC,IAAI,OAAQiB,IAC5ClE,KAAKke,UAAY,SAAAV,GAAaxa,QAAQC,IAAI,UAAWua,I,2CAEvD,WACExd,KAAK6d,GAAK7d,KAAK6d,IAAM,IAAIS,UAAUte,KAAKsC,KACxCtC,KAAK6d,GAAGC,OAAS9d,KAAK8d,OACtB9d,KAAK6d,GAAGQ,QAAUre,KAAKqe,QACvBre,KAAK6d,GAAGO,QAAUpe,KAAKoe,QACvBpe,KAAK6d,GAAGM,UAAYne,KAAKme,Y,mBAE3B,WACMne,KAAK6d,IAAI7d,KAAK6d,GAAGU,Y,KCjCnBC,GAASC,EAAQ,KAEvB,SAASC,GAAUvX,GAAQ,IACjByQ,EAAazQ,EAAbyQ,SACR,OAAO,eAACpN,GAAA,EAAD,CAAKb,MAAO,CAAEC,MAAO,OAAQ+B,OAAQ,OAAQC,QAAS,OAAQC,eAAgB,SAAUiD,cAAe,UAAvG,SAAmH,eAACtE,GAAA,EAAD,CAAKb,MAAO,CAAEC,MAAO,OAAQ+U,UAAW,UAAxC,SAAqD/G,M,IAG5JgH,G,oDACnB,WAAYzX,GAAQ,IAAD,8BACjB,cAAMA,IACDP,MAAQ,CACX1C,KAAM,KACN2a,WAAW,GAEb,EAAKC,OAAS,KASd/gB,WAAU,sBAAC,gCAAAkB,EAAA,0DACLwC,GAAMC,WAAW+E,SAAU,EAAKG,MAAMiY,UADjC,iEAESjd,GAAIgB,QAAQ,eAAgB,SAFrC,UAEH6B,EAFG,QAGLhD,GAAMC,WAAW+E,SAAU,EAAKG,MAAMiY,UAHjC,oDAIH/Y,EAASrB,EAAIpG,KAAKyH,QACpBjD,EAASpB,GAAMC,WAAWmB,QACvBxE,KAAKwH,aAAaC,OAASA,EAClCrE,GAAMT,SAASD,GAAU8B,KACrBpB,GAAMC,WAAW+E,SAAU,EAAKG,MAAMiY,UARjC,sDAST,EAAKC,OAAS,IAAInB,GAAa7X,GAC/B,EAAKgZ,OAAOb,OAAS,SAAA/Z,GAEfzC,GAAMC,WAAW+E,QAAU,EAAKG,MAAMiY,WAC1C,EAAK3N,SAAS,CAAEhN,UAElB,EAAK4a,OAAOZ,UAAZ,uCAAwB,WAAMV,GAAN,iBAAAve,EAAA,sEACH2C,GAAIgB,QAAQ,eAAgB,OAAQ,CAAE4a,YADnC,UAChB1Z,EADgB,OAEtBd,QAAQC,IAAI,OAAQa,IAChBrC,GAAMC,WAAW+E,SAAU,EAAKG,MAAMiY,UAHpB,wDAItB,EAAK3N,SAAS,CAAE2N,WAAW,IAJL,SAKDjd,GAAIgB,QAAQ,eAAgB,OAL3B,OAMF,OADd6D,EALgB,QAMXvC,MAAgBuC,EAAOpI,KAAK0gB,KACrCtd,GAAMT,SAASI,GAAUqF,EAAOpI,OAPZ,4CAAxB,kCAAA2B,KAAA,gBAUIyB,GAAMC,WAAW+E,SAAU,EAAKG,MAAMiY,UAzBjC,mDA0BT,EAAKC,OAAOlB,UA1BH,4CA2BR,KA1Cc,E,wDA4CnB,WACM5d,KAAK8e,QAAQ9e,KAAK8e,OAAOP,U,oBAG/B,WACE,IAAI1P,EAAU,KAUd,OAREA,EADE7O,KAAK4G,MAAMiY,UACH,eAACxH,GAAA,EAAD,CAAO1N,MAAO,CAAEC,MAAO,IAAK+B,OAAQ,KAApC,SACR,eAAC+S,GAAD,yCAGQ1e,KAAK4G,MAAM1C,KAAO,eAACsa,GAAD,CAAQrU,MAAO1G,KAAKC,UAAU1D,KAAK4G,MAAM1C,MAAO8a,KAAM,MAAU,eAAC3H,GAAA,EAAD,CAAO1N,MAAO,CAAEC,MAAO,IAAK+B,OAAQ,KAApC,SAC1F,eAAC+S,GAAD,8DAGI,eAAC5L,GAAA,EAAD,UACLjE,Q,GA7DkCtH,IAAM+S,W,UCL/C,SAAS2E,GAAW9X,GAAQ,IAAD,EACMI,IAAMoB,SAAS,CAC5C4S,SAAU,GACV2D,SAAU,GACVC,QAAS,GACT3S,WAAY,UALW,mBAClB5F,EADkB,KACXqK,EADW,KAOnBmO,EAAc7X,IAAMqT,SACpByE,EAAc9X,IAAMqT,SACpB1J,EAAW,SAACpS,GAAD,OAAYmS,EAAcrS,GAAagI,EAAO9H,KAEzDwgB,EAAmC,UAArB1Y,EAAM4F,WACpB+S,EAAY,uCAAG,gCAAAtgB,EAAA,0DAEfqgB,EAFe,iCAGC1d,GAAIgB,QAAQ,UAAW,OAAQ,CAC/C2Y,SAAU3U,EAAM2U,SAAU2D,SAAUtY,EAAMsY,WAJ3B,UAGXza,EAHW,OAMjBzB,QAAQC,IAAIwB,GACK,MAAbA,EAAIP,KAPS,iEASEtC,GAAIgB,QAAQ,OAAQ,OATtB,UAUC,OADZ8B,EATW,QAURR,KAVQ,mDAWjBlB,QAAQC,IAAI,OAAQyB,EAAKrG,KAAKqG,MAC9BjD,GAAMT,SAASG,GAAQuD,EAAKrG,KAAKqG,OAZhB,yCAeC9C,GAAIgB,QAAQ,OAAQ,OAAQ,CAC5C2Y,SAAU3U,EAAM2U,SAAU2D,SAAUtY,EAAMsY,WAhB3B,QAeXza,EAfW,OAkBjBzB,QAAQC,IAAIwB,GACK,MAAbA,EAAIP,OAENzC,GAAMT,SAASM,GAAW,6BAC1B4P,EAAS,CAAC1E,WAAY,WAtBP,4CAAH,qDA2BlB,OAAQ,gBAAChC,GAAA,EAAD,WACN,eAACsB,EAAA,EAAD,CAAYC,QAAQ,KAApB,SAA0BuT,EAAc,eAAO,iBAC/C,wBACA,eAACE,EAAA,EAAD,IACA,wBACA,eAACxU,GAAA,EAAD,CAAWzB,WAAS,EAAC5B,IAAKyX,EAAa5F,MAAM,qBAAMzN,QAAQ,WAAW5B,MAAOvD,EAAM2U,SAAU7Q,SAAU,SAAAtE,GACrG8K,EAAS,CAAEqK,SAAUnV,EAAE8E,OAAOf,SAC7BsV,UAAW,SAAArZ,GACG,UAAXA,EAAElC,MACJmb,EAAY9C,QAAQmD,cAAc,SAASC,WAG/C,wBAAM,wBACN,eAAC3U,GAAA,EAAD,CAAWzB,WAAS,EAAC5B,IAAK0X,EAAa7F,MAAM,eAAKzN,QAAQ,WAAW5B,MAAOvD,EAAMsY,SAAUje,KAAK,WAAWyJ,SAAU,SAAAtE,GACpH8K,EAAS,CAAEgO,SAAU9Y,EAAE8E,OAAOf,SAC7BsV,UAAW,SAAArZ,GACG,UAAXA,EAAElC,MACJqb,OAGJ,eAACK,GAAA,EAAD,CAAMC,GAAIP,EAAa3V,MAAO,CAAEiC,QAAS0T,EAAc,QAAU,QAAUQ,QAAS,CAAEC,KAAM,EAAGC,MAAO,KAAtG,SACE,gBAACxV,GAAA,EAAD,WACE,gBAACA,GAAA,EAAD,WACE,wBACA,eAACD,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAAYL,MAAM,UAAUtB,QAASmV,EAA/D,6BAEF,gBAAC/U,GAAA,EAAD,WACE,wBACA,eAACD,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAAYL,MAAM,YAAYtB,QAAS,kBAAM8G,EAAS,CAAE1E,WAAY,aAA9F,kCAIN,eAACoT,GAAA,EAAD,CAAMC,IAAKP,EAAa3V,MAAO,CAAEiC,QAAU0T,EAAwB,OAAV,SAAoBQ,QAAS,CAAEC,KAAM,EAAGC,MAAO,KAAxG,SACE,gBAACxV,GAAA,EAAD,WACE,gBAACA,GAAA,EAAD,WACE,wBACA,eAACD,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAAYL,MAAM,UAAUtB,QAASmV,EAA/D,6BAEF,gBAAC/U,GAAA,EAAD,WACE,wBACA,eAACD,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAAY3B,QAAS,kBAAM8G,EAAS,CAAE1E,WAAY,WAA5E,iDAOK,SAASyT,GAAM9Y,GAC5B,OAAO,eAAC2L,GAAA,EAAD,CAAWE,SAAS,KAApB,SACL,eAACiM,GAAD,M,6CC+DWiB,OAtJf,SAAkB/Y,GAAQ,IAAD,EACOI,IAAMoB,UAAS,GADtB,mBAChBwX,EADgB,KACPC,EADO,OAES7Y,IAAMoB,UAAS,GAFxB,mBAEhB0X,EAFgB,KAENC,EAFM,KAGjBC,EAAS,CAAC,iCAAS,iCAAS,iCAAS,iCAAS,iCAAS,kCACvDC,EAAa,CAAE,iCAAS,6BAAU,iCAAS,yCAAY,iCAAS,6BAAU,iCAAS,yCAAY,iCAAS,6BAAU,iCAAS,0CAJ1G,EAKqBjZ,IAAMoB,SAAS,MALpC,mBAKhB8X,EALgB,KAKAC,EALA,KAMjBC,EAAgB,CACpB,CAAC,KAAM,MAAO,CAAC,KAAM,MAAO,CAAC,KAAM,MAAO,CAAC,KAAM,OAAQ,CAAC,MAAO,OAAQ,CAAC,MAAO,QAE7EC,EAAaL,EAAO1W,KAAI,SAACC,EAAGnL,GAChC,OAAO,eAAGmL,EAAI6W,EAAchiB,OAExBkiB,EAAgB,WACpB,IAD0B,EACtBC,EAAO,GADe,eAEPF,GAFO,IAE1B,gCAAW1U,EAAX,QACE,IAAK,IAAMvN,KAAKuN,EACd4U,EAAKniB,GAAKuN,EAAKvN,IAJO,8BAK1B,OAAOmiB,EALa,GAZC,EAoBevZ,IAAMoB,SAASkY,GApB9B,mBAoBhBE,EApBgB,KAoBHC,EApBG,KAqBjBC,EAAgB,WACpB,IAAIC,EAAa,GACjB,IAAK,IAAMviB,KAAKoiB,EAAaG,EAAWviB,GAAKoiB,EAAYpiB,GACzD,OAAOuiB,GAGHC,EAAQZ,EAAO1W,KAAI,SAACC,EAAGnL,GAC3B,OAAOwhB,EACL,gBAACvY,GAAA,EAAD,WACE,eAACI,GAAA,EAAD,CAAc7C,QAASqb,EAAW1W,KAClC,eAAC0B,GAAA,EAAD,UACE,gBAAChB,GAAA,EAAD,WACE,eAACQ,GAAA,EAAD,CAAWoW,WAAY,CAAEzX,MAAO,CAAEgV,UAAW,WAAcxU,MAAO4W,EAAYjX,GAAG,GAAIY,SAAU,SAAAtE,GAC7F,IAAI+G,EAAM8T,IACV9T,EAAIrD,GAAG,GAAK1D,EAAE8E,OAAOf,MACrB6W,EAAe7T,MAJnB,IAME,eAACnC,GAAA,EAAD,CAAWoW,WAAY,CAAEzX,MAAO,CAAEgV,UAAW,WAAcxU,MAAO4W,EAAYjX,GAAG,GAAIY,SAAU,SAAAtE,GAC7F,IAAI+G,EAAM8T,IACV9T,EAAIrD,GAAG,GAAK1D,EAAE8E,OAAOf,MACrB6W,EAAe7T,aAZRxO,GAiBf,gBAACiJ,GAAA,EAAD,WACE,eAACI,GAAA,EAAD,CAAc7C,QAASqb,EAAW1W,KAClC,eAAC0B,GAAA,EAAD,UACE,eAACR,GAAA,EAAD,CAAWoW,WAAY,CAAEzX,MAAO,CAAEgV,UAAW,WAAcpV,WAAS,EAACY,MAAO4W,EAAYjX,GAAG,GAAIY,SAAU,SAAAtE,GACvG,IAAI+G,EAAM8T,IACV9T,EAAIrD,GAAG,GAAK1D,EAAE8E,OAAOf,MACrB6W,EAAe7T,UANNxO,MAWbkQ,EAAU,eAACnF,EAAA,EAAD,UACbyX,IAkCG3O,EAAUiO,EAAwB,eAACnJ,GAAA,EAAD,UACtC,gBAACE,GAAA,EAAD,WACG2I,EAAU,gBAACvJ,GAAA,EAAD,WACT,eAAC5C,GAAA,EAAD,CAAWC,MAAM,SAASC,QAAS,EAAnC,kDACA,eAACF,GAAA,EAAD,CAAWC,MAAM,SAASC,QAAS,EAAnC,kDACA,eAACF,GAAA,EAAD,CAAWC,MAAM,SAASC,QAAS,EAAnC,qDACY,gBAAC0C,GAAA,EAAD,WACZ,eAAC5C,GAAA,EAAD,CAAWC,MAAM,SAAjB,kDACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,kDACA,eAACD,GAAA,EAAD,CAAWC,MAAM,SAAjB,qDAEDkM,EAAU,gBAACvJ,GAAA,EAAD,WACT,eAAC5C,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,QAAY,MAC9D,eAACzM,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,QAAY,MAC9D,eAACzM,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,MAAU,MAC5D,eAACzM,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,MAAU,MAC5D,eAACzM,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,MAAU,MAC5D,eAACzM,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,MAAU,SAChD,gBAAC7J,GAAA,EAAD,WACZ,eAAC5C,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,QAAY,MAC9D,eAACzM,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,MAAU,MAC5D,eAACzM,GAAA,EAAD,CAAWC,MAAM,SAAjB,SAA2BgC,SAASwK,EAAc,MAAU,cArBjC,KAyBjC,OAAQ,gBAAC3N,GAAA,EAAD,CAAWE,SAAS,KAApB,UACN,eAAClH,EAAA,EAAD,CAAYC,QAAQ,KAApB,oEACA,gBAACvB,GAAA,EAAD,WACE,eAAC6W,GAAA,EAAD,CAAkBC,QAAS,eAACC,GAAA,EAAD,CAAU7W,SAAU,SAAAtE,GAC7Cga,EAAWha,EAAE8E,OAAOgS,SACpBwD,EAAkB,OACjBxD,QAASiD,EAASzU,MAAM,cAAgB8N,MAAM,yCACjD,eAAC3O,EAAA,EAAD,CAAYT,QAAS,kBAAMkW,GAAY,IAAvC,SACE,eAAC,KAAD,SAGJ,eAACd,EAAA,EAAD,IACC3Q,EACD,eAACtE,GAAA,EAAD,CAAQhB,WAAS,EAACwC,QAAQ,YAAYL,MAAM,YAAYtB,QAtEnC,WAErB,IAAI8W,EAAaD,IACjB,IAAKd,EACH,IAAK,IAAMxhB,KAAKuiB,EACdA,EAAWviB,GAAK,CAACuiB,EAAWviB,GAAG,IACnC,IAAK,IAAMA,KAAKuiB,EACd,IAAK,IAAI1iB,EAAI,EAAGA,EAAI0iB,EAAWviB,GAAGF,OAAQD,IAAK,CAC7C,IAAIsM,EAAM,KACV,IACEA,EAAMG,WAAWiW,EAAWviB,GAAGH,IAC/B,MAAO4H,GAEP,YADA3E,GAAMT,SAASK,GAAa,6BAAD,OAAU6f,EAAWviB,GAAGH,GAAxB,aAA+B4H,KAG5D,IAAK0E,GAAe,IAARA,EAEV,YADArJ,GAAMT,SAASK,GAAa,6BAAD,OAAU6f,EAAWviB,GAAGH,MAGrD0iB,EAAWviB,GAAGH,GAAKsM,EAGvB9H,QAAQC,IAAIQ,KAAKC,UAAUwd,IAK3Btf,GAAIgB,QAAQ,WAAY,OAAQ,CAAE4e,aAAcN,IAAc7U,MAAK,SAAA9N,GACjEyE,QAAQC,IAAI1E,GACZmiB,EAAkBniB,EAAEF,UAyCtB,0BACA,eAACmhB,EAAA,EAAD,IACChN,EACD,gBAAClJ,GAAA,EAAD,CAAQnB,KAAMkY,EAAUjY,QAAS,WAAQkY,GAAY,IAArD,UACE,eAAC9W,GAAA,EAAD,uCACA,gBAACC,GAAA,EAAD,WACE,eAACqC,EAAA,EAAD,CAAYC,QAAQ,KAApB,kDACA,eAACD,EAAA,EAAD,CAAYC,QAAQ,QAApB,gRACA,eAACD,EAAA,EAAD,CAAYC,QAAQ,KAApB,sCACA,eAACD,EAAA,EAAD,CAAYC,QAAQ,QAApB,wVACA,eAACD,EAAA,EAAD,CAAYC,QAAQ,KAApB,kDACA,eAACD,EAAA,EAAD,CAAYC,QAAQ,QAApB,qSAEF,eAACN,GAAA,EAAD,UACE,eAAClB,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAAS,WAAQkW,GAAY,IAArD,mCCnGFmB,GAAc,IACpB9W,IAAO+W,OAAO,SAEd,IAAMvO,GAAYC,aAAW,SAACrN,GAAD,MAAY,CACvCoS,KAAM,CACJvM,QAAS,OACThC,MAAO,QAGT+X,OAAQ,CACNC,OAAQ7b,EAAM6b,OAAOC,OAAS,EAC9BC,WAAY/b,EAAMgc,YAAYC,OAAO,CAAC,QAAS,UAAW,CACxDC,OAAQlc,EAAMgc,YAAYE,OAAOC,MACjCC,SAAUpc,EAAMgc,YAAYI,SAASC,iBAGzC/Z,MAAO,CACLgQ,SAAU,GAEZgK,YAAa,CACXC,WAAYb,GACZ7X,MAAM,eAAD,OAAiB6X,GAAjB,OACLK,WAAY/b,EAAMgc,YAAYC,OAAO,CAAC,QAAS,UAAW,CACxDC,OAAQlc,EAAMgc,YAAYE,OAAOC,MACjCC,SAAUpc,EAAMgc,YAAYI,SAASI,kBAGzCC,WAAY,CACVC,YAAa,IAEfC,KAAM,CACJ9W,QAAS,QAEXiW,OAAQ,CACNjY,MAAO6X,GACPkB,WAAY,EACZnP,WAAY,UAEdoP,WAAY,CACVhZ,MAAO6X,GACPK,WAAY/b,EAAMgc,YAAYC,OAAO,QAAS,CAC5CC,OAAQlc,EAAMgc,YAAYE,OAAOC,MACjCC,SAAUpc,EAAMgc,YAAYI,SAASI,kBAGzCM,YAAY,aACVf,WAAY/b,EAAMgc,YAAYC,OAAO,QAAS,CAC5CC,OAAQlc,EAAMgc,YAAYE,OAAOC,MACjCC,SAAUpc,EAAMgc,YAAYI,SAASC,gBAEvChK,UAAW,SACXxO,MAAO7D,EAAM+L,QAAQ,GAAK,GACzB/L,EAAM+c,YAAYC,GAAG,MAAQ,CAC5BnZ,MAAO7D,EAAM+L,QAAQ,KAGzBkR,QAAQ,aACNpX,QAAS,OACTqX,WAAY,SACZpX,eAAgB,WAChBgI,QAAS9N,EAAM+L,QAAQ,EAAG,IAEvB/L,EAAMmd,OAAOF,SAElBnU,QAAS,CACPwJ,SAAU,EACVxE,QAAS9N,EAAM+L,QAAQ,GACvBlI,MAAO,OACPwO,UAAW,YAaX+K,GAAc,GAEdC,GAAY,CACdvgB,OAAQ,KACR6B,KAAM,KACN+B,OAAQ,MAGVhF,GAAMyY,UAAN,sBAAgB,8BAAAjb,EAAA,2DACV2H,EAAQnF,GAAMC,YAGRmB,OAAOxE,KAJH,oBAKRoF,KAAKC,UAAUkD,EAAM/D,OAAOxE,QAAUoF,KAAKC,UAAU0f,GAAUvgB,QALvD,mBAOV+D,EAAM/D,OAAOkC,QACTtD,GAAMC,WAAWgD,OAAQjD,GAAMC,WAAWmB,OAAOxE,KAAKuH,eARhD,gCASFhE,GAAIgB,QAAQ,OAAQ,OAAQ,CAAEC,OAAQ+D,EAAM/D,OAAOxE,OATjD,6BAcZ+kB,GAAUvgB,OAAS+D,EAAM/D,OAAOxE,KAdpB,QAgBd,IAASglB,KAAWF,GAClBA,GAAYE,GAASzc,GAjBT,6CAqBhB,IAAM0c,GAAe,WACnB,OAAM7hB,GAAMC,WAAW+E,QAAUhF,GAAMC,WAAW+E,OAAOgX,WAAahc,GAAMC,WAAW+E,OAAOgX,UAAU8F,SAE7F,UAAM9hB,GAAMC,WAAW+E,OAAOgX,UAAU8F,SAAxC,cAAsD9hB,GAAMC,WAAW+E,OAAOgX,UAAU+F,YAFuB,MAO7G,SAASC,KAAO,IAAD,IACtBnP,EAAUnB,KACVpN,EAAQ2d,cAFc,EAGJnc,IAAMoB,UAAS,GAHX,mBAGrBR,EAHqB,KAGfwb,EAHe,OAIQpc,IAAMoB,UAAS,GAJvB,mBAITib,GAJS,aAKkBrc,IAAMoB,UAAS,GALjC,mBAKrBkb,EALqB,KAKJC,EALI,OAMMvc,IAAMoB,SAAS,MANrB,mBAMrBob,EANqB,KAMVC,EANU,OAOIzc,IAAMoB,UAAS,GAPnB,mBAQtBsb,GARsB,UAQP,oDARO,EASF1c,IAAMoB,SAAS2a,MAAkBW,GAT/B,mBASrB5b,EATqB,KASd6b,GATc,QAUG3c,IAAMmH,YAAW,SAAAC,GAAC,OAAIA,EAAI,IAAG,GAVhC,qBAUZC,IAVY,aAiB5BuU,GAAW,MAAY,SAAUvc,GAC3BA,EAAMF,YACR1D,QAAQC,IAAI,eAAgB2D,EAAMF,WAClCod,EAAmBld,EAAMF,WAEzBjF,GAAMT,SAASK,GAAa,SAIhC8hB,GAAW,QAAc,SAAUvc,GAC7BA,EAAMvC,UACRrB,QAAQC,IAAI,YAAa2D,EAAMvC,SAC/B2f,EAAapd,EAAMvC,SACnB5C,GAAMT,SAASM,GAAW,SAG9B6hB,GAAW,KAAX,uCAAsB,WAAgBvc,GAAhB,SAAA3H,EAAA,sDAChB2H,EAAMlC,OACJjB,KAAKC,UAAUkD,EAAMlC,OAASjB,KAAKC,UAAU0f,GAAU1e,QACzDkK,KAGKwU,GAAU1e,MAKjB0e,GAAU1e,KAAOkC,EAAMlC,MAXL,2CAAtB,sDAcAye,GAAW,OAAX,uCAAwB,WAAgBvc,GAAhB,SAAA3H,EAAA,sDAClB2H,EAAMH,SACJhD,KAAKC,UAAUkD,EAAMH,SAAWhD,KAAKC,UAAU0f,GAAU3c,SAC3DmI,KAEFwU,GAAU3c,OAASG,EAAMH,OACrBG,EAAMH,OAAOgX,WACXpV,IAAU4b,GACZC,GAASZ,OARO,2CAAxB,sDAqBA/b,IAAM4c,WAAU,WACd,IAAMC,EAAiB,WACrB,IAAIxa,EAAQ9H,OAAO+X,YAEd1R,GAAQyB,GA3DQ,KA2DmB+Z,GAAQ,GAC5Cxb,GAAQyB,GA3DU,KA2DkB+Z,GAAQ,IAKlD,OAHA7hB,OAAOuiB,iBAAiB,OAAQD,GAChCtiB,OAAOuiB,iBAAiB,SAAUD,GAE3B,WACLtiB,OAAOwiB,oBAAoB,OAAQF,GACnCtiB,OAAOwiB,oBAAoB,SAAUF,OAKzC,IAMMG,GAAc,eAAC,IAAD,UAClB,gBAAC,IAAD,CAAyBC,MAAOC,IAAa/C,OAAO,QAApD,UACE,eAACgD,EAAA,EAAD,IACA,eAACC,EAAA,EAAD,CACEC,SAAS,QACTtO,UAAWuO,YAAKvQ,EAAQqN,OAAT,eACZrN,EAAQ+N,YAAcla,IAH3B,SAME,gBAAC2c,EAAA,EAAD,WACE,eAACja,EAAA,EAAD,CACEa,MAAM,UACN4N,aAAW,cACXlP,QAAS,WAAQuZ,GAAQ,IACzB5J,KAAK,QACLzD,UAAWuO,YAAKvQ,EAAQkO,WAAT,eACZlO,EAAQoO,KAAOva,IANpB,SASE,eAAC,IAAD,MAEF,eAAC2D,EAAA,EAAD,CAAYC,QAAQ,KAAKgZ,QAAM,EAACzO,UAAWhC,EAAQjM,MAAnD,SACGA,IAEH,eAACwC,EAAA,EAAD,CACEa,MAAM,UACN4N,aAAW,QACXlP,QAAS,WAAQwZ,GAAc,IAHjC,SAKE,eAAC,IAAD,WAIN,gBAACoB,EAAA,EAAD,CACEjZ,QAAQ,YACRuK,UAAWuO,YAAKvQ,EAAQuN,QAAT,mBACZvN,EAAQsO,WAAaza,GADT,cAEZmM,EAAQuO,aAAe1a,GAFX,IAIfmM,QAAS,CACPiE,MAAOsM,aAAI,mBACRvQ,EAAQsO,WAAaza,GADb,cAERmM,EAAQuO,aAAe1a,GAFf,KAPf,UAaE,sBAAKmO,UAAWhC,EAAQ0O,QAAxB,SACE,eAACnY,EAAA,EAAD,CAAYT,QAAS,WAAQuZ,GAAQ,IAArC,SACuB,QAApB5d,EAAMkf,UAAsB,eAAC,IAAD,IAAuB,eAAC,IAAD,QAGxD,eAACzF,EAAA,EAAD,IACA,gBAAC9V,EAAA,EAAD,CAAMU,QA1Dc,YACpBtI,OAAO+X,WAAa,KAAoC,MAA7B/X,OAAOC,SAASmjB,WAC7CvB,GAAQ,IAwDN,UACE,eAAC,GAAD,CAActc,GAAG,IAAIlC,QAAQ,qBAAMiC,KAAM,eAAC,IAAD,MACzC,eAAC,GAAD,CAAcC,GAAG,SAASlC,QAAQ,eAAKiC,KAAM,eAAC,IAAD,MAC7C,eAAC,GAAD,CAAcC,GAAG,YAAYlC,QAAQ,2BAAOiC,KAAM,eAAC,IAAD,MAClD,eAAC,GAAD,CAAcC,GAAG,YAAYlC,QAAQ,eAAKiC,KAAM,eAAC,IAAD,YAGpD,wBAAMkP,UAAWhC,EAAQzF,QAAzB,UACE,sBAAKyH,UAAWhC,EAAQ0O,UACxB,gBAAC,IAAD,WACE,eAAC,IAAD,CAAOmC,KAAM,IAAKC,OAAO,EAAzB,SACE,eAAC,GAAD,MAEF,eAAC,IAAD,CAAOD,KAAM,SAAUC,OAAO,EAA9B,SACE,eAACxS,GAAD,MAEF,eAAC,IAAD,CAAOuS,KAAM,YAAaC,OAAO,EAAjC,SACE,eAAC,GAAD,MAEF,eAAC,IAAD,CAAOD,KAAM,YAAaC,OAAO,EAAjC,SACE,eAAC,GAAD,iBAOJ1gB,GAAOjD,GAAMC,WAAWgD,KACxB2gB,IAAiB3gB,IAAQjD,GAAMC,WAAWmB,OAAOxE,KAAKyE,UAAUP,aAClEsM,GAAUwW,GAAgB,eAAC7a,GAAA,EAAD,0CAAsB9F,GAAO6f,GAAc,eAACtE,GAAD,IAMzE,OALMoF,KAAiB3gB,IAAUjD,GAAMC,WAAW+E,SAChDoI,GAAU,eAAC,GAAD,KAKV,sBAAKyH,UAAWhC,EAAQ6D,KAAxB,SACE,gBAACmN,EAAA,EAAD,CAAevf,MAAOtE,GAAMC,WAAWmB,OAAOkD,MAA9C,UACG8I,GACD,gBAACvF,GAAA,EAAD,CAAQnB,OAAM0b,EAAgCzb,QAAS,WAAQ0b,EAAmB,OAAlF,UACE,eAACta,GAAA,EAAD,uCACA,gBAACC,GAAA,EAAD,WACE,eAACqC,EAAA,EAAD,CAAYC,QAAQ,QAApB,sCACA,eAACvB,GAAA,EAAD,CAAK1C,UAAU,MAAf,SACE,eAAC0C,GAAA,EAAD,CAAK1C,UAAU,MAAf,SACG,WACC,OAAI9J,GAAW6lB,IAAiD,kBAArBA,EAClC,eAACna,EAAA,EAAD,UACJma,EAAgBha,KAAI,SAACtL,EAAGC,GAAJ,OAAU,eAACoJ,GAAA,EAAD,UAC7B,gCAA6B,OAAtBnE,KAAKC,UAAUnF,GAAcA,EAAEgnB,WAAa9hB,KAAKC,UAAUnF,MADtBC,QAKzC,gCAA2C,OAApCiF,KAAKC,UAAUmgB,GAA4BA,EAAgB0B,WAAa9hB,KAAKC,UAAUmgB,aAM/G,gBAACpY,GAAA,EAAD,WACE,eAAClB,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAAS,WAAQtI,OAAOC,SAASyZ,UAAzD,0BACA,eAACjR,GAAA,EAAD,CAAQmB,MAAM,UAAUtB,QAAS,WAAQ0Z,EAAmB,OAA5D,gCAGJ,eAAC0B,GAAA,EAAD,CACEC,aAAc,CACZC,SAAU,SACVC,WAAY,SAEdxd,KAAoB,OAAd4b,EACN6B,iBAAkB,IAElBvhB,QAAS0f,EACTld,OACE,eAAC,IAAMgf,SAAP,UACE,eAAChb,EAAA,EAAD,CAAYmU,KAAK,QAAQ1F,aAAW,QAAQ5N,MAAM,UAAUtB,QAAS,kBAAM4Z,EAAa,OAAxF,SACE,eAAC,IAAD,CAAW8B,SAAS,qBCvYpC,IAYeC,GAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqB5Z,MAAK,YAAkD,IAA/C6Z,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,O,8CCKd,wCAAA/mB,EAAA,sDAAyBsnB,EAAzB,+BAAiC,IAAjC,uBAOU5oB,GAAM4oB,GAPhB,kE,oEAYA,sBAAAtnB,EAAA,sDACElB,WAAU,sBAAC,gCAAAkB,EAAA,yDACHyF,EAAOjD,GAAMC,WAAWgD,QACPA,GAAQjD,GAAMC,WAAWmB,OAAOxE,KAAKyE,UAAUP,cAF7D,wBAIPX,GAAI4kB,mBAJG,SAKW5kB,GAAIgB,QAAQ,OAAQ,OAL/B,UAOU,OAFX6B,EALC,QAOCP,KAPD,wBASLzC,GAAMT,SAASG,GAAQsD,EAAIpG,KAAKqG,OAT3B,UAUgB9C,GAAIgB,QAAQ,SAAU,OAVtC,QAWe,OADd6D,EAVD,QAWMvC,MAAgBuC,EAAOpI,KAAK0gB,IACrCtd,GAAMT,SAASI,GAAUqF,EAAOpI,OAC3BoD,GAAMT,SAASI,GAAU,OAb3B,4CAuBR,GAxBL,4C,sBA2BAqlB,IAASC,OAEP,eAAC,IAAD,CAAUjlB,MAAOA,GAAjB,SACE,eAAC,GAAD,MAGFka,SAASgL,eAAe,S,2CAG1BC,GAAYva,MAAK,Y,oCACfwa,MAMFd,O","file":"static/js/main.4c09078b.chunk.js","sourcesContent":["import moment from 'moment';\r\nimport 'moment/locale/zh-cn'\r\n\r\nexport function isMobileDevice() {\r\n  const sUserAgent = navigator.userAgent;\r\n  return (sUserAgent.indexOf('Android') > -1 || sUserAgent.indexOf('iPhone') > -1 || sUserAgent.indexOf('iPad') > -1 || sUserAgent.indexOf('iPod') > -1 || sUserAgent.indexOf('Symbian') > -1);\r\n}\r\n\r\n/** \r\n* param 将要转为URL参数字符串的对象 \r\n* key URL参数字符串的前缀 \r\n* encode true/false 是否进行URL编码,默认为true \r\n*  \r\n* return URL参数字符串 \r\n*/\r\nexport function urlEncode(param, key, encode) {\r\n  if (param == null) return '';\r\n  var paramStr = '';\r\n  var t = typeof (param);\r\n  if (t === 'string' || t === 'number' || t === 'boolean') {\r\n    paramStr += '&' + key + '=' + ((encode == null || encode) ? encodeURIComponent(param) : param);\r\n  } else {\r\n    for (var i in param) {\r\n      var k = key == null ? i : key + (param instanceof Array ? '[' + i + ']' : '.' + i);\r\n      paramStr += urlEncode(param[i], k, encode);\r\n    }\r\n  }\r\n  return paramStr;\r\n};\r\n\r\nexport function urlEncode2(obj) {\r\n  try {\r\n    return JSON.stringify(obj).replace(/:/g, \"=\").replace(/\"/g, '').replace(/,/g, '&').match(/\\{([^)]*)\\}/)[1];\r\n  } catch (e) {\r\n    console.error(e);\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function parseTimePoint(time) {\r\n  return moment(time).format('LLLL');\r\n}\r\n\r\nexport function parseTimePeriod(time) {\r\n  return moment.duration(time).humanize();\r\n}\r\n\r\nexport function getTextFieldValue(el) {\r\n  return el.current.childNodes[el.current.childElementCount - 1].childNodes[0].value;\r\n}\r\n\r\nexport function sleep(time_ms) {\r\n  return new Promise(accept => {\r\n    setTimeout(accept, time_ms);\r\n  });\r\n}\r\n\r\n// 设置到本周的星期几\r\nDate.prototype.setDay = function (day) {\r\n  let day_ = this.getDay();\r\n  if (day_ === day) return this;\r\n  this.setTime(this.getTime() + 1000 * 60 * 60 * 24 * (day - day_));\r\n  return this;\r\n};\r\n\r\n// 获取 YYYY-MM-DD 格式\r\nDate.prototype.toDateString = function () {\r\n  return this.toISOString().slice(0, 10);\r\n};\r\n\r\n// export function cutString(str, length=10)\r\n\r\nexport function isIterator(obj) {\r\n  return obj != null && typeof obj[Symbol.iterator] === 'function';\r\n}\r\n\r\n// 下载文件方法\r\nexport function funDownload(content, filename) {\r\n  var eleLink = document.createElement('a');\r\n  eleLink.download = filename;\r\n  eleLink.style.display = 'none';\r\n  // 字符内容转变成blob地址\r\n  var blob = new Blob([content]);\r\n  eleLink.href = URL.createObjectURL(blob);\r\n  // 触发点击\r\n  document.body.appendChild(eleLink);\r\n  eleLink.click();\r\n  // 然后移除\r\n  document.body.removeChild(eleLink);\r\n};\r\n\r\n\r\nexport function deepCopy(data) {\r\n  if (data === null || data === undefined) {\r\n    return data;\r\n  } if (isIterator(data) && typeof (data) !== \"string\") {\r\n    let d = [];\r\n    for (let i = 0; i < data.length; i++) {\r\n      d.push(data[i]);\r\n    }\r\n    return d;\r\n  } else if (typeof (data) === \"object\") {\r\n    let d = {};\r\n    for (const k in data) {\r\n      d[k] = deepCopy(data[k]);\r\n    }\r\n    return d;\r\n  } else {\r\n    return data;\r\n  }\r\n}\r\n\r\nexport function objectUpdate(origin, update) {\r\n  let now = deepCopy(origin);\r\n  for (const k in update) {\r\n    now[k] = update[k];\r\n  }\r\n  return now;\r\n}\r\n\r\n// https://www.jianshu.com/p/7407bd65b15d\r\nexport function isObjectValueEqual(a, b) {\r\n  var aProps = Object.getOwnPropertyNames(a);\r\n  var bProps = Object.getOwnPropertyNames(b);\r\n  if (aProps.length !== bProps.length) {\r\n    return false;\r\n  }\r\n  for (var i = 0; i < aProps.length; i++) {\r\n    var propName = aProps[i]\r\n\r\n    var propA = a[propName]\r\n    var propB = b[propName]\r\n    // 2020-11-18更新，这里忽略了值为undefined的情况\r\n    // 故先判断两边都有相同键名\r\n    if (!b.hasOwnProperty(propName)) return false\r\n    if ((propA instanceof Object)) {\r\n      if (isObjectValueEqual(propA, propB)) {\r\n        // return true     这里不能return ,后面的对象还没判断\r\n      } else {\r\n        return false\r\n      }\r\n    } else if (propA !== propB) {\r\n      return false\r\n    } else { }\r\n  }\r\n  return true\r\n}\r\n\r\n// Array.prototype.indexOf = function (val) {\r\n//   for (var i = 0; i < this.length; i++) {\r\n//     if (this[i] == val) return i;\r\n//   }\r\n//   return -1;\r\n// };\r\n\r\n// Array.prototype.remove = function (val) {\r\n//   var index = this.indexOf(val);\r\n//   if (index > -1) {\r\n//     this.splice(index, 1);\r\n//   }\r\n// };\r\n\r\n// Array.prototype.removeIndex = function (index) {\r\n//   this.splice(index, 1);\r\n// };\r\n\r\n// export function arrayRemove(array, data) {\r\n//   if (!isIterator(array)) return;\r\n//   const index = array.indexOf(data);\r\n//   if (index > -1) {\r\n//     array.slice(index, 1);\r\n//   }\r\n// }\r\n\r\nexport const timedeltaUnits = {\r\n  \"秒\": 1, \"分\": 60, \"时\": 60 * 60,\r\n  \"天\": 24 * 60 * 60, \"周\": 7 * 24 * 60 * 60\r\n};\r\n\r\n\r\nexport function getTimedeltaUnit(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return null;\r\n  if (timedelta >= timedeltaUnits[Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]])\r\n    return Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n  for (let i = 1; i < Object.keys(timedeltaUnits).length; i++) {\r\n    if (timedelta < timedeltaUnits[Object.keys(timedeltaUnits)[i]]) {\r\n      return Object.keys(timedeltaUnits)[i - 1];\r\n    }\r\n  }\r\n  return Object.keys(timedeltaUnits)[0];\r\n}\r\n\r\nexport function getTimedeltaString(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return \"\";\r\n  const unit = getTimedeltaUnit(timedelta);\r\n  if (unit === null) return \"\";\r\n  // console.log(\"unit\", unit);\r\n  return `${(timedelta / timedeltaUnits[unit]).toFixed(2)}${unit}`;\r\n}\r\n\r\nexport const weekDayList = ['日', '一', '二', '三', '四', '五', '六'];","import { objectUpdate } from \"../utils/utils\";\r\nimport store from \"./store\";\r\n\r\nexport function setConfig(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_CONFIG\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTasks(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TASKS\", data: data });\r\n  };\r\n}\r\n\r\nexport function setUser(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_USER\", data: data });\r\n  };\r\n}\r\n\r\nexport function setDaemon(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_DAEMON\", data: data });\r\n  };\r\n}\r\n\r\nexport function setErrorInfo(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ERROR_INFO\", data: data });\r\n  };\r\n}\r\n\r\nexport function setMessage(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_MESSAGE\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTypes(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TYPES\", data: data });\r\n  };\r\n}\r\n\r\n\r\nexport function updateTypes(type, typeData) {\r\n  return setTypes(objectUpdate(store.getState().types, { [type]: typeData }));\r\n}\r\n","import { setConfig, setErrorInfo, setUser } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { isIterator, urlEncode } from \"../utils/utils\"\r\n\r\n\r\n\r\nclass API {\r\n  constructor() {\r\n    // this.host = '127.0.0.1';\r\n    this.host = window.location.href.includes(\"localhost\") ? \"localhost\" : null;\r\n    // this.port = 8080;\r\n    this.port = 8880;\r\n    this.api_version = \"v2\";\r\n    this.api_prefix = `/api/${this.api_version}`;\r\n    this.protocol = 'http'\r\n    this.url = this.host ? `${this.protocol}://${this.host}:${this.port}${this.api_prefix}` : `${this.api_prefix}`;\r\n    this.access_token = '';\r\n    this.refresh_token = '';\r\n  }\r\n  set_token(access_token, refresh_token) {\r\n    // this.access_token = access_token || this.access_token;\r\n    // this.refresh_token = refresh_token || this.refresh_token;\r\n    if (access_token !== undefined)\r\n      this.access_token = access_token;\r\n    if (refresh_token !== undefined)\r\n      this.refresh_token = refresh_token;\r\n  }\r\n  get_token() {\r\n    return {\r\n      access_token: this.access_token === '' ? undefined : this.access_token, refresh_token: this.refresh_token === '' ? undefined : this.refresh_token\r\n    }\r\n  }\r\n  request_key(router, key, method = \"GET\", data) {\r\n    return this.request(`${router}/${key}`, method, data);\r\n  }\r\n  update_config() {\r\n    let config = store.getState().config;\r\n    config.data.api_token = this.get_token();\r\n    console.log('config.data.api_token', config.data.api_token)\r\n    // config.save();\r\n    store.dispatch(setConfig(config));\r\n  }\r\n  load_from_config() {\r\n    const config = store.getState().config;\r\n    this.set_token(config.data.api_token.access_token, config.data.api_token.refresh_token);\r\n  }\r\n  get_headers(refresh = false, access = true) {\r\n    let headers = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (refresh) {\r\n      headers['Refresh'] = this.refresh_token;\r\n    }\r\n    if (access) {\r\n      if (this.access_token !== '') headers['Authorization'] = this.access_token;\r\n    }\r\n    return headers;\r\n  }\r\n  async request(router, method = \"GET\", data) {\r\n    const payload = {\r\n      method: method,\r\n      mode: 'cors',\r\n      body: data ? JSON.stringify(data) : undefined,\r\n      // 注销的时候自带 refresh_token\r\n      headers: this.get_headers(Boolean(router === 'session' && method === 'DELETE')),\r\n    };\r\n    // console.log('request', router, method, data, payload);\r\n    // console.log(`${this.url}/${router}`);\r\n    const resp = await fetch(`${this.url}/${router}`, payload);\r\n    let js = null;\r\n    try { js = await resp.json(); } catch (e) {\r\n      console.error(e);\r\n      store.dispatch(setErrorInfo(e));\r\n      return { code: resp.status, error: resp.statusText };\r\n    }\r\n    console.log('raw js:', js);\r\n    if (!js) {\r\n      // console.log(await resp.json());\r\n      js = {};\r\n      js.message = resp.statusText;\r\n    }\r\n    if (js.code === undefined) js.code = resp.status;\r\n    if (js.code === 422) {\r\n      if (this.refresh_token === '') {\r\n        // 过期勒\r\n        return null;\r\n      }\r\n      // ac_token到期，准备更新\r\n      // console.log(this.get_headers(true));\r\n      const resp2 = await fetch(`${this.url}/session`, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: this.get_headers(true),\r\n        // body: JSON.stringify({ refresh_token: this.refresh_token })\r\n      });\r\n      try {\r\n        const js2 = await resp2.json();\r\n        // console.log('updating ac_token', js2);\r\n        if (js2.code === 200) {\r\n          this.set_token(js2.data.access_token, js2.data.refresh_token);\r\n          this.update_config();\r\n          // 更新user\r\n          const res = this.request('user', 'GET');\r\n          if (res.code === 200) {\r\n            store.dispatch(setUser(res.data.user));\r\n          }\r\n        }\r\n        else {\r\n          // 判定为 update_token 也过期，要求重新登录\r\n          store.dispatch(setErrorInfo(\"登录过期，请重新登录\"));\r\n          return null;\r\n        }\r\n      } catch (e) {\r\n        // console.error(e);\r\n        return { code: resp2.status, error: resp2.statusText };\r\n      }\r\n      return this.request(router, method, data);\r\n    }\r\n    if (js.code === 200) {\r\n      // 登录自动储存 JWT 数据\r\n      if (router === 'session' && method === 'POST') {\r\n        const { access_token, refresh_token } = js.data;\r\n        // console.log('jwt', access_token, refresh_token);\r\n        this.set_token(access_token, refresh_token);\r\n        this.update_config();\r\n      } else if (router === 'session' && method === 'DELETE') {\r\n        // 注销\r\n        // console.warn('注销');\r\n        this.set_token('', '');\r\n        this.update_config();\r\n      }\r\n    } else {\r\n      store.dispatch(setErrorInfo(js));\r\n    }\r\n    return js;\r\n  }\r\n}\r\n\r\nconst api = new API();\r\n\r\nexport { API, api };","import { combineReducers } from 'redux'\r\nimport Config from \"../Config\"\r\n\r\nconst defaultState = {\r\n  config: new Config(),\r\n  tasks: [],\r\n  user: null,\r\n  daemon: null,\r\n  errorInfo: null,\r\n  message: null,\r\n  types: {},\r\n}\r\n\r\nfunction types(state = defaultState.types, action) {\r\n  switch (action.type) {\r\n    case \"SET_TYPES\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction config(state = defaultState.config, action) {\r\n  switch (action.type) {\r\n    case \"SET_CONFIG\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction user(state = defaultState.user, action) {\r\n  switch (action.type) {\r\n    case \"SET_USER\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction tasks(state = defaultState.tasks, action) {\r\n  switch (action.type) {\r\n    case \"SET_TASKS\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction daemon(state = defaultState.daemon, action) {\r\n  switch (action.type) {\r\n    case \"SET_DAEMON\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction errorInfo(state = defaultState.errorInfo, action) {\r\n  switch (action.type) {\r\n    case \"SET_ERROR_INFO\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction message(state = defaultState.message, action) {\r\n  switch (action.type) {\r\n    case \"SET_MESSAGE\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default combineReducers({ config, errorInfo, message, daemon, user, tasks, types });\r\n","import { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport { orange, grey, blueGrey } from '@material-ui/core/colors';\r\nimport { api } from \"./api/api\";\r\n\r\nclass Config {\r\n  ITEM_NAME = \"group_bying_config\";\r\n  constructor() {\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.theme_avaliable = {\r\n      \"默认主题\": createMuiTheme({}),\r\n      '黑暗模式': createMuiTheme({\r\n        palette: {\r\n          type: \"dark\",\r\n          primary: {\r\n            main: blueGrey[500],\r\n          },\r\n          secondary: {\r\n            main: grey[500],\r\n          },\r\n        },\r\n      }),\r\n    }\r\n    // 在构造函数执行的时候加载保存的数据\r\n    this.data_default = {\r\n      debug: false,\r\n      version_frontend: 0.1,\r\n      // 显示主题\r\n      // theme_name: \"黑暗模式\",\r\n      theme_name: \"默认主题\",\r\n      theme_avaliable: [\r\n        '默认主题',\r\n        '黑暗模式'\r\n      ],\r\n      // 设置同步\r\n      settings_async: true,\r\n      // 远程登录服务器\r\n      remote_login: {\r\n        server: \"ws://127.0.0.1:8081\"\r\n      },\r\n      api_token: {}\r\n    };\r\n    this.data = this.data_default;\r\n    this.theme = this.theme_avaliable[\"默认主题\"];\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    console.log(\"Config: loading config...\");\r\n    if (this.data.debug) {\r\n      console.log(\"Config: load default config.\");\r\n      this.save();\r\n    }\r\n    try {\r\n      this.data = JSON.parse(localStorage.getItem(this.ITEM_NAME));\r\n      if (!this.data) throw new Error(\"Null data\");\r\n      console.log(\"Got data:\", this.data);\r\n      if (!this.data.version_frontend || this.data.version_frontend < this.data_default.version_frontend) {\r\n        // 版本升级，增量更新\r\n        console.log(`Config: update ${this.data.version_frontend} -> ${this.data_default.version_frontend}`);\r\n        this.data.version_frontend = this.data_default.version_frontend;\r\n        for (let k in this.data_default) {\r\n          if (!this.data[k]) {\r\n            console.log(`    Config: add value ${k}`);\r\n            this.data[k] = this.data_default[k];\r\n          }\r\n        }\r\n        this.save();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Can not find ${this.ITEM_NAME} in localStorage, use default config.`);\r\n      this.data = this.data_default;\r\n      this.save();\r\n    }\r\n    this.theme = this.theme_avaliable[this.data.theme_name];\r\n    if (!this.theme) this.theme = this.theme_avaliable[\"default\"];\r\n    api.set_token(this.data.api_token.access_token, this.data.api_token.refresh_token);\r\n  }\r\n\r\n  save() {\r\n    console.log(\"Config: saving config...\");\r\n    this.data.api_token = api.get_token();\r\n    const s = JSON.stringify(this.data);\r\n    localStorage.setItem(this.ITEM_NAME, s);\r\n    return s;\r\n  }\r\n};\r\n\r\nexport default Config;","// applyMiddleware: redux通过该函数来使用中间件\r\n// createStore: 用于创建store实例\r\nimport { applyMiddleware, createStore } from 'redux'\r\n\r\n// 中间件，作用：如果不使用该中间件，当我们dispatch一个action时，需要给dispatch函数传入action        \r\n// 对象；但如果我们使用了这个中间件，那么就可以传入一个函数，这个函数接收两个参数:dispatch和    \r\n// getState。这个dispatch可以在将来的异步请求完成后使用，对于异步action很有用\r\nimport thunk from 'redux-thunk'\r\n\r\n// 引入reducer\r\nimport reducers from './reducers.js'\r\n\r\n// 创建store实例\r\nlet store = createStore(\r\n    reducers,\r\n    applyMiddleware(thunk)\r\n)\r\nexport default store","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\n\r\nfunction ListItemLink(props) {\r\n  const { icon, primary, to } = props;\r\n\r\n  const renderLink = React.useMemo(\r\n    () => React.forwardRef((itemProps, ref) => <RouterLink to={to} ref={ref} {...itemProps} />),\r\n    [to],\r\n  );\r\n\r\n  return (\r\n    <li>\r\n      <ListItem button component={renderLink}>\r\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\r\n        <ListItemText primary={primary} />\r\n      </ListItem>\r\n    </li>\r\n  );\r\n}\r\n\r\nListItemLink.propTypes = {\r\n  icon: PropTypes.element,\r\n  primary: PropTypes.string.isRequired,\r\n  to: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default ListItemLink;\r\n\r\n","import { Select, Box, Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, TextField, Typography, MenuItem, IconButton } from \"@material-ui/core\";\r\nimport { DateTimePicker } from \"@material-ui/pickers\";\r\nimport React from \"react\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport store from \"../data/store\";\r\nimport { isIterator, objectUpdate, timedeltaUnits } from \"../utils/utils\";\r\nimport moment from \"moment\";\r\n\r\nexport default function ListEdit(props) {\r\n  const { defaultValue, open, onClose, title, keyNames, dataType, typeName } = props;\r\n  const dismiss = props.dismiss && isIterator(props.dismiss) ? props.dismiss : [];\r\n  const onSave = props.onSave ? props.onSave : null;\r\n  const [data, setInnerData] = React.useState(defaultValue);\r\n  const setData = (update) => setInnerData(objectUpdate(data, update));\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  const [timedeltaUnit, setTimedeltaUnit] = React.useState({});\r\n\r\n  const handleSave = () => {\r\n    onSave && onSave(data);\r\n  }\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          if (dismiss.indexOf(v) >= 0) return null;\r\n          // console.log(\"store.getState().types\", store.getState().types);\r\n          // console.log(\"typeName\", typeName, \"dataType\", dataType);\r\n          const args = dataType && typeName && store.getState().types[typeName][dataType].args[v] ?\r\n            store.getState().types[typeName][dataType].args[v] : null;\r\n          // console.log('v', v, 'args', args);\r\n          if (dataType && typeName && args && !args.editable) return null;\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          // if (((typeof (data[v]) !== \"string\")) && !data[v]) return undefined;\r\n          let value = data[v];\r\n          if ((!value && typeof (value) !== \"number\") && dataType && typeName && args) {\r\n            value = `${args.type}|${args.value ? args.value : ''}`;\r\n          }\r\n          if (typeof (value) === 'object') {\r\n            return <ListItem key={k} button onClick={() => {\r\n              setChild(value);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            let actionData = null;\r\n            if (typeof (value) === \"string\" && value.startsWith(\"timezone|\")) {\r\n              // 时区暂时不可编辑\r\n              actionData = value.slice(\"timezone|\".length);\r\n            } else if (typeof (value) === \"string\" && value.startsWith(\"datetime|\")) {\r\n              // console.log('datetime:', value);\r\n              if (value === 'datetime|') {\r\n                actionData = <Button onClick={() => {\r\n                  setData({ [v]: `datetime|${new Date().toISOString()}` });\r\n                }}>点击设置</Button>;\r\n              } else {\r\n                actionData = <Box>\r\n                  <DateTimePicker\r\n                    value={value.slice(\"datetime|\".length)}\r\n                    onChange={e => {\r\n                      console.log(\"e\", e);\r\n                      // 这里会改变到没有时区的类型\r\n                      console.log(`datetime|${moment(e).format(\"YYYY-MM-DDTHH:mm:ss.SSSSSS+00:00\")}`);\r\n                      setData({ [v]: `datetime|${moment(e).format(\"YYYY-MM-DDTHH:mm:ss.SSSSSS+00:00\")}` });\r\n                    }}\r\n                  ></DateTimePicker>\r\n                  <IconButton onClick={() => {\r\n                    setData({ [v]: null });\r\n                  }}>\r\n                    <DeleteIcon></DeleteIcon>\r\n                  </IconButton>\r\n                </Box>;\r\n              }\r\n            } else if (typeof (value) === \"string\" && value.startsWith(\"timedelta|\")) {\r\n              const val = value.slice(\"timedelta|\".length);\r\n              const unit = timedeltaUnit[v] ? timedeltaUnit[v] : Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n              const updateFixed = () => {\r\n                // const unit2 = timedeltaUnit[v] ? timedeltaUnit[v] : Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n                // const newValue2 = `timedelta|${parseFloat(('' + (parseFloat(data[v].slice(\"timedelta|\".length)) / timedeltaUnits[unit2]).toFixed(2) * timedeltaUnits[unit2]))}`\r\n                // console.log(\"newValue2\", newValue2);\r\n                // setData({ [v]: newValue2 });\r\n              };\r\n              actionData = <Box>\r\n                <TextField value={`${parseFloat(val) / timedeltaUnits[unit]}`} onChange={e => {\r\n                  let val = e.target.value;\r\n                  if (isNaN(parseFloat(val)))\r\n                    if (val.length > 0) return;\r\n                    else val = 0;\r\n                  const newValue = `timedelta|${parseFloat(val) * timedeltaUnits[unit]}`;\r\n                  setData({ [v]: newValue });\r\n                }} onBlur={updateFixed}></TextField>\r\n                <Select value={unit}\r\n                  onChange={e => {\r\n                    setTimedeltaUnit(objectUpdate(timedeltaUnit, { [v]: e.target.value }));\r\n                  }} onBlur={updateFixed}>\r\n                  {Object.keys(timedeltaUnits).map((key, k) => <MenuItem key={k} value={key}>\r\n                    {key}\r\n                  </MenuItem>)}\r\n                </Select>\r\n              </Box>\r\n            } else {\r\n              actionData = <TextField value={`${value}`} onChange={e => {\r\n                const newValue = e.target.value.length === 0 ? 0 : (typeof (value) === \"number\" ? parseFloat(e.target.value) : `${e.target.value}`);\r\n                if (isNaN(newValue)) return;\r\n                setData({ [v]: newValue });\r\n              }}></TextField>;\r\n            }\r\n            return <ListItem key={k}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                {actionData}\r\n              </ListItemSecondaryAction>\r\n            </ListItem>;\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListEdit defaultValue={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListEdit> : undefined}\r\n    </DialogContent>\r\n    {onSave ? <DialogActions>\r\n      <Button color=\"primary\" onClick={handleSave}>保存</Button>\r\n      <Button onClick={onClose}>取消</Button>\r\n    </DialogActions> : <DialogActions><Box style={{ width: \"100%\", height: \"100%\", display: \"flex\", justifyContent: \"center\" }}><Typography style={{ height: \"100%\" }} variant=\"body1\" color=\"secondary\">无法保存</Typography></Box></DialogActions>}\r\n  </Dialog>\r\n}","import { Container, Dialog, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nexport default function ListInfo(props) {\r\n  const { data, open, onClose, title, keyNames } = props;\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  // console.log(data);\r\n  // Object.keys(data).map((v, k) => { console.log(`v: ${v}, k: ${k}`) })\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          if (!data[v]) return undefined;\r\n          if (typeof (data[v]) === 'object') {\r\n            return <ListItem key={k} button onClick={() => {\r\n              setChild(data[v]);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            const s = `${data[v]}`;\r\n            return <ListItem key={k}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                <Typography variant=\"body1\">{s.slice(0, 20) + (s.length > 20 ? \"...\" : \"\")}</Typography>\r\n              </ListItemSecondaryAction>\r\n            </ListItem>\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListInfo data={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListInfo> : undefined}\r\n    </DialogContent>\r\n  </Dialog>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { deepCopy, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\nimport ListEdit from \"./ListEdit\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nconst keyNames = {\r\n  \"item_id\": \"目标项目ID\",\r\n  \"target_price\": \"目标价格\"\r\n};\r\n\r\nexport function isActionModified(item, type = \"actions\") {\r\n  try {\r\n    return !isObjectValueEqual(item.data, store.getState().types[type][item.type].data);\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport function updateActionData(callback) {\r\n  return api.request(\"action\", 'GET').then(resp => {\r\n    // console.log(\"resp\", resp);\r\n    store.dispatch(updateTypes(\"actions\", resp.data.actions));\r\n    callback && callback(resp.data.actions);\r\n  });\r\n}\r\n\r\nexport async function wrapAction(action) {\r\n  const actionType = action.action_type;\r\n  let actionData = null;\r\n  if (!store.getState().types.actions || !store.getState().types.actions[actionType]) {\r\n    await updateActionData((newActionData) => { actionData = newActionData[actionType]; });\r\n  } else actionData = store.getState().types.actions[actionType];\r\n  return objectUpdate(actionData, { data: action });\r\n}\r\n\r\n\r\nfunction getTimedeltaString(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return \"\";\r\n  const timedeltaUnits = {\r\n    \"秒\": 1, \"分\": 60, \"时\": 60 * 60,\r\n    \"天\": 24 * 60 * 60, \"周\": 7 * 24 * 60 * 60\r\n  };\r\n  for (let i = 1; i < Object.keys(timedeltaUnits).length; i++) {\r\n    if (timedelta < timedeltaUnits[Object.keys(timedeltaUnits)[i]]) {\r\n      return `${(timedelta / timedeltaUnits[Object.keys(timedeltaUnits)[i - 1]]).toFixed(2)}${Object.keys(timedeltaUnits)[i - 1]}`;\r\n    }\r\n  }\r\n  return `${(timedelta / timedeltaUnits[Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]]).toFixed(2)}${Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]}`;\r\n}\r\n\r\nfunction getDataString(data, typeName, dataType) {\r\n  let res = \"\";\r\n  if (typeof (data) !== 'object') return;\r\n  for (const key in data) {\r\n    const showName = keyNames ? (keyNames[key] || key) : (key);\r\n    const args = dataType && typeName && store.getState().types[typeName][dataType].args[key] ?\r\n      store.getState().types[typeName][dataType].args[key] : null;\r\n    if (args && !args.editable) continue;\r\n    let value = data[key];\r\n    if (!value && typeof (value) !== 'number') continue;\r\n    if (typeof (value) === 'string') {\r\n      if (value.startsWith(\"datetime|\")) {\r\n        value = moment(value.slice('datetime|'.length)).calendar();\r\n      } else if (value.startsWith('timedelta|')) {\r\n        value = getTimedeltaString(parseFloat(value.slice('timedelta|'.length)));\r\n      }\r\n    }\r\n    res = `${(res.length === 0 ? '' : (res + '/'))}${showName}:${value}`\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function ActionTag(props) {\r\n  let { action, selectMode, onClick, onSave, fullWidth, targets } = props;\r\n  const [dialogOpen, setDialogOpen] = React.useState(false);\r\n  // console.log('targets', targets);\r\n  const [actionTemp, setActionTemp] = React.useState((() => {\r\n    if (action.data.action_type === \"adjust_price\" && targets && targets.roomItem) {\r\n      let tmp = deepCopy(action);\r\n      tmp.data.item_id = targets.roomItem.itemId;\r\n      tmp.data.target_price = targets.roomItem.price;\r\n      return tmp;\r\n    } else return action;\r\n  })());\r\n  const [toUse, setToUse] = React.useState(false);\r\n  onClick = onClick ? onClick : () => { };\r\n  if (!action) return null;\r\n  const handleCloseDialog = () => { setDialogOpen(false); };\r\n  const handleClick = newAction => {\r\n    let selected = deepCopy(newAction ? newAction : actionTemp);\r\n    console.log(\"selected action:\", selected);\r\n    onClick(selected, selectMode);\r\n  };\r\n  return <Card style={{ minWidth: 200, margin: 10, width: (fullWidth ? \"100%\" : \"auto\") }}>\r\n    <CardContent onClick={selectMode ? () => { } : () => { handleClick(); }}>\r\n      <Typography variant=\"h5\">{action.name}</Typography>\r\n      {isActionModified(action, \"actions\") ?\r\n        getDataString(action.data, \"actions\", action.type) :\r\n        <Typography variant=\"body1\">{action.desc}</Typography>\r\n      }\r\n      <ListEdit\r\n        // dismiss={['version', 'timezone']}\r\n        keyNames={keyNames}\r\n        open={dialogOpen}\r\n        dataType={action.type}\r\n        typeName=\"actions\"\r\n        onClose={handleCloseDialog}\r\n        // defaultValue={action.data}\r\n        defaultValue={actionTemp.data}\r\n        onSave={newData => {\r\n          let newAction = deepCopy(action);\r\n          newAction.data = newData;\r\n          console.log('newData', newData);\r\n          onSave && onSave(newAction);\r\n          handleCloseDialog();\r\n          if (toUse) handleClick(newAction);\r\n        }}></ListEdit>\r\n    </CardContent>\r\n    {selectMode ? <CardActions>\r\n      <Button color=\"primary\" onClick={selectMode ? () => { handleClick(); } : () => { }}>使用</Button>\r\n      <Button color=\"primary\" onClick={() => { setDialogOpen(true); setToUse(true); }}>修改设置并使用</Button>\r\n    </CardActions> : <CardActions>\r\n      <Button color={isActionModified(action, \"actions\") ? \"primary\" : \"secondary\"} onClick={() => { setDialogOpen(true); }}>修改设置</Button>\r\n    </CardActions>}\r\n  </Card>\r\n}\r\n\r\nexport default function Actions(props) {\r\n  let { selectMode, onClick, targets } = props;\r\n  onClick = onClick ? onClick : () => { };\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const actions = store.getState().types.actions;\r\n  if (!actions && !requesting) {\r\n    setRequesting(true);\r\n    updateActionData().then(() => { forceUpdate(); });\r\n  }\r\n  // console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!actions) {\r\n    content = <Typography variant=\"body1\">正在加载Action类型...</Typography>\r\n  } else {\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(actions).map((action_type, k) => <ActionTag targets={targets} onClick={onClick} key={k} selectMode={selectMode} action={actions[action_type]}></ActionTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { deepCopy, getTimedeltaString, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\nimport ListEdit from \"./ListEdit\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nconst keyNames = {\r\n  'start_date': \"开始时间\",\r\n  'end_date': '结束时间',\r\n  \"interval\": \"间隔\",\r\n  \"run_date\": '运行时间'\r\n};\r\n\r\nexport function updateTriggerData(callback) {\r\n  return api.request(\"trigger\", 'GET').then(resp => {\r\n    // console.log(\"resp\", resp);\r\n    store.dispatch(updateTypes(\"triggers\", resp.data.triggers));\r\n    callback && callback(resp.data.triggers);\r\n  });\r\n}\r\n\r\nexport function isTriggerModified(item, type = \"triggers\") {\r\n  try {\r\n    return !isObjectValueEqual(item.data, store.getState().types[type][item.type].data);\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport function getTriggerType(trigger) {\r\n  if (trigger.interval) return 'interval';\r\n  if (trigger.run_date) return 'date';\r\n  return 'cron';\r\n}\r\n\r\nexport async function wrapTrigger(trigger) {\r\n  const triggerType = getTriggerType(trigger);\r\n  let triggerData = null;\r\n  if (!store.getState().types.triggers || !store.getState().types.triggers[triggerType]) {\r\n    await updateTriggerData((newTriggerData) => { triggerData = newTriggerData[triggerType] });\r\n  } else triggerData = store.getState().types.triggers[triggerType];\r\n  return objectUpdate(triggerData, { data: trigger });\r\n}\r\n\r\nfunction getDataString(data, typeName, dataType) {\r\n  let res = \"\";\r\n  if (typeof (data) !== 'object') return;\r\n  for (const key in data) {\r\n    const showName = keyNames ? (keyNames[key] || key) : (key);\r\n    const args = dataType && typeName && store.getState().types[typeName][dataType].args[key] ?\r\n      store.getState().types[typeName][dataType].args[key] : null;\r\n    if (args && !args.editable) continue;\r\n    let value = data[key];\r\n    if (!value) continue;\r\n    if (value.startsWith(\"datetime|\")) {\r\n      value = moment(value.slice('datetime|'.length)).calendar();\r\n    } else if (value.startsWith('timedelta|')) {\r\n      value = getTimedeltaString(parseFloat(value.slice('timedelta|'.length)));\r\n    }\r\n    res = `${(res.length === 0 ? '' : (res + '/'))}${showName}:${value}`\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function TriggerTag(props) {\r\n  let { trigger, selectMode, onClick, onSave, fullWidth } = props;\r\n  const [dialogOpen, setDialogOpen] = React.useState(false);\r\n  const [toUse, setToUse] = React.useState(false);\r\n  onClick = onClick ? onClick : () => { };\r\n  if (!trigger) return null;\r\n  const handleCloseDialog = () => { setDialogOpen(false); };\r\n  const handleClick = newTrigger => {\r\n    onClick(newTrigger ? newTrigger : trigger, selectMode);\r\n  };\r\n  return <Card style={{ minWidth: 200, margin: 10, width: (fullWidth ? \"100%\" : \"auto\") }}>\r\n    <CardContent onClick={selectMode ? () => { } : () => { handleClick(); }}>\r\n      <Typography variant=\"h5\">{trigger.name}</Typography>\r\n      {isTriggerModified(trigger, \"triggers\") ?\r\n        getDataString(trigger.data, \"triggers\", trigger.type) :\r\n        <Typography variant=\"body1\">{trigger.desc}</Typography>\r\n      }\r\n      <ListEdit\r\n        dismiss={['version', 'timezone']}\r\n        keyNames={keyNames}\r\n        open={dialogOpen}\r\n        dataType={trigger.type}\r\n        typeName=\"triggers\"\r\n        onClose={handleCloseDialog}\r\n        defaultValue={trigger.data}\r\n        onSave={newData => {\r\n          let newTrigger = deepCopy(trigger);\r\n          newTrigger.data = newData;\r\n          console.log(newData);\r\n          onSave && onSave(newTrigger);\r\n          handleCloseDialog();\r\n          if (toUse) handleClick(newTrigger);\r\n        }}></ListEdit>\r\n    </CardContent>\r\n    {selectMode ? <CardActions>\r\n      <Button color=\"primary\" onClick={selectMode ? () => { handleClick(); } : () => { }}>使用</Button>\r\n      <Button color=\"primary\" onClick={() => { setDialogOpen(true); setToUse(true); }}>修改设置并使用</Button>\r\n    </CardActions> : <CardActions>\r\n      <Button color={isTriggerModified(trigger, \"triggers\") ? \"primary\" : \"secondary\"} onClick={() => { setDialogOpen(true); }}>修改设置</Button>\r\n    </CardActions>}\r\n  </Card>\r\n}\r\n\r\nexport default function Triggers(props) {\r\n  let { selectMode, onClick } = props;\r\n  onClick = onClick ? onClick : () => { };\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const triggers = store.getState().types.triggers;\r\n  if (!triggers && !requesting) {\r\n    setRequesting(true);\r\n    updateTriggerData().then(() => { forceUpdate(); });\r\n  }\r\n  // console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!triggers) {\r\n    content = <Typography variant=\"body1\">正在加载触发器类型...</Typography>\r\n  } else {\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(triggers).map((trigger_type, k) => <TriggerTag onClick={onClick} key={k} selectMode={selectMode} trigger={triggers[trigger_type]}></TriggerTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Box, Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListItemText, ListSubheader, TextField, Typography } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport Actions, { wrapAction } from \"../components/Actions\";\r\nimport { ActionTag, isActionModified } from \"../components/Actions\";\r\nimport Triggers, { wrapTrigger } from \"../components/Triggers\";\r\nimport { TriggerTag, isTriggerModified } from \"../components/Triggers\";\r\nimport { setErrorInfo, setTasks, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { arrayRemove, deepCopy, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\n\r\nlet taskDialogUpdate = false;\r\n\r\nexport function setTaskDialogUpdate(val) { taskDialogUpdate = val; }\r\n\r\nexport default function TaskDialog(props) {\r\n  const { addMode, open, onClose, onRefresh, onSave, taskOld, targets } = props;\r\n  // console.log('targets', targets);\r\n  const baseTaskName = (targets && targets.taskName) ? targets.taskName : '未命名任务';\r\n  const realDefaultTask = {\r\n    task_name: baseTaskName,\r\n    triggers: [],\r\n    actions: [],\r\n  };\r\n  const defaultTask = addMode ? (props.defaultTask ? props.defaultTask : realDefaultTask) : taskOld ? taskOld : (props.defaultTask ? props.defaultTask : realDefaultTask);\r\n  const [state, setInnerState] = React.useState({\r\n    dialogAddTaskOpen: false,\r\n    dialogAddTriggerOpen: false,\r\n    dialogAddActionOpen: false,\r\n    dialogUpdateTrigger: false,\r\n    task: defaultTask,\r\n    requestingTaskData: false,\r\n    defaultTid: null,\r\n  });\r\n  // console.log('baseTaskName', baseTaskName, 'defaultTask', defaultTask);\r\n  // console.log('taskNow', state.task);\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const taskData = store.getState().types.task_data;\r\n\r\n  // console.log('taskNow', state.task);\r\n  if (!addMode && (taskDialogUpdate || (isObjectValueEqual(state.task, realDefaultTask) && !isObjectValueEqual(defaultTask, realDefaultTask)))) {\r\n    taskDialogUpdate = false;\r\n    setState({ task: defaultTask });\r\n  } else if (taskDialogUpdate) {\r\n    taskDialogUpdate = false;\r\n    setState({ task: defaultTask });\r\n  }\r\n\r\n  if (!state.requestingTaskData && !taskData) {\r\n    setState({ requestingTaskData: true });\r\n    api.request(\"task\", 'PATCH').then(resp => {\r\n      // console.log(\"resp\", resp);\r\n      let taskData = resp.data.task_data;\r\n      taskData.tid = null;\r\n      store.dispatch(updateTypes(\"task_data\", taskData));\r\n      forceUpdate();\r\n    })\r\n  }\r\n\r\n  const handleAddTask = addMode ? () => {\r\n    // console.log('pass#2');\r\n    if (!taskData) {\r\n      setErrorInfo(\"Task数据为空。\");\r\n      console.error(\"Task数据为空。\");\r\n      return;\r\n    }\r\n    // const task = objectUpdate(taskData, { triggers: state.task.triggers, actions: state.task.actions, task_name: state.task.task_name, tid: null, });\r\n    const task = objectUpdate(taskData, state.task);\r\n    console.log('task', task);\r\n    return api.request('task', \"POST\", { task }).then(resp => {\r\n      // console.log('resp', resp);\r\n      if (resp.code !== 200) return;\r\n      const defaultTid = resp.data.tid ? (resp.data.tid + 1) : null;\r\n      setState({\r\n        defaultTid,\r\n        taskName: store.getState().types.task_data ? `${baseTaskName}${defaultTid ? defaultTid : \"\"}` : baseTaskName,\r\n      });\r\n      onRefresh && onRefresh();\r\n    });\r\n  } : () => {\r\n    if (!taskOld) return;\r\n    const task = objectUpdate(taskOld, state.task);\r\n    console.log('task', task);\r\n    if (onSave)\r\n      return onSave(task);\r\n    else return new Promise((resolve, reject) => { resolve(); });\r\n  };\r\n\r\n  return <Dialog fullWidth open={open} onClose={() => { onClose && onClose() }}>\r\n    <DialogTitle>{addMode ? \"添加新任务\" : \"设置任务\"}</DialogTitle>\r\n    <DialogContent>\r\n      <List>\r\n        <ListSubheader>计划名称</ListSubheader>\r\n        <ListItem>\r\n          <TextField value={state.task.task_name} onChange={e => {\r\n            let newTask = deepCopy(state.task);\r\n            newTask.task_name = e.target.value;\r\n            setState({ task: newTask });\r\n          }}></TextField>\r\n        </ListItem>\r\n        <ListSubheader>触发器列表</ListSubheader>\r\n        {state.task.triggers.map((trigger, k) => <ListItem key={k}>\r\n          <TriggerTag fullWidth trigger={trigger} onSave={data => {\r\n            console.log('saveing', data);\r\n            let newTask = deepCopy(state.task);\r\n            newTask.triggers[k] = data;\r\n            setState({ task: newTask });\r\n          }}></TriggerTag>\r\n          <ListItemSecondaryAction>\r\n            <IconButton onClick={() => {\r\n              let newTask = deepCopy(state.task);\r\n              newTask.triggers.splice(k, 1);\r\n              setState({ task: newTask });\r\n            }}>\r\n              <DeleteIcon></DeleteIcon>\r\n            </IconButton>\r\n          </ListItemSecondaryAction>\r\n        </ListItem>)}\r\n        <ListSubheader>Actions列表</ListSubheader>\r\n        {state.task.actions.map((action, k) => <ListItem key={k}>\r\n          <ActionTag fullWidth action={action} onSave={data => {\r\n            console.log('saveing', data);\r\n            let newTask = deepCopy(state.task);\r\n            newTask.actions[k] = data;\r\n            setState({ task: newTask });\r\n          }}></ActionTag>\r\n          <ListItemSecondaryAction>\r\n            <IconButton onClick={() => {\r\n              let newTask = deepCopy(state.task);\r\n              newTask.actions.splice(k, 1);\r\n              setState({ task: newTask });\r\n            }}>\r\n              <DeleteIcon></DeleteIcon>\r\n            </IconButton>\r\n          </ListItemSecondaryAction>\r\n        </ListItem>)}\r\n        <ListItem>\r\n          <Grid container spacing={5}>\r\n            <Grid item xs={12} lg={6}>\r\n              <Button fullWidth onClick={() => { setState({ dialogAddTriggerOpen: true }) }} color=\"primary\" variant=\"outlined\">添加触发器</Button>\r\n            </Grid>\r\n            <Grid item xs={12} lg={6}>\r\n              <Button fullWidth onClick={() => { setState({ dialogAddActionOpen: true }) }} color=\"primary\" variant=\"outlined\">添加Action</Button>\r\n            </Grid>\r\n          </Grid>\r\n        </ListItem>\r\n      </List>\r\n      <Dialog open={state.dialogAddTriggerOpen} onClose={() => setState({ dialogAddTriggerOpen: false })}>\r\n        <DialogTitle>选择一个触发器</DialogTitle>\r\n        <DialogContent>\r\n          <Triggers targets={targets} onClick={trigger => {\r\n            console.log(\"trigger\", trigger);\r\n            let newTask = deepCopy(state.task);\r\n            newTask.triggers.push(trigger);\r\n            setState({ dialogAddTriggerOpen: false, task: newTask });\r\n          }} selectMode></Triggers>\r\n        </DialogContent>\r\n      </Dialog>\r\n      <Dialog open={state.dialogAddActionOpen} onClose={() => setState({ dialogAddActionOpen: false })}>\r\n        <DialogTitle>选择一个Action</DialogTitle>\r\n        <DialogContent>\r\n          <Actions targets={targets} onClick={action => {\r\n            console.log(\"action\", action);\r\n            let newTask = deepCopy(state.task);\r\n            newTask.actions.push(action);\r\n            setState({ dialogAddActionOpen: false, task: newTask });\r\n          }} selectMode></Actions>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button color=\"primary\" disabled={state.task.triggers.length === 0 || state.task.actions.length === 0} onClick={async () => {\r\n        // console.log('pass#1');\r\n        handleAddTask().then(() => {\r\n          setState({ task: defaultTask });\r\n          onClose && onClose();\r\n        });\r\n      }}>确定</Button>\r\n      <Button onClick={() => { onClose && onClose(); }}>取消</Button>\r\n    </DialogActions>\r\n  </Dialog >;\r\n}","import { Box, Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListItemText, ListSubheader, TextField, Typography } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport Actions, { wrapAction } from \"../components/Actions\";\r\nimport { ActionTag, isActionModified } from \"../components/Actions\";\r\nimport TaskDialog, { setTaskDialogUpdate } from \"../components/TaskDialog\";\r\nimport Triggers, { wrapTrigger } from \"../components/Triggers\";\r\nimport { TriggerTag, isTriggerModified } from \"../components/Triggers\";\r\nimport { setErrorInfo, setTasks, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { arrayRemove, deepCopy, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\n\r\n\r\nasync function wrapTask(task) {\r\n  const taskData = store.getState().types.task_data;\r\n  if (!taskData) return;\r\n  let taskWrapped = objectUpdate(taskData, task);\r\n  // taskWrapped.triggers = taskWrapped.triggers.map(async trigger => await wrapTrigger(trigger));\r\n  for (let i = 0; i < taskWrapped.triggers.length; i++)\r\n    taskWrapped.triggers[i] = await wrapTrigger(taskWrapped.triggers[i]);\r\n  // taskWrapped.actions = taskWrapped.actions.map(async action => await wrapAction(action));\r\n  for (let i = 0; i < taskWrapped.actions.length; i++)\r\n    taskWrapped.actions[i] = await wrapAction(taskWrapped.actions[i]);\r\n  if (taskWrapped.triggers.includes(null) || taskWrapped.actions.includes(null)) return null;\r\n  return taskWrapped;\r\n}\r\n\r\n\r\nfunction TaskTag(props) {\r\n  const { task, onUpdate, onClick } = props;\r\n  // return <code>{JSON.stringify(task)}</code>;\r\n  return <ListItem button onClick={async () => {\r\n    console.log('task before', task);\r\n    const taskWrapped = await wrapTask(task);\r\n    console.log('task after', taskWrapped);\r\n    onClick && onClick(taskWrapped);\r\n  }}>\r\n    <ListItemText>\r\n      <Box>\r\n        <Typography variant=\"h5\">{task.task_name}</Typography>\r\n      </Box>\r\n      <Box>\r\n        <Typography variant=\"body2\">{`tid:${task.tid}/触发器:${task.triggers.length}/Action:${task.actions.length}`}</Typography>\r\n      </Box>\r\n    </ListItemText>\r\n    <ListItemSecondaryAction>\r\n      <IconButton onClick={() => {\r\n        api.request_key(\"task\", task.tid, \"DELETE\").then(resp => {\r\n          if (resp.code !== 200) store.dispatch(setErrorInfo(resp));\r\n          onUpdate && onUpdate();\r\n        });\r\n      }}>\r\n        <DeleteIcon></DeleteIcon>\r\n      </IconButton>\r\n    </ListItemSecondaryAction>\r\n  </ListItem>\r\n}\r\n\r\nexport function getTargetTasks(targets) {\r\n  const tasks = store.getState().tasks;\r\n  if (!targets || !targets.roomItem || (targets.roomItem && JSON.stringify(targets.roomItem) === \"{}\")) return tasks;\r\n  let result = [];\r\n  for (const task of tasks) {\r\n    for (const action of task.actions) {\r\n      const target = action.data ? action.data : action;\r\n      if (target.action_type === \"adjust_price\") {\r\n        if (targets.roomItem && target.item_id === targets.roomItem.itemId) {\r\n          result.push(task);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  if (result.length > 0)\r\n    console.log(\"getTargetTasks\", result, targets, tasks);\r\n  return result;\r\n}\r\n\r\nexport function getTargetTasksMarks(targets) {\r\n  if (targets) console.log(targets);\r\n  const tasks = store.getState().tasks;\r\n  const marks = tasks.map((task, k) => {\r\n    for (const action of task.actions) {\r\n      const target = action.data ? action.data : action;\r\n      if (target.action_type === \"adjust_price\") {\r\n        if (targets && targets.roomItem && target.item_id === targets.roomItem.itemId) {\r\n          console.log('found', task);\r\n          return true;\r\n        } else if (!targets) return true;\r\n      }\r\n    }\r\n    return false;\r\n  });\r\n  // if (!targets || !targets.roomItem || (targets.roomItem && JSON.stringify(targets.roomItem) === \"{}\")) return tasks;\r\n  // let result = [];\r\n  // for (const task of tasks) {\r\n  //   for (const action of task.actions) {\r\n  //     const target = action.data ? action.data : action;\r\n  //     if (target.action_type === \"adjust_price\") {\r\n  //       if (targets.roomItem && target.item_id === targets.roomItem.itemId) {\r\n  //         result.push(task);\r\n  //         break;\r\n  //       }\r\n  //     }\r\n  //   }\r\n  // }\r\n  // if (result.length > 0)\r\n  //   console.log(\"getTargetTasks\", result, targets, tasks);\r\n  // return result;\r\n  return marks;\r\n}\r\n\r\nexport function TaskList(props) {\r\n  const { onClick, onUpdate, targets, fullWidth } = props;\r\n  // const tasks = getTargetTasks(targets);\r\n  const tasks = props.tasks ? props.tasks : store.getState().tasks;\r\n  const marks = getTargetTasksMarks(targets);\r\n  if (targets && targets.roomItem && JSON.stringify(targets.roomItem) !== \"{}\") console.log('tasks', targets, tasks);\r\n  if (tasks.length > 0) console.log(tasks, marks);\r\n  return tasks.length > 0 ? <List>\r\n    {tasks.map((task, k) => marks[k] ? <TaskTag onClick={onClick} onUpdate={onUpdate} key={k} task={task}></TaskTag> : null)}\r\n  </List> : <List style={{ width: fullWidth ? \"100%\" : null }}>\r\n    <ListItem>\r\n      <Typography variant=\"body1\" color=\"textSecondary\">空列表</Typography>\r\n    </ListItem>\r\n  </List>\r\n}\r\n\r\nexport default function Tasks(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    requestingTasks: false,\r\n    dialogAddTaskOpen: false,\r\n    addMode: true,\r\n    task: null,\r\n  });\r\n  const tasks = store.getState().tasks;\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n\r\n  if (!state.requestingTasks) {\r\n    setState({ requestingTasks: true });\r\n    api.request(\"task\", \"GET\").then(resp => {\r\n      if (resp.code !== 200) {\r\n        store.dispatch(setErrorInfo(resp));\r\n        return;\r\n      }\r\n      store.dispatch(setTasks(resp.data.tasks));\r\n      forceUpdate();\r\n    });\r\n  }\r\n\r\n  return <Container>\r\n    <Grid container spacing={3}>\r\n      <Grid item lg={8} sm={12}>\r\n        <Typography variant=\"h4\">任务列表</Typography>\r\n        {/* {tasks.length > 0 ? <List>\r\n          {tasks.map((task, k) => <TaskTag onClick={task => {\r\n            console.log('Task: onClick', task);\r\n            setTaskDialogUpdate(true);\r\n            setState({ dialogAddTaskOpen: true, addMode: false, task });\r\n          }} onUpdate={() => { setState({ requestingTasks: false }); }} key={k} task={task}></TaskTag>)}\r\n        </List> : <List>\r\n          <ListItem>\r\n            <Typography variant=\"body1\" color=\"textSecondary\">空列表</Typography>\r\n          </ListItem>\r\n        </List>} */}\r\n        <TaskList onClick={task => {\r\n          console.log('Task: onClick', task);\r\n          setTaskDialogUpdate(true);\r\n          setState({ dialogAddTaskOpen: true, addMode: false, task });\r\n        }} onUpdate={() => { setState({ requestingTasks: false }); }}></TaskList>\r\n      </Grid>\r\n      <Grid item lg={4} sm={12}>\r\n        <Container maxWidth=\"xs\">\r\n          <List>\r\n            <ListSubheader>新任务</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => {\r\n                setTaskDialogUpdate(true);\r\n                setState({ dialogAddTaskOpen: true, addMode: true });\r\n              }}>添加新任务</Button>\r\n            </ListItem>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\">设置默认任务</Button>\r\n            </ListItem>\r\n\r\n            <ListSubheader>全部任务管理</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth disabled={tasks.length === 0} variant=\"outlined\" onClick={() => {\r\n                let tids = {};\r\n                tasks.map(task => { tids = Object.assign(tids, { [task.tid]: task.tid }); return null; });\r\n                api.request(\"task\", \"DELETE\", { tids }).then(resp => {\r\n                  // forceUpdate();\r\n                  setState({ requestingTasks: false });\r\n                });\r\n              }}>删除全部任务</Button>\r\n            </ListItem>\r\n          </List>\r\n        </Container>\r\n      </Grid>\r\n    </Grid>\r\n    <TaskDialog taskOld={state.task}\r\n      addMode={state.addMode}\r\n      open={state.dialogAddTaskOpen}\r\n      onRefresh={() => { setState({ requestingTasks: false }); }}\r\n      onClose={() => { setState({ dialogAddTaskOpen: false }); }}\r\n      onSave={task => {\r\n        return api.request_key('task', task.tid, \"POST\", { task }).then(resp => {\r\n          setState({ requestingTasks: false });\r\n        });\r\n      }}\r\n    ></TaskDialog>\r\n  </Container >\r\n}","import React from 'react';\r\nimport { Box, Container, LinearProgress, Button, Dialog, Link, List, ListItemText, DialogTitle, DialogContent, ListItem, Typography } from '@material-ui/core';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { api } from '../api/api';\r\nimport store from '../data/store';\r\nimport { setDaemon, setErrorInfo, setTasks } from '../data/action';\r\nimport TaskDialog, { setTaskDialogUpdate } from \"./TaskDialog\";\r\nimport { weekDayList } from '../utils/utils';\r\nimport { getTargetTasks, TaskList } from '../pages/Tasks';\r\n\r\nconst useStyles = makeStyles({\r\n  table: {\r\n    minWidth: 1200,\r\n  },\r\n  foodDesc: {\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    contentOverflow: 'ellipsis',\r\n    maxWidth: 160\r\n  },\r\n  planButton: {\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    contentOverflow: 'ellipsis',\r\n    maxWidth: 160\r\n  }\r\n});\r\n\r\nfunction MyTableCell(props) {\r\n  let styles = { padding: 3 };\r\n  // console.log('props.noBorder', props.noBorder);\r\n  if (props.noBorder) styles.borderBottom = \"0\";\r\n  return <TableCell align={props.align} colSpan={props.colSpan} style={styles}>{props.content}</TableCell>\r\n}\r\n\r\n// 容易subscribe到已经卸载的component上面...\r\n// store.subscribe(() => {\r\n//   console.log('(tables) redux update to', store.getState());\r\n// });\r\n\r\nlet requestedDayData = null;\r\n// let roomItemNow = {};\r\nlet setUpdateTimer = null;\r\n\r\nfunction ReserveTable(props) {\r\n  const classes = useStyles();\r\n  // console.log('daemon', store.getState().daemon);\r\n  const [requestingDaemon, setRequestingDaemon] = React.useState(false);\r\n  const [requestingUpdate, setRequestingUpdate] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const { day, data } = props;\r\n  const date = new Date().setDay(day).toDateString();\r\n  // const [dayData, setDayData] = React.useState(data ? data : store.getState().daemon.reserve_table[date]);\r\n  const [dayData, setDayData] = React.useState(data);\r\n  const [roomList, setRoomList] = React.useState((store.getState().daemon &&\r\n    store.getState().daemon.reserve_table &&\r\n    store.getState().daemon.reserve_table[date]) ? store.getState().daemon.reserve_table[date].roomList : []);\r\n  const [dialogAddTaskOpen, setDialogAddTaskOpen] = React.useState(false);\r\n  const [dialogTasksListOpen, setDialogTasksListOpen] = React.useState(null);\r\n  const [roomItemNow, setRoomItemNow] = React.useState({});\r\n\r\n  if (!store.getState().daemon) {\r\n    if (!requestingDaemon) {\r\n      setRequestingDaemon(true);\r\n      api.request(\"daemon\", \"GET\").then(resp => {\r\n        if (resp.code !== 200) return;\r\n        store.dispatch(setDaemon(resp.data));\r\n      });\r\n    }\r\n    return <LinearProgress></LinearProgress>;\r\n  }\r\n  if (!store.getState().daemon.reserve_table) {\r\n    if (!requestingUpdate) {\r\n      setRequestingUpdate(true);\r\n      api.request(\"daemon\", \"POST\", { daemon_args: { update_all: true } }).then(resp => {\r\n        if (resp.code !== 200) return;\r\n        store.dispatch(setDaemon(resp.data));\r\n      });\r\n    }\r\n    return <LinearProgress></LinearProgress>;\r\n  }\r\n\r\n  requestedDayData = JSON.stringify(store.getState().daemon.reserve_table[date]) !== '{}' && JSON.stringify(store.getState().daemon.reserve_table[date]) !== undefined;\r\n  // console.log('requested', requestedDayData);\r\n  // console.log('date', date);\r\n\r\n  const TasksListDialog = <Dialog open={!!dialogTasksListOpen} onClose={() => { setDialogTasksListOpen(null); }}>\r\n    <DialogTitle>任务列表</DialogTitle>\r\n    <DialogContent>\r\n      {roomItemNow && JSON.stringify(roomItemNow) !== \"{}\" ? <TaskList fullWidth tasks={dialogTasksListOpen} onClick={task => {\r\n        console.log('click task', task);\r\n      }} onUpdate={() => {\r\n        api.request(\"task\", \"GET\").then(resp => {\r\n          if (resp.code !== 200) return;\r\n          store.dispatch(setTasks(resp.data.tasks));\r\n          forceUpdate();\r\n        });\r\n      }}></TaskList> : null}\r\n    </DialogContent>\r\n  </Dialog>\r\n\r\n  const Period = function (props) {\r\n    const classes = useStyles();\r\n    const { data, roomList } = props;\r\n    // console.log('period', data, 'roomList', roomList);\r\n    // 先找到有几个row，再格式化输出\r\n    let maxRow = 0;\r\n    let roomNameList = [];\r\n    roomList.map((roomData, i) => {\r\n      maxRow = maxRow > data.roomMapItemEntry[roomData.roomName].length ? maxRow : data.roomMapItemEntry[roomData.roomName].length;\r\n      roomNameList.push(roomData.roomName);\r\n    });\r\n    // console.log('maxRow', maxRow);\r\n    let targetRowCenter = parseInt(maxRow / 2);\r\n    if (targetRowCenter < 0) targetRowCenter = 0;\r\n    // console.log('targetRowCenter', targetRowCenter);\r\n    let rows = [];\r\n    for (let i = 0; i < maxRow; i++) {\r\n      let cells = [<MyTableCell key=\"time\" key2=\"time\" align=\"center\" colSpan={1} content={targetRowCenter === i ? data.periodId : null} noBorder={maxRow - 1 !== i}></MyTableCell>,];\r\n      for (let name of roomNameList) {\r\n        // if (!(data.roomMapItemEntry[name] instanceof Array)) {\r\n        if (!(data.roomMapItemEntry[name][i])) {\r\n          // 没这个项的话也要占个位置\r\n          cells.push(<MyTableCell key={data.periodId + name + i + '_'} colSpan={1}></MyTableCell>);\r\n          continue;\r\n        }\r\n        let roomItem = data.roomMapItemEntry[name][i];\r\n        // 价格\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'price'} align=\"center\" colSpan={1} content={'￥' + roomItem.price}></MyTableCell>);\r\n        // 说明\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'desc'} align=\"center\" colSpan={1} content={<Box component=\"div\" className={classes.foodDesc}>\r\n          {roomItem.foodDesc}</Box>}></MyTableCell>);\r\n        // 库存\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'stock'} align=\"center\" colSpan={1} content={i === targetRowCenter ? (roomItem.stock + '间') : ''} noBorder={maxRow - 1 !== i}></MyTableCell>);\r\n        // 计划\r\n        cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'plan'} align=\"center\" colSpan={1} content={\r\n          (() => {\r\n            let planCount = getTargetTasks({ roomItem }).length;\r\n            return (<Link key={data.periodId + name + roomItem.itemId + i + 'planLink'} onClick={planCount === 0 ? () => {\r\n              // console.log('roomItem', roomItem);\r\n              // console.log('data', data);\r\n              let parent = {};\r\n              for (const arg in data)\r\n                if (arg !== 'roomMapItemEntry')\r\n                  parent[arg] = data[arg];\r\n              roomItem.parent = parent;\r\n              // roomItemNow = roomItem;\r\n              setRoomItemNow(roomItem);\r\n              setTaskDialogUpdate(true);\r\n              setDialogAddTaskOpen(true);\r\n            } : () => { setDialogTasksListOpen(getTargetTasks({ roomItem })); }} className={classes.planButton}>计划{planCount > 0 ? (`(${planCount})`) : ''}</Link>);\r\n          })()\r\n        }></MyTableCell>);\r\n        // 临时下线\r\n        // cells.push(<MyTableCell key={data.periodId + name + roomItem.itemId + i + 'off'} align=\"center\" colSpan={1} content={\r\n        //   <Link key={data.periodId + name + roomItem.itemId + i + 'planLink'} onClick={() => {\r\n        //     console.log('roomItem', roomItem);\r\n        //   }} >下线</Link>\r\n        // }></MyTableCell>);\r\n      }\r\n      // console.log('cells', cells);\r\n      rows.push(<TableRow key={data.periodId + i}>{cells}</TableRow>);\r\n    }\r\n    return rows;\r\n  }\r\n\r\n  if (!setUpdateTimer) {\r\n    setUpdateTimer = true;\r\n    // 每分钟更新数据\r\n    setTimeout(() => {\r\n      if (!updateData) return;\r\n      updateData();\r\n    }, 60 * 1000);\r\n  }\r\n\r\n  const updateData = () => {\r\n    // console.log('updating daemon!');\r\n    if (!requestedDayData) {\r\n      requestedDayData = true;\r\n      api.request(\"daemon\", \"POST\", { daemon_args: { reserve_table: { date } } }).then(resp => {\r\n        if (resp.code !== 200) return;\r\n        store.dispatch(setDaemon(resp.data));\r\n        requestedDayData = false;\r\n        forceUpdate();\r\n      });\r\n    } else {\r\n      let reserveTableData = store.getState().daemon.reserve_table[date];\r\n      // console.log('got from redux:', reserveTableData);\r\n      if (reserveTableData) {\r\n        setDayData(reserveTableData);\r\n        setRoomList(reserveTableData.roomList);\r\n        // 也是要请求一遍的\r\n        api.request(\"daemon\", \"POST\", { daemon_args: { reserve_table: { date } } }).then(resp => {\r\n          if (resp.code !== 200) return;\r\n          store.dispatch(setDaemon(resp.data));\r\n          requestedDayData = false;\r\n          forceUpdate();\r\n        });\r\n      } else {\r\n        // console.warn('got empty reserveTableData', dayData, store.getState().daemon.reserve_table, date, JSON.stringify(store.getState().daemon.reserve_table[date]));\r\n      }\r\n    }\r\n  };\r\n\r\n  if (!dayData) {\r\n    updateData();\r\n    return (<Container>\r\n      <LinearProgress></LinearProgress>\r\n    </Container>);\r\n  }\r\n  let tableHeaderCells = [<TableCell key=\"time\" align=\"center\" colSpan={1}>时间</TableCell>,];\r\n  roomList.map((d, i) => {\r\n    tableHeaderCells.push(<TableCell key={'a' + d + i} align=\"center\" colSpan={2}>售卖内容</TableCell>);\r\n    tableHeaderCells.push(<TableCell key={'b' + d + i} align=\"center\" colSpan={1}>库存</TableCell>);\r\n    tableHeaderCells.push(<TableCell key={'c' + d + i} align=\"center\" colSpan={1}>计划</TableCell>);\r\n    // tableHeaderCells.push(<TableCell key={'d' + d + i} align=\"center\" colSpan={1}>临时下线</TableCell>);\r\n  });\r\n  const tableHeader = <TableHead>\r\n    <TableRow>\r\n      <TableCell align=\"center\" colSpan={1}>[{date.slice(date.length - 2, date.length)}日{'周' + [\"日\", '一', '二', '三', '四', '五', '六'][day]}]</TableCell>\r\n      {roomList.map((d, i) =>\r\n        <TableCell align=\"center\" key={i} colSpan={5}>{d.roomName}({d.roomCapacity})</TableCell>\r\n      )}\r\n    </TableRow>\r\n    <TableRow>\r\n      {tableHeaderCells}\r\n    </TableRow>\r\n  </TableHead>;\r\n  if (!dayData || !dayData.periodList) {\r\n    // console.log('no data!', dayData, typeof (dayData));\r\n    return (<Container>\r\n      <header></header>\r\n      <LinearProgress></LinearProgress>\r\n    </Container>);\r\n  }\r\n  // console.log(\"roomItemNow\", roomItemNow);\r\n  return (\r\n    <Container>\r\n      <TableContainer component={Paper}>\r\n        <Table stickyHeader className={classes.table}>\r\n          {tableHeader}\r\n          <TableBody>\r\n            {dayData.periodList.map((d, i) =>\r\n              <Period key={'period' + i} data={d} roomList={roomList}></Period>\r\n            )}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      {TasksListDialog}\r\n      <TaskDialog\r\n        addMode\r\n        targets={{ roomItem: roomItemNow, taskName: (roomItemNow && JSON.stringify(roomItemNow) !== \"{}\") ? `${roomItemNow.roomType}周${weekDayList[new Date().getDay()]}${roomItemNow.parent.periodDesc}` : null }}\r\n        open={dialogAddTaskOpen}\r\n        onRefresh={() => {\r\n          // 更新Task数据\r\n          updateData();\r\n          api.request(\"task\", \"GET\").then(resp => {\r\n            if (resp.code !== 200) {\r\n              store.dispatch(setErrorInfo(resp));\r\n              return;\r\n            }\r\n            store.dispatch(setTasks(resp.data.tasks));\r\n            forceUpdate();\r\n          });\r\n        }}\r\n        onClose={() => { setDialogAddTaskOpen(false); }}\r\n      ></TaskDialog>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default ReserveTable;","import React from 'react'\r\nimport { LinearProgress, Button, Container, Dialog, DialogTitle, IconButton } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport PropTypes from 'prop-types';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Box from '@material-ui/core/Box';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport ReserveTable from './ReserveTable';\r\nimport { weekDayList } from '../utils/utils';\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index, ...other } = props;\r\n\r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`scrollable-auto-tabpanel-${index}`}\r\n      aria-labelledby={`scrollable-auto-tab-${index}`}\r\n      {...other}\r\n    >\r\n      {value === index && (\r\n        <Box>\r\n          {/* <Typography>{children}</Typography> */}\r\n          {children}\r\n        </Box>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nTabPanel.propTypes = {\r\n  children: PropTypes.node,\r\n  index: PropTypes.any.isRequired,\r\n  value: PropTypes.any.isRequired,\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    overflowX: 'auto',\r\n    display: 'block',\r\n    width: '100%',\r\n    flexGrow: 1,\r\n    width: '100%',\r\n    backgroundColor: theme.palette.background.paper,\r\n  },\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 120,\r\n  },\r\n  selectEmpty: {\r\n    marginTop: theme.spacing(2),\r\n  },\r\n}));\r\n\r\nfunction a11yProps(index) {\r\n  return {\r\n    id: `scrollable-auto-tab-${index}`,\r\n    'aria-controls': `scrollable-auto-tabpanel-${index}`,\r\n  };\r\n}\r\n\r\nexport default function ReserveTables(props) {\r\n  const classes = useStyles();\r\n  const [tabValue, setTableValue] = React.useState(new Date().getDay());\r\n  const [showTable, setShowTable] = React.useState(false);\r\n  const [fullShow, setFullShow] = React.useState(false);\r\n  const handleChange = (event) => {\r\n    setTableValue(event.target.value);\r\n  };\r\n  const table = <div className={classes.root}>\r\n    <Tabs\r\n      value={tabValue}\r\n      onChange={(e, val) => setTableValue(val)}\r\n      indicatorColor=\"primary\"\r\n      textColor=\"primary\"\r\n      variant=\"scrollable\"\r\n      scrollButtons=\"auto\"\r\n      aria-label=\"scrollable auto tabs example\"\r\n    >\r\n      {[\"日\", '一', '二', '三', '四', '五', '六'].map((d, i) => {\r\n        return (<Tab label={'周' + d} key={i} {...a11yProps(i)} />);\r\n      })}\r\n    </Tabs>\r\n    {[0, 1, 2, 3, 4, 5, 6].map((d, i) => <TabPanel key={i} value={tabValue} index={d}>\r\n      <ReserveTable day={tabValue}></ReserveTable>\r\n    </TabPanel>)}\r\n  </div>;\r\n  return (\r\n    // <Container className={classes.root}>\r\n    <div>\r\n      <FormControl className={classes.formControl}>\r\n        <InputLabel>选择日期</InputLabel>\r\n        <Select\r\n          value={tabValue}\r\n          onChange={handleChange}\r\n        >\r\n          {weekDayList.map((d, i) => <MenuItem key={i} value={i}>{'周' + d}</MenuItem>)}\r\n        </Select>\r\n      </FormControl>\r\n      <IconButton style={{ float: 'right' }} variant=\"contained\" onClick={() => {\r\n        setShowTable(true);\r\n        setFullShow(true);\r\n      }}><FullscreenIcon /></IconButton>\r\n      { window.innerWidth >= 600 ? table : <Button fullWidth variant=\"contained\" onClick={() => { setShowTable(!showTable); }}>点击{showTable ? \"隐藏\" : \"显示\"}表格</Button>}\r\n      <Dialog fullScreen={fullShow} onClose={() => { setShowTable(false); }} open={showTable}>\r\n        <DialogTitle>\r\n          <Box component=\"span\">周{weekDayList[tabValue]}({new Date().setDay(tabValue).toDateString()})数据</Box>\r\n          {fullShow ? <IconButton edge=\"end\" style={{ float: 'right' }} onClick={() => {\r\n            setFullShow(false);\r\n            setShowTable(false);\r\n          }}><FullscreenExitIcon /></IconButton> : <IconButton style={{ float: 'right' }} variant=\"contained\" onClick={() => {\r\n            setShowTable(true);\r\n            setFullShow(true);\r\n          }}><FullscreenIcon /></IconButton>}</DialogTitle>\r\n        {table}\r\n      </Dialog>\r\n      {/* </Container > */}\r\n    </div>\r\n  );\r\n\r\n}\r\n\r\n","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport ReserveTables from \"../components/ReserveTables\";\r\nimport { Divider, Table, TableBody, TableCell, TableRow, Typography } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\n\r\nclass StateNow extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = store.getState();\r\n    this.unsubscribe = store.subscribe(() => {\r\n      this.setState({\r\n        timetableNodes: store.getState().timetableNodes,\r\n        timetablePeriods: store.getState().timetablePeriods,\r\n        roomStockPlans: store.getState().roomStockPlans\r\n      });\r\n    });\r\n  }\r\n  componentWillUnmount() {\r\n    this.unsubscribe();\r\n  }\r\n  render() {\r\n    return (<Table>\r\n      <TableBody>\r\n        <TableRow>\r\n          <TableCell align=\"center\">任务数量</TableCell>\r\n          <TableCell align=\"center\">LABLE1</TableCell>\r\n          <TableCell align=\"center\">LABLE2</TableCell>\r\n        </TableRow>\r\n        <TableRow>\r\n          <TableCell align=\"center\">{store.getState().tasks.length}个</TableCell>\r\n          <TableCell align=\"center\">VALUE1</TableCell>\r\n          <TableCell align=\"center\">VALUE2</TableCell>\r\n        </TableRow>\r\n      </TableBody>\r\n    </Table>);\r\n  }\r\n}\r\n\r\nfunction Launch() {\r\n  return (<Container style={{ overflowX: 'auto', width: '100%' }}>\r\n    <Typography variant=\"h5\">执行状态</Typography>\r\n    <StateNow></StateNow>\r\n    <br />\r\n    <Typography variant=\"h5\">数据总览</Typography>\r\n    <ReserveTables />\r\n  </Container>);\r\n}\r\n\r\nexport default Launch;","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { funDownload } from \"../utils/utils\";\r\nimport ListInfo from \"../components/ListInfo\";\r\n\r\nfunction Settings(props) {\r\n  const [themeName, setThemeName] = React.useState(store.getState().config.data.theme_name);\r\n  const refConfigFileInput = React.useRef();\r\n  const [resetSettingsOpen, setResetSettingsOpen] = React.useState(false);\r\n  const [deleteDataOpen, setDeleteDataOpen] = React.useState(false);\r\n  const [openDaemon, setOpenDaemon] = React.useState(false);\r\n  const [openUser, setOpenUser] = React.useState(false);\r\n\r\n  const resetSettings = function () {\r\n    let c = store.getState().config;\r\n    c.data = c.data_default;\r\n    c.save();\r\n    c.load();\r\n    store.dispatch(setConfig(c));\r\n  }\r\n\r\n  const user = store.getState().user;\r\n\r\n  return (<Container maxWidth=\"md\">\r\n    <List>\r\n      <ListSubheader>用户账号</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"用户名\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          {user.username}\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenUser(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button>\r\n        <ListItemText primary=\"修改信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>用户门店</ListSubheader>\r\n      <ListItem button onClick={() => { setOpenDaemon(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>外观</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"主题设置\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <FormControl>\r\n            {/* <InputLabel></InputLabel> */}\r\n            <Select value={themeName} onChange={e => {\r\n              setThemeName(e.target.value);\r\n              let c = store.getState().config;\r\n              c.data.theme_name = e.target.value;\r\n              c.theme = c.theme_avaliable[c.data.theme_name];\r\n              c.save();\r\n              store.dispatch(setConfig(c));\r\n              setTimeout(() => { window.location.reload(); }, 200);\r\n            }}>\r\n              {store.getState().config.data.theme_avaliable.map((v, k) => <MenuItem key={k} value={v}>{v}</MenuItem>)}\r\n            </Select>\r\n          </FormControl>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListSubheader>数据管理</ListSubheader>\r\n      <ListItem button onClick={() => {\r\n        funDownload(store.getState().config.save(), `团购杀手配置数据(${new Date().toLocaleString()}).json`);\r\n      }}>\r\n        <ListItemText primary=\"数据导出\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        // console.log(refConfigFileInput)\r\n        refConfigFileInput.current.click();\r\n      }}>\r\n        <ListItemText primary=\"数据导入\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <input type=\"file\" accept=\".json\" hidden name=\"file-gbk-data\" ref={refConfigFileInput} onChange={e => {\r\n            // console.log(e);\r\n            let files = e.target.files;\r\n            if (files.length === 0) {\r\n              store.dispatch(setMessage(\"未选择文件\"));\r\n              return;\r\n            }\r\n            try {\r\n              let file = files[0];\r\n              let reader = new FileReader();\r\n              reader.readAsText(file, 'UTF-8');\r\n              reader.onload = evt => {\r\n                const fileData = evt.target.result;\r\n                try {\r\n                  const js = JSON.parse(fileData);\r\n                  if (!js.version_frontend) {\r\n                    store.dispatch(setMessage(\"文件类型错误或者文件已经损坏\"));\r\n                    return;\r\n                  }\r\n                  if (js.version_frontend > store.getState().config.data.version_frontend) {\r\n                    store.dispatch(setMessage(`存档文件版本(${js.version_frontend}高于当前版本${store.getState().config.data.version_frontend})，请更新到最新版`));\r\n                    return;\r\n                  }\r\n                  let c = store.getState().config;\r\n                  c.data = js;\r\n                  store.dispatch(setConfig(c));\r\n                  store.dispatch(setMessage(\"数据导入完成\"));\r\n                } catch (e) {\r\n                  store.dispatch(setErrorInfo(e));\r\n                }\r\n              };\r\n            } catch (e) {\r\n              store.dispatch(setErrorInfo(e));\r\n            }\r\n          }}></input>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置数据同步\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Switch defaultChecked={store.getState().config.data.settings_async} onChange={e => {\r\n            let c = store.getState().config;\r\n            c.data.settings_async = e.target.checked;\r\n            c.save();\r\n            store.dispatch(setConfig(c));\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setResetSettingsOpen(true)}>\r\n        <ListItemText primary=\"回到默认设置\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setDeleteDataOpen(true)}>\r\n        <ListItemText primary=\"删除所有数据\"></ListItemText>\r\n      </ListItem>\r\n    </List>\r\n    <ListInfo data={store.getState().user} open={openUser} keyNames={{\r\n      username: '用户名', nick: '昵称', phone: '用户手机号', profile: '详细信息', state: '用户状态', created_at: '创建于', updated_at: '更新于'\r\n    }} title=\"用户信息\" onClose={() => { setOpenUser(false); }}></ListInfo>\r\n    <ListInfo data={store.getState().daemon} open={openDaemon} keyNames={{\r\n      cookies: '远程登录凭据', shop_info: \"门店详细信息\", solution_id: \"解决方案编号\"\r\n    }} title=\"门店信息\" onClose={() => { setOpenDaemon(false); }}></ListInfo>\r\n    <Dialog open={resetSettingsOpen} onClose={() => setResetSettingsOpen(false)}>\r\n      <DialogTitle>\r\n        回到默认设置\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除所有设置数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setResetSettingsOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={deleteDataOpen} onClose={() => setDeleteDataOpen(false)}>\r\n      <DialogTitle>\r\n        删除所有数据\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除软件数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setDeleteDataOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  </Container>)\r\n}\r\n\r\nexport default Settings;","import store from \"../data/store\";\r\n\r\n\r\nclass WebSocketAPI {\r\n  constructor(url) {\r\n    this.connect = this.connect.bind(this);\r\n    this.url = url || store.getState().config.data.remote_login.server || \"ws://127.0.0.1:8081\";\r\n    this.ws = null;\r\n    this.onopen = () => {\r\n      console.log('Connection started');\r\n    };\r\n    this.ondata = e => {\r\n      if (e.cmd === 'code') {\r\n        this.oncode(e.data);\r\n      } else if (e.cmd === 'cookies') {\r\n        this.oncookies(e.data);\r\n      }\r\n    };\r\n    this.onmessage = e => {\r\n      // console.log('onmessage', e);\r\n      this.ondata(JSON.parse(e.data));\r\n    };\r\n    this.onerror = e => {\r\n      console.error(e);\r\n    };\r\n    this.onclose = () => {\r\n      console.log('Connection closed');\r\n    };\r\n    this.oncode = code => { console.log('code', code); }\r\n    this.oncookies = cookies => { console.log('cookies', cookies); }\r\n  }\r\n  connect() {\r\n    this.ws = this.ws || new WebSocket(this.url);\r\n    this.ws.onopen = this.onopen;\r\n    this.ws.onclose = this.onclose;\r\n    this.ws.onerror = this.onerror;\r\n    this.ws.onmessage = this.onmessage;\r\n  }\r\n  close() {\r\n    if (this.ws) this.ws.close();\r\n  }\r\n}\r\n\r\nexport { WebSocketAPI };","import { Box, Container, Paper } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { WebSocketAPI } from '../api/remote_login';\r\nimport { setConfig, setDaemon } from '../data/action';\r\nimport store from '../data/store';\r\nconst QRCode = require('qrcode.react');\r\n\r\nfunction CenterBox(props) {\r\n  const { children } = props;\r\n  return <Box style={{ width: '100%', height: '100%', display: \"flex\", justifyContent: \"center\", flexDirection: \"column\" }}><Box style={{ width: '100%', textAlign: \"center\" }}>{children}</Box></Box>;\r\n}\r\n\r\nexport default class RemoteLogin extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      code: null,\r\n      loginDone: false\r\n    };\r\n    this.ws_api = null;\r\n    // this.unsubscribe = store.subscribe(async () => {\r\n    //   if (this.loginDone) return;\r\n    //   let state = store.getState();\r\n    //   if (state.daemon) {\r\n    //     this.setState({ loginDone: true });\r\n    //     if (this.ws_api) this.ws_api.close();\r\n    //   }\r\n    // });\r\n    setTimeout(async () => {\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      const res = await api.request('remote_login', \"PATCH\");\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      const server = res.data.server;\r\n      let config = store.getState().config;\r\n      config.data.remote_login.server = server;\r\n      store.dispatch(setConfig(config));\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      this.ws_api = new WebSocketAPI(server);\r\n      this.ws_api.oncode = code => {\r\n        // console.log('code', code);\r\n        if (store.getState().daemon || this.state.loginDone) return;\r\n        this.setState({ code });\r\n      };\r\n      this.ws_api.oncookies = async cookies => {\r\n        const resp = await api.request('remote_login', \"POST\", { cookies });\r\n        console.log('done', resp);\r\n        if (store.getState().daemon || this.state.loginDone) return;\r\n        this.setState({ loginDone: true });\r\n        const daemon = await api.request('remote_login', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        }\r\n      }\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      this.ws_api.connect();\r\n    }, 1000);\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.ws_api) this.ws_api.close();\r\n    // this.unsubscribe();\r\n  }\r\n  render() {\r\n    let content = null;\r\n    if (this.state.loginDone) {\r\n      content = <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>登录完成</CenterBox>\r\n      </Paper>;\r\n    } else {\r\n      content = this.state.code ? <QRCode value={JSON.stringify(this.state.code)} size={200} /> : <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>正在加载二维码...</CenterBox>\r\n      </Paper>;\r\n    }\r\n    return (<Container>\r\n      {content}\r\n    </Container>);\r\n  }\r\n}","import { Box, Button, Container, Divider, TextField, Typography, Zoom, Fade } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { setMessage, setUser } from '../data/action';\r\nimport store from '../data/store';\r\nimport { objectUpdate } from '../utils/utils';\r\n\r\n\r\nfunction LoginFrame(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    captcha: \"\",\r\n    actionType: 'login'\r\n  });\r\n  const refUsername = React.useRef();\r\n  const refPassword = React.useRef();\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n  // style={{ display: \"flex\", justifyContent: 'center', alignItems: \"center\", flexDirection: \"column\", }}\r\n  const actionLogin = state.actionType === 'login' ? true : false;\r\n  const handleAction = async () => {\r\n    // console.log('handle', actionLogin);\r\n    if (actionLogin) {\r\n      const res = await api.request('session', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code !== 200) return;\r\n      // 获取user\r\n      const user = await api.request('user', 'GET');\r\n      if (user.code !== 200) return;\r\n      console.log('user', user.data.user);\r\n      store.dispatch(setUser(user.data.user));\r\n    } else {\r\n      // 注册，注册成功则跳转登录\r\n      const res = await api.request('user', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code === 200) {\r\n        // 弹窗\r\n        store.dispatch(setMessage(\"注册成功\"));\r\n        setState({actionType: 'login'});\r\n      }\r\n    }\r\n  }\r\n\r\n  return (<Box>\r\n    <Typography variant=\"h4\">{actionLogin ? \"登录\" : \"注册\"}</Typography>\r\n    <br />\r\n    <Divider></Divider>\r\n    <br />\r\n    <TextField fullWidth ref={refUsername} label=\"用户名\" variant=\"outlined\" value={state.username} onChange={e => {\r\n      setState({ username: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        refPassword.current.querySelector(\"input\").focus();\r\n      }\r\n    }} />\r\n    <br /><br />\r\n    <TextField fullWidth ref={refPassword} label=\"密码\" variant=\"outlined\" value={state.password} type=\"password\" onChange={e => {\r\n      setState({ password: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        handleAction();\r\n      }\r\n    }} />\r\n    <Fade in={actionLogin} style={{ display: actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>登录</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => setState({ actionType: \"sign_in\" })}>注册</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n    <Fade in={!actionLogin} style={{ display: !actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>注册</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" onClick={() => setState({ actionType: 'login' })}>返回登录</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n  </Box >);\r\n}\r\n\r\nexport default function Login(props) {\r\n  return <Container maxWidth=\"sm\">\r\n    <LoginFrame></LoginFrame>\r\n  </Container>\r\n}","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions, FormControlLabel, Checkbox, Divider, Box, Grid, TextField, IconButton } from \"@material-ui/core\";\r\nimport { Table, TableBody, TableCell, TableRow } from \"@material-ui/core\";\r\nimport HelpOutlineIcon from '@material-ui/icons/HelpOutline';\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { api } from \"../api/api\";\r\n\r\nfunction Predicts(props) {\r\n  const [useSpan, setUseSpan] = React.useState(false);\r\n  const [openHelp, setOpenHelp] = React.useState(false);\r\n  const labels = ['小包最低价', '小包最高价', '中包最低价', '中包最高价', '大包最低价', '大包最高价'];\r\n  const labelShows = { '小包最低价': '小包(闲时)', '小包最高价': '小包(黄金时段)', '中包最低价': '中包(闲时)', '中包最高价': '中包(黄金时段)', '大包最低价': '大包(闲时)', '大包最高价': '大包(黄金时段)' };\r\n  const [predictsResult, setPredictsResult] = React.useState(null);\r\n  const defaultValues = [\r\n    ['66', '76'], ['76', '86'], ['86', '96'], ['96', '106'], ['116', '126'], ['126', '146']\r\n  ]\r\n  const labelsTemp = labels.map((v, k) => {\r\n    return { [v]: defaultValues[k] };\r\n  });\r\n  const labelValues = ((() => {\r\n    let temp = {};\r\n    for (const item of labelsTemp)\r\n      for (const k in item)\r\n        temp[k] = item[k];\r\n    return temp;\r\n  })());\r\n  // console.log(labelValues);\r\n  const [inputValues, setInputValues] = React.useState(labelValues);\r\n  const getTempValues = () => {\r\n    let tempValues = {};\r\n    for (const k in inputValues) tempValues[k] = inputValues[k];\r\n    return tempValues;\r\n  }\r\n\r\n  const items = labels.map((v, k) => {\r\n    return useSpan ?\r\n      <ListItem key={k}>\r\n        <ListItemText primary={labelShows[v]}></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Box>\r\n            <TextField inputProps={{ style: { textAlign: \"center\" } }} value={inputValues[v][0]} onChange={e => {\r\n              let tmp = getTempValues();\r\n              tmp[v][0] = e.target.value;\r\n              setInputValues(tmp);\r\n            }}></TextField>~\r\n            <TextField inputProps={{ style: { textAlign: \"center\" } }} value={inputValues[v][1]} onChange={e => {\r\n              let tmp = getTempValues();\r\n              tmp[v][1] = e.target.value;\r\n              setInputValues(tmp);\r\n            }}></TextField>\r\n          </Box>\r\n        </ListItemSecondaryAction>\r\n      </ListItem> :\r\n      <ListItem key={k}>\r\n        <ListItemText primary={labelShows[v]}></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <TextField inputProps={{ style: { textAlign: \"center\" } }} fullWidth value={inputValues[v][0]} onChange={e => {\r\n            let tmp = getTempValues();\r\n            tmp[v][0] = e.target.value;\r\n            setInputValues(tmp);\r\n          }}></TextField>\r\n        </ListItemSecondaryAction>\r\n      </ListItem >;\r\n  });\r\n  const content = <List>\r\n    {items}\r\n  </List>;\r\n  const handlePredicts = () => {\r\n    // 检查数据\r\n    let tempValues = getTempValues();\r\n    if (!useSpan)\r\n      for (const k in tempValues)\r\n        tempValues[k] = [tempValues[k][0],]\r\n    for (const k in tempValues) {\r\n      for (let i = 0; i < tempValues[k].length; i++) {\r\n        let val = null;\r\n        try {\r\n          val = parseFloat(tempValues[k][i]);\r\n        } catch (e) {\r\n          store.dispatch(setErrorInfo(`数值错误: ${tempValues[k][i]}, ${e}`));\r\n          return;\r\n        }\r\n        if (!val && val !== 0) {\r\n          store.dispatch(setErrorInfo(`数值错误: ${tempValues[k][i]}`));\r\n          return;\r\n        }\r\n        tempValues[k][i] = val;\r\n      }\r\n    }\r\n    console.log(JSON.stringify(tempValues));\r\n    // api.predicts(tempValues).then(d => {\r\n    //   console.log(d);\r\n    //   setPredictsResult(d.data);\r\n    // });\r\n    api.request(\"predicts\", 'POST', { predict_data: tempValues }).then(d => {\r\n      console.log(d);\r\n      setPredictsResult(d.data);\r\n    });\r\n  };\r\n  const result = !predictsResult ? null : <Table>\r\n    <TableBody>\r\n      {useSpan ? <TableRow>\r\n        <TableCell align=\"center\" colSpan={2}>预测曝光人数</TableCell>\r\n        <TableCell align=\"center\" colSpan={2}>预测访问人数</TableCell>\r\n        <TableCell align=\"center\" colSpan={2}>预测下单人数</TableCell>\r\n      </TableRow> : <TableRow>\r\n        <TableCell align=\"center\">预测曝光人数</TableCell>\r\n        <TableCell align=\"center\">预测访问人数</TableCell>\r\n        <TableCell align=\"center\">预测下单人数</TableCell>\r\n      </TableRow>}\r\n      {useSpan ? <TableRow>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visible'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visible'][1])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visit'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visit'][1])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['order'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['order'][1])}</TableCell>\r\n      </TableRow> : <TableRow>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visible'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visit'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['order'][0])}</TableCell>\r\n      </TableRow>}\r\n    </TableBody>\r\n  </Table>;\r\n  return (<Container maxWidth=\"sm\">\r\n    <Typography variant=\"h4\">根据标准数据集预测</Typography>\r\n    <Box>\r\n      <FormControlLabel control={<Checkbox onChange={e => {\r\n        setUseSpan(e.target.checked);\r\n        setPredictsResult(null);\r\n      }} checked={useSpan} color=\"secondary\" />} label=\"使用数据区间\" />\r\n      <IconButton onClick={() => setOpenHelp(true)}>\r\n        <HelpOutlineIcon></HelpOutlineIcon>\r\n      </IconButton>\r\n    </Box>\r\n    <Divider></Divider>\r\n    {content}\r\n    <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={handlePredicts}>预测</Button>\r\n    <Divider></Divider>\r\n    {result}\r\n    <Dialog open={openHelp} onClose={() => { setOpenHelp(false); }}>\r\n      <DialogTitle>帮助信息</DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"h6\">使用数据区间</Typography>\r\n        <Typography variant=\"body1\">使用数据区间可以输入数据上下限，并且预测出对应参数的上下限，帮助您更好地界定您的数据。</Typography>\r\n        <Typography variant=\"h6\">价格说明</Typography>\r\n        <Typography variant=\"body1\">“黄金时段”价格为节假日、夜间等适合高定价的时段，“闲时”为除此之外的时段。输入价格为不加入酒水等的基础价格。</Typography>\r\n        <Typography variant=\"h6\">预测结果说明</Typography>\r\n        <Typography variant=\"body1\">预测结果基于当前已有数据集数据，预测准确性不能百分百保证。更新数据集等功能将在后续版本上线。</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button color=\"primary\" onClick={() => { setOpenHelp(false); }}>了解</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  </Container>)\r\n}\r\n\r\nexport default Predicts;","import React from 'react';\r\nimport \"@fontsource/roboto\";\r\nimport clsx from 'clsx';\r\nimport Container from '@material-ui/core/Container';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport EqualizerIcon from '@material-ui/icons/Equalizer';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport AssignmentIcon from '@material-ui/icons/Assignment';\r\nimport AlarmIcon from '@material-ui/icons/Alarm';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport StorageIcon from '@material-ui/icons/Storage';\r\nimport VerifiedUserIcon from '@material-ui/icons/VerifiedUser';\r\nimport PhonelinkIcon from '@material-ui/icons/Phonelink';\r\nimport {\r\n  HashRouter as Router,\r\n  // BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\r\nimport { Provider } from 'react-redux'\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport store from './data/store';\r\nimport { setConfig, setDaemon, setErrorInfo, setMessage, setReserveTableData, setRoomStockData, setShopInfo } from \"./data/action\";\r\n\r\nimport { isIterator, isMobileDevice, sleep } from \"./utils/utils\";\r\nimport { api } from \"./api/api\";\r\n\r\nimport ListItemLink from \"./components/ListItemLink\";\r\nimport Launch from \"./pages/Launch\";\r\nimport Settings from \"./pages/Settings\";\r\nimport './App.css';\r\nimport { Box, Button, Dialog, DialogActions, DialogContent, DialogTitle, ListItem, Snackbar } from '@material-ui/core';\r\nimport RemoteLogin from './pages/RemoteLogin';\r\nimport Login from './pages/Login';\r\nimport Tasks from \"./pages/Tasks\";\r\nimport Predicts from './pages/Predicts';\r\n\r\nconst drawerWidth = 240;\r\nmoment.locale('zh-cn');\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n    width: '100%',\r\n    // overflowX: 'auto',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  hide: {\r\n    display: 'none',\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    flexShrink: 0,\r\n    whiteSpace: 'nowrap',\r\n  },\r\n  drawerOpen: {\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerClose: {\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n    width: theme.spacing(7) + 1,\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  toolbar: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // necessary for content to be below app bar\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3),\r\n    width: '100%',\r\n    overflowX: 'auto',\r\n  },\r\n}));\r\n\r\n// const api = new API();\r\n// const authApi = new AuthAPI();\r\n// api.get_shop_info().then(shopInfo => {\r\n//   console.log('shopInfo', shopInfo);\r\n//   if (shopInfo) store.dispatch(setShopInfo(shopInfo));\r\n// }).catch(e => {\r\n//   store.dispatch(setErrorInfo(e));\r\n// })\r\n\r\nlet subscribers = {};\r\n\r\nlet last_data = {\r\n  config: null,\r\n  user: null,\r\n  daemon: null\r\n};\r\n\r\nstore.subscribe(async () => {\r\n  let state = store.getState();\r\n  // console.log('redux update to', state);\r\n  // 保存 config\r\n  if (state.config.data) {\r\n    if (JSON.stringify(state.config.data) !== JSON.stringify(last_data.config)) {\r\n      // console.log('Config will change:', state.config.data);\r\n      state.config.save();\r\n      if (store.getState().user && store.getState().config.data.settings_async) {\r\n        await api.request('sync', 'POST', { config: state.config.data });\r\n      }\r\n    } else {\r\n      // console.log('Not change:', state.config.data);\r\n    }\r\n    last_data.config = state.config.data;\r\n  }\r\n  for (let subFunc in subscribers) {\r\n    subscribers[subFunc](state);\r\n  }\r\n});\r\n\r\nconst getShopTitle = function () {\r\n  if (!(store.getState().daemon && store.getState().daemon.shop_info && store.getState().daemon.shop_info.shopName)) return null;\r\n  // console.log('getShopTitle', store.getState().daemon.shop_info);\r\n  const title = `${store.getState().daemon.shop_info.shopName} - ${store.getState().daemon.shop_info.branchName}`;\r\n  // console.log(title);\r\n  return title;\r\n}\r\n\r\nexport default function App() {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [popupLogin, setPopupLogin] = React.useState(false);\r\n  const [errorDialogInfo, setErrorDialogInfo] = React.useState(false);\r\n  const [myMessage, setMyMessage] = React.useState(null);\r\n  const [hasLogin, setHasLogin] = React.useState(false);\r\n  const titleDefault = \"团购杀手 - KTV体验版\";\r\n  const [title, setTitle] = React.useState(getShopTitle() || titleDefault);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n\r\n  // 拉大到800会打开，拉小到600关闭\r\n  const triggerWidthOpen = 800;\r\n  const triggerWidthClose = 600;\r\n\r\n  // 注册一个当遇到错误的时候调用的钩子吧，用来显示错误信息\r\n  subscribers['Error'] = function (state) {\r\n    if (state.errorInfo) {\r\n      console.log('Error Hook: ', state.errorInfo);\r\n      setErrorDialogInfo(state.errorInfo);\r\n      // 清空错误信息\r\n      store.dispatch(setErrorInfo(null));\r\n    }\r\n  };\r\n  // 注册一个消息钩子\r\n  subscribers['Message'] = function (state) {\r\n    if (state.message) {\r\n      console.log('message: ', state.message);\r\n      setMyMessage(state.message);\r\n      store.dispatch(setMessage(null));\r\n    }\r\n  };\r\n  subscribers['User'] = async function (state) {\r\n    if (state.user) {\r\n      if (JSON.stringify(state.user) != JSON.stringify(last_data.user)) {\r\n        forceUpdate();\r\n        // 登录信息完成，触发获取daemon\r\n        // if (!last_data.user) \r\n        if (!last_data.user) {\r\n          // store.dispatch(setDaemon(false));\r\n          // console.log('trigger');\r\n        }\r\n      }\r\n      last_data.user = state.user;\r\n    }\r\n  };\r\n  subscribers['Daemon'] = async function (state) {\r\n    if (state.daemon) {\r\n      if (JSON.stringify(state.daemon) != JSON.stringify(last_data.daemon)) {\r\n        forceUpdate();\r\n      }\r\n      last_data.daemon = state.daemon;\r\n      if (state.daemon.shop_info) {\r\n        if (title === titleDefault) {\r\n          setTitle(getShopTitle());\r\n        }\r\n      }\r\n    }\r\n    // if (state.daemon === false) {\r\n    //   store.dispatch(setDaemon(null));\r\n    //   const daemon = await api.request('daemon', 'GET');\r\n    //   if (daemon.code === 200 && daemon.data.uid) {\r\n    //     store.dispatch(setDaemon(daemon.data));\r\n    //   } else store.dispatch(setDaemon(null));\r\n    // }\r\n  };\r\n  // onMount & onUpdate\r\n  React.useEffect(() => {\r\n    const onWindowResize = () => {\r\n      let width = window.innerWidth;\r\n      // console.log(width);\r\n      if (!open && width >= triggerWidthOpen) setOpen(true);\r\n      if (open && width <= triggerWidthClose) setOpen(false);\r\n    };\r\n    window.addEventListener(\"load\", onWindowResize);\r\n    window.addEventListener('resize', onWindowResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"load\", onWindowResize);\r\n      window.removeEventListener(\"resize\", onWindowResize);\r\n    };\r\n  });\r\n\r\n\r\n  const handleClickAction = () => {\r\n    if (window.innerWidth < 600 || window.location.pathname === '/') {\r\n      setOpen(false);\r\n    }\r\n  };\r\n\r\n  const mainContent = <Router>\r\n    <MuiPickersUtilsProvider utils={MomentUtils} locale=\"zh-cn\">\r\n      <CssBaseline />\r\n      <AppBar\r\n        position=\"fixed\"\r\n        className={clsx(classes.appBar, {\r\n          [classes.appBarShift]: open,\r\n        })}\r\n      >\r\n        <Toolbar>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={() => { setOpen(true); }}\r\n            edge=\"start\"\r\n            className={clsx(classes.menuButton, {\r\n              [classes.hide]: open,\r\n            })}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" noWrap className={classes.title}>\r\n            {title}\r\n          </Typography>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"login\"\r\n            onClick={() => { setPopupLogin(true); }}\r\n          >\r\n            <AccountCircleIcon />\r\n          </IconButton>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        className={clsx(classes.drawer, {\r\n          [classes.drawerOpen]: open,\r\n          [classes.drawerClose]: !open,\r\n        })}\r\n        classes={{\r\n          paper: clsx({\r\n            [classes.drawerOpen]: open,\r\n            [classes.drawerClose]: !open,\r\n          }),\r\n        }}\r\n      >\r\n        <div className={classes.toolbar}>\r\n          <IconButton onClick={() => { setOpen(false); }}>\r\n            {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List onClick={handleClickAction}>\r\n          <ListItemLink to=\"/\" primary=\"启动页\" icon={<DashboardIcon />} />\r\n          <ListItemLink to=\"/tasks\" primary=\"任务\" icon={<AssignmentIcon />} />\r\n          <ListItemLink to=\"/predicts\" primary=\"智能预测\" icon={<EqualizerIcon />} />\r\n          <ListItemLink to=\"/settings\" primary=\"设置\" icon={<SettingsIcon />} />\r\n        </List>\r\n      </Drawer>\r\n      <main className={classes.content}>\r\n        <div className={classes.toolbar} />\r\n        <Switch>\r\n          <Route path={\"/\"} exact={true}>\r\n            <Launch />\r\n          </Route>\r\n          <Route path={\"/tasks\"} exact={true}>\r\n            <Tasks />\r\n          </Route>\r\n          <Route path={\"/predicts\"} exact={true}>\r\n            <Predicts />\r\n          </Route>\r\n          <Route path={\"/settings\"} exact={false}>\r\n            <Settings />\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n    </MuiPickersUtilsProvider>\r\n  </Router>;\r\n\r\n  const user = store.getState().user;\r\n  const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n  let content = isNowLogining ? <Box>正在登录...</Box> : (user ? mainContent : <Login></Login>);\r\n  if ((!isNowLogining && user) && !store.getState().daemon) {\r\n    content = <RemoteLogin></RemoteLogin>\r\n  }\r\n  // console.log('app.js user', user, 'content', content);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <ThemeProvider theme={store.getState().config.theme}>\r\n        {content}\r\n        <Dialog open={errorDialogInfo ? true : false} onClose={() => { setErrorDialogInfo(null); }}>\r\n          <DialogTitle>遇到错误</DialogTitle>\r\n          <DialogContent>\r\n            <Typography variant=\"body1\">错误信息</Typography>\r\n            <Box component=\"div\">\r\n              <Box component=\"div\">\r\n                {() => {\r\n                  if (isIterator(errorDialogInfo) && typeof (errorDialogInfo) !== 'string') {\r\n                    return <List>\r\n                      {errorDialogInfo.map((d, i) => <ListItem key={i}>\r\n                        <code>{JSON.stringify(d) === '{}' ? d.toString() : JSON.stringify(d)}</code>\r\n                      </ListItem>)}\r\n                    </List>;\r\n                  } else {\r\n                    return <code>{JSON.stringify(errorDialogInfo) === '{}' ? errorDialogInfo.toString() : JSON.stringify(errorDialogInfo)}</code>;\r\n                  }\r\n                }}\r\n              </Box>\r\n            </Box>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button color=\"primary\" onClick={() => { window.location.reload() }}>刷新</Button>\r\n            <Button color=\"primary\" onClick={() => { setErrorDialogInfo(null); }}>取消</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        <Snackbar\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'right',\r\n          }}\r\n          open={myMessage !== null}\r\n          autoHideDuration={6000}\r\n          // onClose={(e) => { console.log(e); }}\r\n          message={myMessage}\r\n          action={\r\n            <React.Fragment>\r\n              <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={() => setMyMessage(null)}>\r\n                <CloseIcon fontSize=\"small\" />\r\n              </IconButton>\r\n            </React.Fragment>\r\n          }\r\n        />\r\n      </ThemeProvider>\r\n    </div >\r\n  );\r\n}\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from './data/store';\r\nimport { Provider } from 'react-redux';\r\nimport { api } from './api/api';\r\nimport { setConfig, setDaemon, setErrorInfo, setRoomStockPlans, setTimetableNodes, setTimetablePeriods, setUser } from './data/action';\r\nimport { sleep } from './utils/utils';\r\n\r\n// 循环执行函数\r\nasync function cycleFunc(cycle = 1000) {\r\n  while (true) {\r\n    try {\r\n\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    await sleep(cycle);\r\n  }\r\n}\r\n\r\n// 开始执行的函数\r\nasync function startFunc() {\r\n  setTimeout(async () => {\r\n    const user = store.getState().user;\r\n    const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n    if (isNowLogining) {\r\n      api.load_from_config();\r\n      const res = await api.request('user', 'GET');\r\n      // console.log('index res', res)\r\n      if (res.code === 200) {\r\n        // console.log('saving user', res.data.user)\r\n        store.dispatch(setUser(res.data.user));\r\n        const daemon = await api.request('daemon', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        } else store.dispatch(setDaemon(null));\r\n      }\r\n    }\r\n    // let c = api.download_config();\r\n    // if (!c.settings_async) return;\r\n    // const config_frontend = await api.download_config();\r\n    // if (!config_frontend) {\r\n    //   store.dispatch(setErrorInfo(\"同步设置失败\"));\r\n    // }\r\n    // else store.dispatch(setConfig(config_frontend));\r\n  }, 0);\r\n}\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\nstartFunc().then(() => {\r\n  cycleFunc();\r\n});\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}