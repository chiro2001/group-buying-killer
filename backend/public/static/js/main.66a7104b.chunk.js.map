{"version":3,"sources":["utils/utils.js","data/action.js","api/api.js","data/reducers.js","Config.js","data/store.js","components/ListItemLink.js","components/ListEdit.js","components/ListInfo.js","components/Actions.js","components/Triggers.js","pages/Launch.js","pages/Settings.js","api/remote_login.js","pages/RemoteLogin.js","pages/Login.js","pages/Tasks.js","App.js","reportWebVitals.js","index.js"],"names":["sleep","time_ms","Promise","accept","setTimeout","isIterator","obj","Symbol","iterator","deepCopy","data","undefined","d","i","length","push","k","objectUpdate","origin","update","now","isObjectValueEqual","a","b","aProps","Object","getOwnPropertyNames","bProps","propName","propA","propB","hasOwnProperty","Date","prototype","setDay","day","day_","this","getDay","setTime","getTime","toDateString","toISOString","slice","timedeltaUnits","getTimedeltaString","timedelta","unit","keys","getTimedeltaUnit","toFixed","setConfig","dispatch","type","setUser","setDaemon","setErrorInfo","setMessage","updateTypes","typeData","store","getState","types","api","host","window","location","href","includes","port","api_version","api_prefix","protocol","url","access_token","refresh_token","router","key","method","request","config","api_token","get_token","console","log","set_token","refresh","access","headers","payload","mode","body","JSON","stringify","get_headers","Boolean","fetch","resp","js","json","error","code","status","statusText","message","resp2","js2","update_config","res","user","defaultState","ITEM_NAME","load","bind","save","theme_avaliable","createMuiTheme","palette","primary","main","blueGrey","secondary","grey","data_default","debug","version_frontend","theme_name","settings_async","remote_login","server","theme","parse","localStorage","getItem","Error","e","warn","s","setItem","tasks","daemon","errorInfo","combineReducers","state","action","createStore","reducers","applyMiddleware","thunk","ListItemLink","props","icon","to","renderLink","React","useMemo","forwardRef","itemProps","ref","ListItem","button","component","ListItemIcon","ListItemText","ListEdit","defaultValue","open","onClose","title","keyNames","dataType","typeName","dismiss","onSave","useState","setInnerData","setData","openChild","setOpenChild","child","setChild","childTitle","setChildTitle","timedeltaUnit","setTimedeltaUnit","Dialog","fullWidth","DialogTitle","DialogContent","List","style","width","map","v","indexOf","args","editable","showName","value","onClick","actionData","startsWith","Button","Box","DateTimePicker","onChange","moment","format","IconButton","val","TextField","parseFloat","target","isNaN","newValue","Select","MenuItem","ListItemSecondaryAction","DialogActions","color","height","display","justifyContent","Typography","variant","ListInfo","isActionModified","item","getDataString","calendar","ActionTag","selectMode","dialogOpen","setDialogOpen","toUse","setToUse","handleCloseDialog","handleClick","newAction","Card","minWidth","margin","CardContent","name","desc","newData","CardActions","Actions","requesting","setRequesting","useReducer","x","forceUpdate","actions","then","content","flexDirection","flexWrap","action_type","isTriggerModified","TriggerTag","trigger","newTrigger","Triggers","triggers","trigger_type","Launch","Container","useActions","Settings","themeName","setThemeName","refConfigFileInput","useRef","resetSettingsOpen","setResetSettingsOpen","deleteDataOpen","setDeleteDataOpen","openDaemon","setOpenDaemon","openUser","setOpenUser","resetSettings","c","maxWidth","ListSubheader","username","FormControl","reload","filename","eleLink","document","createElement","download","blob","Blob","URL","createObjectURL","appendChild","click","removeChild","funDownload","toLocaleString","current","hidden","files","file","reader","FileReader","readAsText","onload","evt","fileData","result","Switch","defaultChecked","checked","nick","phone","profile","created_at","updated_at","cookies","shop_info","solution_id","WebSocketAPI","connect","ws","onopen","ondata","cmd","oncode","oncookies","onmessage","onerror","onclose","WebSocket","close","QRCode","require","CenterBox","children","textAlign","RemoteLogin","loginDone","ws_api","setState","uid","Paper","size","Component","LoginFrame","password","captcha","actionType","setInnerState","refUsername","refPassword","actionLogin","handleAction","Divider","label","onKeyDown","querySelector","focus","Fade","in","timeout","exit","enter","Login","TaskTag","task","Tasks","dialogAddTaskOpen","dialogAddTriggerOpen","dialogAddActionOpen","dialogUpdateTrigger","taskName","task_data","tid","taskData","handleAddTask","task_name","dialogAddTask","newTriggers","splice","newActions","Grid","container","spacing","xs","lg","disabled","sm","drawerWidth","locale","useStyles","makeStyles","root","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","flexGrow","appBarShift","marginLeft","enteringScreen","menuButton","marginRight","hide","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","breakpoints","up","toolbar","alignItems","padding","mixins","subscribers","last_data","subscribe","subFunc","getShopTitle","shopName","branchName","App","classes","useTheme","setOpen","setPopupLogin","errorDialogInfo","setErrorDialogInfo","myMessage","setMyMessage","titleDefault","setTitle","useEffect","onWindowResize","innerWidth","addEventListener","removeEventListener","mainContent","utils","MomentUtils","CssBaseline","AppBar","position","className","clsx","Toolbar","aria-label","edge","noWrap","Drawer","paper","direction","pathname","path","exact","isNowLogining","ThemeProvider","toString","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Fragment","fontSize","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","cycle","load_from_config","ReactDOM","render","getElementById","startFunc","cycleFunc"],"mappings":"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","file":"static/js/main.66a7104b.chunk.js","sourcesContent":["import moment from 'moment';\r\nimport 'moment/locale/zh-cn'\r\n\r\nexport function isMobileDevice() {\r\n  const sUserAgent = navigator.userAgent;\r\n  return (sUserAgent.indexOf('Android') > -1 || sUserAgent.indexOf('iPhone') > -1 || sUserAgent.indexOf('iPad') > -1 || sUserAgent.indexOf('iPod') > -1 || sUserAgent.indexOf('Symbian') > -1);\r\n}\r\n\r\n/** \r\n* param 将要转为URL参数字符串的对象 \r\n* key URL参数字符串的前缀 \r\n* encode true/false 是否进行URL编码,默认为true \r\n*  \r\n* return URL参数字符串 \r\n*/\r\nexport function urlEncode(param, key, encode) {\r\n  if (param == null) return '';\r\n  var paramStr = '';\r\n  var t = typeof (param);\r\n  if (t === 'string' || t === 'number' || t === 'boolean') {\r\n    paramStr += '&' + key + '=' + ((encode == null || encode) ? encodeURIComponent(param) : param);\r\n  } else {\r\n    for (var i in param) {\r\n      var k = key == null ? i : key + (param instanceof Array ? '[' + i + ']' : '.' + i);\r\n      paramStr += urlEncode(param[i], k, encode);\r\n    }\r\n  }\r\n  return paramStr;\r\n};\r\n\r\nexport function urlEncode2(obj) {\r\n  try {\r\n    return JSON.stringify(obj).replace(/:/g, \"=\").replace(/\"/g, '').replace(/,/g, '&').match(/\\{([^)]*)\\}/)[1];\r\n  } catch (e) {\r\n    console.error(e);\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function parseTimePoint(time) {\r\n  return moment(time).format('LLLL');\r\n}\r\n\r\nexport function parseTimePeriod(time) {\r\n  return moment.duration(time).humanize();\r\n}\r\n\r\nexport function getTextFieldValue(el) {\r\n  return el.current.childNodes[el.current.childElementCount - 1].childNodes[0].value;\r\n}\r\n\r\nexport function sleep(time_ms) {\r\n  return new Promise(accept => {\r\n    setTimeout(accept, time_ms);\r\n  });\r\n}\r\n\r\n// 设置到本周的星期几\r\nDate.prototype.setDay = function (day) {\r\n  let day_ = this.getDay();\r\n  if (day_ === day) return this;\r\n  this.setTime(this.getTime() + 1000 * 60 * 60 * 24 * (day - day_));\r\n  return this;\r\n};\r\n\r\n// 获取 YYYY-MM-DD 格式\r\nDate.prototype.toDateString = function () {\r\n  return this.toISOString().slice(0, 10);\r\n};\r\n\r\n// export function cutString(str, length=10)\r\n\r\nexport function isIterator(obj) {\r\n  return obj != null && typeof obj[Symbol.iterator] === 'function';\r\n}\r\n\r\n// 下载文件方法\r\nexport function funDownload(content, filename) {\r\n  var eleLink = document.createElement('a');\r\n  eleLink.download = filename;\r\n  eleLink.style.display = 'none';\r\n  // 字符内容转变成blob地址\r\n  var blob = new Blob([content]);\r\n  eleLink.href = URL.createObjectURL(blob);\r\n  // 触发点击\r\n  document.body.appendChild(eleLink);\r\n  eleLink.click();\r\n  // 然后移除\r\n  document.body.removeChild(eleLink);\r\n};\r\n\r\n\r\nexport function deepCopy(data) {\r\n  if (data === null || data === undefined) {\r\n    return data;\r\n  } if (isIterator(data) && typeof (data) !== \"string\") {\r\n    let d = [];\r\n    for (let i = 0; i < data.length; i++) {\r\n      d.push(data[i]);\r\n    }\r\n    return d;\r\n  } else if (typeof (data) === \"object\") {\r\n    let d = {};\r\n    for (const k in data) {\r\n      d[k] = deepCopy(data[k]);\r\n    }\r\n    return d;\r\n  } else {\r\n    return data;\r\n  }\r\n}\r\n\r\nexport function objectUpdate(origin, update) {\r\n  let now = deepCopy(origin);\r\n  for (const k in update) {\r\n    now[k] = update[k];\r\n  }\r\n  return now;\r\n}\r\n\r\n// https://www.jianshu.com/p/7407bd65b15d\r\nexport function isObjectValueEqual(a, b) {\r\n  var aProps = Object.getOwnPropertyNames(a);\r\n  var bProps = Object.getOwnPropertyNames(b);\r\n  if (aProps.length !== bProps.length) {\r\n    return false;\r\n  }\r\n  for (var i = 0; i < aProps.length; i++) {\r\n    var propName = aProps[i]\r\n\r\n    var propA = a[propName]\r\n    var propB = b[propName]\r\n    // 2020-11-18更新，这里忽略了值为undefined的情况\r\n    // 故先判断两边都有相同键名\r\n    if (!b.hasOwnProperty(propName)) return false\r\n    if ((propA instanceof Object)) {\r\n      if (isObjectValueEqual(propA, propB)) {\r\n        // return true     这里不能return ,后面的对象还没判断\r\n      } else {\r\n        return false\r\n      }\r\n    } else if (propA !== propB) {\r\n      return false\r\n    } else { }\r\n  }\r\n  return true\r\n}\r\n\r\n// Array.prototype.indexOf = function (val) {\r\n//   for (var i = 0; i < this.length; i++) {\r\n//     if (this[i] == val) return i;\r\n//   }\r\n//   return -1;\r\n// };\r\n\r\n// Array.prototype.remove = function (val) {\r\n//   var index = this.indexOf(val);\r\n//   if (index > -1) {\r\n//     this.splice(index, 1);\r\n//   }\r\n// };\r\n\r\n// Array.prototype.removeIndex = function (index) {\r\n//   this.splice(index, 1);\r\n// };\r\n\r\n// export function arrayRemove(array, data) {\r\n//   if (!isIterator(array)) return;\r\n//   const index = array.indexOf(data);\r\n//   if (index > -1) {\r\n//     array.slice(index, 1);\r\n//   }\r\n// }\r\n\r\nexport const timedeltaUnits = {\r\n  \"秒\": 1, \"分\": 60, \"时\": 60 * 60,\r\n  \"天\": 24 * 60 * 60, \"周\": 7 * 24 * 60 * 60\r\n};\r\n\r\n\r\nexport function getTimedeltaUnit(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return null;\r\n  if (timedelta >= timedeltaUnits[Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]])\r\n    return Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n  for (let i = 1; i < Object.keys(timedeltaUnits).length; i++) {\r\n    if (timedelta < timedeltaUnits[Object.keys(timedeltaUnits)[i]]) {\r\n      return Object.keys(timedeltaUnits)[i - 1];\r\n    }\r\n  }\r\n  return Object.keys(timedeltaUnits)[0];\r\n}\r\n\r\nexport function getTimedeltaString(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return \"\";\r\n  const unit = getTimedeltaUnit(timedelta);\r\n  if (unit === null) return \"\";\r\n  // console.log(\"unit\", unit);\r\n  return `${(timedelta / timedeltaUnits[unit]).toFixed(2)}${unit}`;\r\n}\r\n","import { objectUpdate } from \"../utils/utils\";\r\nimport store from \"./store\";\r\n\r\nexport function setConfig(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_CONFIG\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTasks(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TASKS\", data: data });\r\n  };\r\n}\r\n\r\nexport function setUser(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_USER\", data: data });\r\n  };\r\n}\r\n\r\nexport function setDaemon(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_DAEMON\", data: data });\r\n  };\r\n}\r\n\r\nexport function setErrorInfo(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ERROR_INFO\", data: data });\r\n  };\r\n}\r\n\r\nexport function setMessage(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_MESSAGE\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTypes(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TYPES\", data: data });\r\n  };\r\n}\r\n\r\n\r\nexport function updateTypes(type, typeData) {\r\n  return setTypes(objectUpdate(store.getState().types, { [type]: typeData }));\r\n}\r\n","import { setConfig, setErrorInfo, setUser } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { isIterator, urlEncode } from \"../utils/utils\"\r\n\r\n\r\n\r\nclass API {\r\n  constructor() {\r\n    // this.host = '127.0.0.1';\r\n    this.host = window.location.href.includes(\"localhost\") ? \"localhost\" : null;\r\n    // this.port = 8080;\r\n    this.port = 8880;\r\n    this.api_version = \"v2\";\r\n    this.api_prefix = `/api/${this.api_version}`;\r\n    this.protocol = 'http'\r\n    this.url = this.host ? `${this.protocol}://${this.host}:${this.port}${this.api_prefix}` : `${this.api_prefix}`;\r\n    this.access_token = '';\r\n    this.refresh_token = '';\r\n  }\r\n  set_token(access_token, refresh_token) {\r\n    // this.access_token = access_token || this.access_token;\r\n    // this.refresh_token = refresh_token || this.refresh_token;\r\n    if (access_token !== undefined)\r\n      this.access_token = access_token;\r\n    if (refresh_token !== undefined)\r\n      this.refresh_token = refresh_token;\r\n  }\r\n  get_token() {\r\n    return {\r\n      access_token: this.access_token === '' ? undefined : this.access_token, refresh_token: this.refresh_token === '' ? undefined : this.refresh_token\r\n    }\r\n  }\r\n  request_key(router, key, method = \"GET\", data) {\r\n    return this.request(`${router}/${key}`, method, data);\r\n  }\r\n  update_config() {\r\n    let config = store.getState().config;\r\n    config.data.api_token = this.get_token();\r\n    console.log('config.data.api_token', config.data.api_token)\r\n    // config.save();\r\n    store.dispatch(setConfig(config));\r\n  }\r\n  load_from_config() {\r\n    const config = store.getState().config;\r\n    this.set_token(config.data.api_token.access_token, config.data.api_token.refresh_token);\r\n  }\r\n  get_headers(refresh = false, access = true) {\r\n    let headers = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (refresh) {\r\n      headers['Refresh'] = this.refresh_token;\r\n    }\r\n    if (access) {\r\n      if (this.access_token !== '') headers['Authorization'] = this.access_token;\r\n    }\r\n    return headers;\r\n  }\r\n  async request(router, method = \"GET\", data) {\r\n    const payload = {\r\n      method: method,\r\n      mode: 'cors',\r\n      body: data ? JSON.stringify(data) : undefined,\r\n      // 注销的时候自带 refresh_token\r\n      headers: this.get_headers(Boolean(router === 'session' && method === 'DELETE')),\r\n    };\r\n    // console.log('request', router, method, data, payload);\r\n    // console.log(`${this.url}/${router}`);\r\n    const resp = await fetch(`${this.url}/${router}`, payload);\r\n    let js = null;\r\n    try { js = await resp.json(); } catch (e) {\r\n      console.error(e);\r\n      store.dispatch(setErrorInfo(e));\r\n      return { code: resp.status, error: resp.statusText };\r\n    }\r\n    console.log('raw js:', js);\r\n    if (!js) {\r\n      // console.log(await resp.json());\r\n      js = {};\r\n      js.message = resp.statusText;\r\n    }\r\n    if (js.code === undefined) js.code = resp.status;\r\n    if (js.code === 422) {\r\n      if (this.refresh_token === '') {\r\n        // 过期勒\r\n        return null;\r\n      }\r\n      // ac_token到期，准备更新\r\n      // console.log(this.get_headers(true));\r\n      const resp2 = await fetch(`${this.url}/session`, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: this.get_headers(true),\r\n        // body: JSON.stringify({ refresh_token: this.refresh_token })\r\n      });\r\n      try {\r\n        const js2 = await resp2.json();\r\n        // console.log('updating ac_token', js2);\r\n        if (js2.code === 200) {\r\n          this.set_token(js2.data.access_token, js2.data.refresh_token);\r\n          this.update_config();\r\n          // 更新user\r\n          const res = this.request('user', 'GET');\r\n          if (res.code === 200) {\r\n            store.dispatch(setUser(res.data.user));\r\n          }\r\n        }\r\n        else {\r\n          // 判定为 update_token 也过期，要求重新登录\r\n          store.dispatch(setErrorInfo(\"登录过期，请重新登录\"));\r\n          return null;\r\n        }\r\n      } catch (e) {\r\n        // console.error(e);\r\n        return { code: resp2.status, error: resp2.statusText };\r\n      }\r\n      return this.request(router, method, data);\r\n    }\r\n    if (js.code === 200) {\r\n      // 登录自动储存 JWT 数据\r\n      if (router === 'session' && method === 'POST') {\r\n        const { access_token, refresh_token } = js.data;\r\n        // console.log('jwt', access_token, refresh_token);\r\n        this.set_token(access_token, refresh_token);\r\n        this.update_config();\r\n      } else if (router === 'session' && method === 'DELETE') {\r\n        // 注销\r\n        // console.warn('注销');\r\n        this.set_token('', '');\r\n        this.update_config();\r\n      }\r\n    } else {\r\n      store.dispatch(setErrorInfo(js));\r\n    }\r\n    return js;\r\n  }\r\n}\r\n\r\nconst api = new API();\r\n\r\nexport { API, api };","import { combineReducers } from 'redux'\r\nimport Config from \"../Config\"\r\n\r\nconst defaultState = {\r\n  config: new Config(),\r\n  tasks: [],\r\n  user: null,\r\n  daemon: null,\r\n  errorInfo: null,\r\n  message: null,\r\n  types: {},\r\n}\r\n\r\nfunction types(state = defaultState.types, action) {\r\n  switch (action.type) {\r\n    case \"SET_TYPES\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction config(state = defaultState.config, action) {\r\n  switch (action.type) {\r\n    case \"SET_CONFIG\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction user(state = defaultState.user, action) {\r\n  switch (action.type) {\r\n    case \"SET_USER\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction tasks(state = defaultState.tasks, action) {\r\n  switch (action.type) {\r\n    case \"SET_TASKS\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction daemon(state = defaultState.daemon, action) {\r\n  switch (action.type) {\r\n    case \"SET_DAEMON\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction errorInfo(state = defaultState.errorInfo, action) {\r\n  switch (action.type) {\r\n    case \"SET_ERROR_INFO\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction message(state = defaultState.message, action) {\r\n  switch (action.type) {\r\n    case \"SET_MESSAGE\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default combineReducers({ config, errorInfo, message, daemon, user, tasks, types });\r\n","import { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport { orange, grey, blueGrey } from '@material-ui/core/colors';\r\nimport { api } from \"./api/api\";\r\n\r\nclass Config {\r\n  ITEM_NAME = \"group_bying_config\";\r\n  constructor() {\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.theme_avaliable = {\r\n      \"默认主题\": createMuiTheme({}),\r\n      '黑暗模式': createMuiTheme({\r\n        palette: {\r\n          type: \"dark\",\r\n          primary: {\r\n            main: blueGrey[500],\r\n          },\r\n          secondary: {\r\n            main: grey[500],\r\n          },\r\n        },\r\n      }),\r\n    }\r\n    // 在构造函数执行的时候加载保存的数据\r\n    this.data_default = {\r\n      debug: false,\r\n      version_frontend: 0.1,\r\n      // 显示主题\r\n      // theme_name: \"黑暗模式\",\r\n      theme_name: \"默认主题\",\r\n      theme_avaliable: [\r\n        '默认主题',\r\n        '黑暗模式'\r\n      ],\r\n      // 设置同步\r\n      settings_async: true,\r\n      // 远程登录服务器\r\n      remote_login: {\r\n        server: \"ws://127.0.0.1:8081\"\r\n      },\r\n      api_token: {}\r\n    };\r\n    this.data = this.data_default;\r\n    this.theme = this.theme_avaliable[\"默认主题\"];\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    console.log(\"Config: loading config...\");\r\n    if (this.data.debug) {\r\n      console.log(\"Config: load default config.\");\r\n      this.save();\r\n    }\r\n    try {\r\n      this.data = JSON.parse(localStorage.getItem(this.ITEM_NAME));\r\n      if (!this.data) throw new Error(\"Null data\");\r\n      console.log(\"Got data:\", this.data);\r\n      if (!this.data.version_frontend || this.data.version_frontend < this.data_default.version_frontend) {\r\n        // 版本升级，增量更新\r\n        console.log(`Config: update ${this.data.version_frontend} -> ${this.data_default.version_frontend}`);\r\n        this.data.version_frontend = this.data_default.version_frontend;\r\n        for (let k in this.data_default) {\r\n          if (!this.data[k]) {\r\n            console.log(`    Config: add value ${k}`);\r\n            this.data[k] = this.data_default[k];\r\n          }\r\n        }\r\n        this.save();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Can not find ${this.ITEM_NAME} in localStorage, use default config.`);\r\n      this.data = this.data_default;\r\n      this.save();\r\n    }\r\n    this.theme = this.theme_avaliable[this.data.theme_name];\r\n    if (!this.theme) this.theme = this.theme_avaliable[\"default\"];\r\n    api.set_token(this.data.api_token.access_token, this.data.api_token.refresh_token);\r\n  }\r\n\r\n  save() {\r\n    console.log(\"Config: saving config...\");\r\n    this.data.api_token = api.get_token();\r\n    const s = JSON.stringify(this.data);\r\n    localStorage.setItem(this.ITEM_NAME, s);\r\n    return s;\r\n  }\r\n};\r\n\r\nexport default Config;","// applyMiddleware: redux通过该函数来使用中间件\r\n// createStore: 用于创建store实例\r\nimport { applyMiddleware, createStore } from 'redux'\r\n\r\n// 中间件，作用：如果不使用该中间件，当我们dispatch一个action时，需要给dispatch函数传入action        \r\n// 对象；但如果我们使用了这个中间件，那么就可以传入一个函数，这个函数接收两个参数:dispatch和    \r\n// getState。这个dispatch可以在将来的异步请求完成后使用，对于异步action很有用\r\nimport thunk from 'redux-thunk'\r\n\r\n// 引入reducer\r\nimport reducers from './reducers.js'\r\n\r\n// 创建store实例\r\nlet store = createStore(\r\n    reducers,\r\n    applyMiddleware(thunk)\r\n)\r\nexport default store","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\n\r\nfunction ListItemLink(props) {\r\n  const { icon, primary, to } = props;\r\n\r\n  const renderLink = React.useMemo(\r\n    () => React.forwardRef((itemProps, ref) => <RouterLink to={to} ref={ref} {...itemProps} />),\r\n    [to],\r\n  );\r\n\r\n  return (\r\n    <li>\r\n      <ListItem button component={renderLink}>\r\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\r\n        <ListItemText primary={primary} />\r\n      </ListItem>\r\n    </li>\r\n  );\r\n}\r\n\r\nListItemLink.propTypes = {\r\n  icon: PropTypes.element,\r\n  primary: PropTypes.string.isRequired,\r\n  to: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default ListItemLink;\r\n\r\n","import { Select, Box, Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, TextField, Typography, MenuItem, IconButton } from \"@material-ui/core\";\r\nimport { DateTimePicker } from \"@material-ui/pickers\";\r\nimport React from \"react\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport store from \"../data/store\";\r\nimport { isIterator, objectUpdate, timedeltaUnits } from \"../utils/utils\";\r\nimport moment from \"moment\";\r\n\r\nexport default function ListEdit(props) {\r\n  const { defaultValue, open, onClose, title, keyNames, dataType, typeName } = props;\r\n  const dismiss = props.dismiss && isIterator(props.dismiss) ? props.dismiss : [];\r\n  const onSave = props.onSave ? props.onSave : null;\r\n  const [data, setInnerData] = React.useState(defaultValue);\r\n  const setData = (update) => setInnerData(objectUpdate(data, update));\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  const [timedeltaUnit, setTimedeltaUnit] = React.useState({});\r\n\r\n  const handleSave = () => {\r\n    onSave(data);\r\n  }\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          if (dismiss.indexOf(v) >= 0) return null;\r\n          // console.log(\"store.getState().types\", store.getState().types);\r\n          // console.log(\"typeName\", typeName, \"dataType\", dataType);\r\n          const args = dataType && typeName && store.getState().types[typeName][dataType].args[v] ?\r\n            store.getState().types[typeName][dataType].args[v] : null;\r\n          // console.log('v', v, 'args', args);\r\n          if (dataType && typeName && args && !args.editable) return null;\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          // if (((typeof (data[v]) !== \"string\")) && !data[v]) return undefined;\r\n          let value = data[v];\r\n          if ((!value && typeof (value) !== \"number\") && dataType && typeName && args) {\r\n            value = `${args.type}|${args.value ? args.value : ''}`;\r\n          }\r\n          if (typeof (value) === 'object') {\r\n            return <ListItem key={k} button onClick={() => {\r\n              setChild(value);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            let actionData = null;\r\n            if (typeof (value) === \"string\" && value.startsWith(\"timezone|\")) {\r\n              // 时区暂时不可编辑\r\n              actionData = value.slice(\"timezone|\".length);\r\n            } else if (typeof (value) === \"string\" && value.startsWith(\"datetime|\")) {\r\n              // console.log('datetime:', value);\r\n              if (value === 'datetime|') {\r\n                actionData = <Button onClick={() => {\r\n                  setData({ [v]: `datetime|${new Date().toISOString()}` });\r\n                }}>点击设置</Button>;\r\n              } else {\r\n                actionData = <Box>\r\n                  <DateTimePicker\r\n                    value={value.slice(\"datetime|\".length)}\r\n                    onChange={e => {\r\n                      console.log(\"e\", e);\r\n                      // 这里会改变到没有时区的类型\r\n                      console.log(`datetime|${moment(e).format(\"YYYY-MM-DDTHH:mm:ss.SSSSSS+00:00\")}`);\r\n                      setData({ [v]: `datetime|${moment(e).format(\"YYYY-MM-DDTHH:mm:ss.SSSSSS+00:00\")}` });\r\n                    }}\r\n                  ></DateTimePicker>\r\n                  <IconButton onClick={() => {\r\n                    setData({ [v]: null });\r\n                  }}>\r\n                    <DeleteIcon></DeleteIcon>\r\n                  </IconButton>\r\n                </Box>;\r\n              }\r\n            } else if (typeof (value) === \"string\" && value.startsWith(\"timedelta|\")) {\r\n              const val = value.slice(\"timedelta|\".length);\r\n              const unit = timedeltaUnit[v] ? timedeltaUnit[v] : Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n              actionData = <Box>\r\n                <TextField value={`${parseFloat(val) / timedeltaUnits[unit]}`} onChange={e => {\r\n                  let val = e.target.value;\r\n                  if (isNaN(parseFloat(val)))\r\n                    if (val.length > 0) return;\r\n                    else val = 0;\r\n                  const newValue = `timedelta|${parseFloat(val) * timedeltaUnits[unit]}`;\r\n                  setData({ [v]: newValue });\r\n                }}></TextField>\r\n                <Select value={unit}\r\n                  onChange={e => {\r\n                    setTimedeltaUnit(objectUpdate(timedeltaUnit, { [v]: e.target.value }));\r\n                  }}>\r\n                  {Object.keys(timedeltaUnits).map((key, k) => <MenuItem key={k} value={key}>\r\n                    {key}\r\n                  </MenuItem>)}\r\n                </Select>\r\n              </Box>\r\n            } else {\r\n              actionData = <TextField value={`${value}`} onChange={e => {\r\n                const newValue = e.target.value.length === 0 ? 0 : (typeof (value) === \"number\" ? parseFloat(e.target.value) : `${e.target.value}`);\r\n                if (isNaN(newValue)) return;\r\n                setData({ [v]: newValue });\r\n              }}></TextField>;\r\n            }\r\n            return <ListItem key={k}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                {actionData}\r\n              </ListItemSecondaryAction>\r\n            </ListItem>;\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListEdit defaultValue={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListEdit> : undefined}\r\n    </DialogContent>\r\n    {onSave ? <DialogActions>\r\n      <Button color=\"primary\" onClick={handleSave}>保存</Button>\r\n      <Button onClick={onClose}>取消</Button>\r\n    </DialogActions> : <DialogActions><Box style={{ width: \"100%\", height: \"100%\", display: \"flex\", justifyContent: \"center\" }}><Typography style={{ height: \"100%\" }} variant=\"body1\" color=\"secondary\">无法保存</Typography></Box></DialogActions>}\r\n  </Dialog>\r\n}","import { Container, Dialog, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nexport default function ListInfo(props) {\r\n  const { data, open, onClose, title, keyNames } = props;\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  // console.log(data);\r\n  // Object.keys(data).map((v, k) => { console.log(`v: ${v}, k: ${k}`) })\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          if (!data[v]) return undefined;\r\n          if (typeof (data[v]) === 'object') {\r\n            return <ListItem key={k} button onClick={() => {\r\n              setChild(data[v]);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            const s = `${data[v]}`;\r\n            return <ListItem key={k}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                <Typography variant=\"body1\">{s.slice(0, 20) + (s.length > 20 ? \"...\" : \"\")}</Typography>\r\n              </ListItemSecondaryAction>\r\n            </ListItem>\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListInfo data={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListInfo> : undefined}\r\n    </DialogContent>\r\n  </Dialog>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { deepCopy, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\nimport ListEdit from \"./ListEdit\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nconst keyNames = {\r\n  \"item_id\": \"目标项目ID\",\r\n  \"target_price\": \"目标价格\"\r\n};\r\n\r\nexport function isActionModified(item, type = \"actions\") {\r\n  return !isObjectValueEqual(item.data, store.getState().types[type][item.type].data);\r\n}\r\n\r\nfunction getTimedeltaString(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return \"\";\r\n  const timedeltaUnits = {\r\n    \"秒\": 1, \"分\": 60, \"时\": 60 * 60,\r\n    \"天\": 24 * 60 * 60, \"周\": 7 * 24 * 60 * 60\r\n  };\r\n  for (let i = 1; i < Object.keys(timedeltaUnits).length; i++) {\r\n    if (timedelta < timedeltaUnits[Object.keys(timedeltaUnits)[i]]) {\r\n      return `${(timedelta / timedeltaUnits[Object.keys(timedeltaUnits)[i - 1]]).toFixed(2)}${Object.keys(timedeltaUnits)[i - 1]}`;\r\n    }\r\n  }\r\n  return `${(timedelta / timedeltaUnits[Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]]).toFixed(2)}${Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]}`;\r\n}\r\n\r\nfunction getDataString(data, typeName, dataType) {\r\n  let res = \"\";\r\n  if (typeof (data) !== 'object') return;\r\n  for (const key in data) {\r\n    const showName = keyNames ? (keyNames[key] || key) : (key);\r\n    const args = dataType && typeName && store.getState().types[typeName][dataType].args[key] ?\r\n      store.getState().types[typeName][dataType].args[key] : null;\r\n    if (args && !args.editable) continue;\r\n    let value = data[key];\r\n    if (!value && typeof (value) !== 'number') continue;\r\n    if (typeof (value) === 'string') {\r\n      if (value.startsWith(\"datetime|\")) {\r\n        value = moment(value.slice('datetime|'.length)).calendar();\r\n      } else if (value.startsWith('timedelta|')) {\r\n        value = getTimedeltaString(parseFloat(value.slice('timedelta|'.length)));\r\n      }\r\n    }\r\n    res = `${(res.length === 0 ? '' : (res + '/'))}${showName}:${value}`\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function ActionTag(props) {\r\n  let { action, selectMode, onClick, onSave } = props;\r\n  const [dialogOpen, setDialogOpen] = React.useState(false);\r\n  const [toUse, setToUse] = React.useState(false);\r\n  onClick = onClick ? onClick : () => { };\r\n  if (!action) return null;\r\n  const handleCloseDialog = () => { setDialogOpen(false); };\r\n  const handleClick = newAction => {\r\n    onClick(newAction ? newAction : action, selectMode);\r\n  };\r\n  return <Card style={{ minWidth: 200, margin: 10 }}>\r\n    <CardContent onClick={selectMode ? () => { } : () => { handleClick(); }}>\r\n      <Typography variant=\"h5\">{action.name}</Typography>\r\n      {isActionModified(action, \"actions\") ?\r\n        getDataString(action.data, \"actions\", action.type) :\r\n        <Typography variant=\"body1\">{action.desc}</Typography>\r\n      }\r\n      <ListEdit\r\n        // dismiss={['version', 'timezone']}\r\n        keyNames={keyNames}\r\n        open={dialogOpen}\r\n        dataType={action.type}\r\n        typeName=\"actions\"\r\n        onClose={handleCloseDialog}\r\n        defaultValue={action.data}\r\n        onSave={newData => {\r\n          let newAction = deepCopy(action);\r\n          newAction.data = newData;\r\n          console.log(newData);\r\n          onSave && onSave(newAction);\r\n          handleCloseDialog();\r\n          if (toUse) handleClick(newAction);\r\n        }}></ListEdit>\r\n    </CardContent>\r\n    {selectMode ? <CardActions>\r\n      <Button color=\"primary\" onClick={selectMode ? () => { handleClick(); } : () => { }}>使用</Button>\r\n      <Button color=\"primary\" onClick={() => { setDialogOpen(true); setToUse(true); }}>修改设置并使用</Button>\r\n    </CardActions> : <CardActions>\r\n      <Button color={isActionModified(action, \"actions\") ? \"primary\" : \"secondary\"} onClick={() => { setDialogOpen(true); }}>修改设置</Button>\r\n    </CardActions>}\r\n  </Card>\r\n}\r\n\r\nexport default function Actions(props) {\r\n  let { selectMode, onClick } = props;\r\n  onClick = onClick ? onClick : () => { };\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const actions = store.getState().types.actions;\r\n  if (!actions && !requesting) {\r\n    setRequesting(true);\r\n    api.request(\"action\", 'GET').then(resp => {\r\n      // console.log(\"resp\", resp);\r\n      store.dispatch(updateTypes(\"actions\", resp.data.actions));\r\n      forceUpdate();\r\n    });\r\n  }\r\n  // console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!actions) {\r\n    content = <Typography variant=\"body1\">正在加载Action类型...</Typography>\r\n  } else {\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(actions).map((action_type, k) => <ActionTag onClick={onClick} key={k} selectMode={selectMode} action={actions[action_type]}></ActionTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { deepCopy, getTimedeltaString, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\nimport ListEdit from \"./ListEdit\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nconst keyNames = {\r\n  'start_date': \"开始时间\",\r\n  'end_date': '结束时间',\r\n  \"interval\": \"间隔\",\r\n  \"run_date\": '运行时间'\r\n};\r\n\r\nexport function isTriggerModified(item, type = \"triggers\") {\r\n  return !isObjectValueEqual(item.data, store.getState().types[type][item.type].data);\r\n}\r\n\r\nfunction getDataString(data, typeName, dataType) {\r\n  let res = \"\";\r\n  if (typeof (data) !== 'object') return;\r\n  for (const key in data) {\r\n    const showName = keyNames ? (keyNames[key] || key) : (key);\r\n    const args = dataType && typeName && store.getState().types[typeName][dataType].args[key] ?\r\n      store.getState().types[typeName][dataType].args[key] : null;\r\n    if (args && !args.editable) continue;\r\n    let value = data[key];\r\n    if (!value) continue;\r\n    if (value.startsWith(\"datetime|\")) {\r\n      value = moment(value.slice('datetime|'.length)).calendar();\r\n    } else if (value.startsWith('timedelta|')) {\r\n      value = getTimedeltaString(parseFloat(value.slice('timedelta|'.length)));\r\n    }\r\n    res = `${(res.length === 0 ? '' : (res + '/'))}${showName}:${value}`\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function TriggerTag(props) {\r\n  let { trigger, selectMode, onClick, onSave } = props;\r\n  const [dialogOpen, setDialogOpen] = React.useState(false);\r\n  const [toUse, setToUse] = React.useState(false);\r\n  onClick = onClick ? onClick : () => { };\r\n  if (!trigger) return null;\r\n  const handleCloseDialog = () => { setDialogOpen(false); };\r\n  const handleClick = newTrigger => {\r\n    onClick(newTrigger ? newTrigger : trigger, selectMode);\r\n  };\r\n  return <Card style={{ minWidth: 200, margin: 10 }}>\r\n    <CardContent onClick={selectMode ? () => { } : () => { handleClick(); }}>\r\n      <Typography variant=\"h5\">{trigger.name}</Typography>\r\n      {isTriggerModified(trigger, \"triggers\") ?\r\n        getDataString(trigger.data, \"triggers\", trigger.type) :\r\n        <Typography variant=\"body1\">{trigger.desc}</Typography>\r\n      }\r\n      <ListEdit\r\n        dismiss={['version', 'timezone']}\r\n        keyNames={keyNames}\r\n        open={dialogOpen}\r\n        dataType={trigger.type}\r\n        typeName=\"triggers\"\r\n        onClose={handleCloseDialog}\r\n        defaultValue={trigger.data}\r\n        onSave={newData => {\r\n          let newTrigger = deepCopy(trigger);\r\n          newTrigger.data = newData;\r\n          console.log(newData);\r\n          onSave && onSave(newTrigger);\r\n          handleCloseDialog();\r\n          if (toUse) handleClick(newTrigger);\r\n        }}></ListEdit>\r\n    </CardContent>\r\n    {selectMode ? <CardActions>\r\n      <Button color=\"primary\" onClick={selectMode ? () => { handleClick(); } : () => { }}>使用</Button>\r\n      <Button color=\"primary\" onClick={() => { setDialogOpen(true); setToUse(true); }}>修改设置并使用</Button>\r\n    </CardActions> : <CardActions>\r\n      <Button color={isTriggerModified(trigger, \"triggers\") ? \"primary\" : \"secondary\"} onClick={() => { setDialogOpen(true); }}>修改设置</Button>\r\n    </CardActions>}\r\n  </Card>\r\n}\r\n\r\nexport default function Triggers(props) {\r\n  let { selectMode, onClick } = props;\r\n  onClick = onClick ? onClick : () => { };\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const triggers = store.getState().types.triggers;\r\n  if (!triggers && !requesting) {\r\n    setRequesting(true);\r\n    api.request(\"trigger\", 'GET').then(resp => {\r\n      // console.log(\"resp\", resp);\r\n      store.dispatch(updateTypes(\"triggers\", resp.data.triggers));\r\n      forceUpdate();\r\n    });\r\n  }\r\n  // console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!triggers) {\r\n    content = <Typography variant=\"body1\">正在加载触发器类型...</Typography>\r\n  } else {\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(triggers).map((trigger_type, k) => <TriggerTag onClick={onClick} key={k} selectMode={selectMode} trigger={triggers[trigger_type]}></TriggerTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Container } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport Actions from \"../components/Actions\";\r\nimport Triggers from \"../components/Triggers\";\r\n\r\nexport default function Launch(props) {\r\n  return <Container>\r\n    <Triggers useActions={false} onClick={(trigger) => {\r\n      console.log(trigger);\r\n    }}></Triggers>\r\n    <Actions useActions={true}></Actions>\r\n  </Container>\r\n}","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { funDownload } from \"../utils/utils\";\r\nimport ListInfo from \"../components/ListInfo\";\r\n\r\nfunction Settings(props) {\r\n  const [themeName, setThemeName] = React.useState(store.getState().config.data.theme_name);\r\n  const refConfigFileInput = React.useRef();\r\n  const [resetSettingsOpen, setResetSettingsOpen] = React.useState(false);\r\n  const [deleteDataOpen, setDeleteDataOpen] = React.useState(false);\r\n  const [openDaemon, setOpenDaemon] = React.useState(false);\r\n  const [openUser, setOpenUser] = React.useState(false);\r\n\r\n  const resetSettings = function () {\r\n    let c = store.getState().config;\r\n    c.data = c.data_default;\r\n    c.save();\r\n    c.load();\r\n    store.dispatch(setConfig(c));\r\n  }\r\n\r\n  const user = store.getState().user;\r\n\r\n  return (<Container maxWidth=\"md\">\r\n    <List>\r\n      <ListSubheader>用户账号</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"用户名\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          {user.username}\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenUser(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button>\r\n        <ListItemText primary=\"修改信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>用户门店</ListSubheader>\r\n      <ListItem button onClick={() => { setOpenDaemon(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>外观</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"主题设置\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <FormControl>\r\n            {/* <InputLabel></InputLabel> */}\r\n            <Select value={themeName} onChange={e => {\r\n              setThemeName(e.target.value);\r\n              let c = store.getState().config;\r\n              c.data.theme_name = e.target.value;\r\n              c.theme = c.theme_avaliable[c.data.theme_name];\r\n              c.save();\r\n              store.dispatch(setConfig(c));\r\n              setTimeout(() => { window.location.reload(); }, 200);\r\n            }}>\r\n              {store.getState().config.data.theme_avaliable.map((v, k) => <MenuItem key={k} value={v}>{v}</MenuItem>)}\r\n            </Select>\r\n          </FormControl>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListSubheader>数据管理</ListSubheader>\r\n      <ListItem button onClick={() => {\r\n        funDownload(store.getState().config.save(), `团购杀手配置数据(${new Date().toLocaleString()}).json`);\r\n      }}>\r\n        <ListItemText primary=\"数据导出\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        // console.log(refConfigFileInput)\r\n        refConfigFileInput.current.click();\r\n      }}>\r\n        <ListItemText primary=\"数据导入\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <input type=\"file\" accept=\".json\" hidden name=\"file-gbk-data\" ref={refConfigFileInput} onChange={e => {\r\n            // console.log(e);\r\n            let files = e.target.files;\r\n            if (files.length === 0) {\r\n              store.dispatch(setMessage(\"未选择文件\"));\r\n              return;\r\n            }\r\n            try {\r\n              let file = files[0];\r\n              let reader = new FileReader();\r\n              reader.readAsText(file, 'UTF-8');\r\n              reader.onload = evt => {\r\n                const fileData = evt.target.result;\r\n                try {\r\n                  const js = JSON.parse(fileData);\r\n                  if (!js.version_frontend) {\r\n                    store.dispatch(setMessage(\"文件类型错误或者文件已经损坏\"));\r\n                    return;\r\n                  }\r\n                  if (js.version_frontend > store.getState().config.data.version_frontend) {\r\n                    store.dispatch(setMessage(`存档文件版本(${js.version_frontend}高于当前版本${store.getState().config.data.version_frontend})，请更新到最新版`));\r\n                    return;\r\n                  }\r\n                  let c = store.getState().config;\r\n                  c.data = js;\r\n                  store.dispatch(setConfig(c));\r\n                  store.dispatch(setMessage(\"数据导入完成\"));\r\n                } catch (e) {\r\n                  store.dispatch(setErrorInfo(e));\r\n                }\r\n              };\r\n            } catch (e) {\r\n              store.dispatch(setErrorInfo(e));\r\n            }\r\n          }}></input>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置数据同步\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Switch defaultChecked={store.getState().config.data.settings_async} onChange={e => {\r\n            let c = store.getState().config;\r\n            c.data.settings_async = e.target.checked;\r\n            c.save();\r\n            store.dispatch(setConfig(c));\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setResetSettingsOpen(true)}>\r\n        <ListItemText primary=\"回到默认设置\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setDeleteDataOpen(true)}>\r\n        <ListItemText primary=\"删除所有数据\"></ListItemText>\r\n      </ListItem>\r\n    </List>\r\n    <ListInfo data={store.getState().user} open={openUser} keyNames={{\r\n      username: '用户名', nick: '昵称', phone: '用户手机号', profile: '详细信息', state: '用户状态', created_at: '创建于', updated_at: '更新于'\r\n    }} title=\"用户信息\" onClose={() => { setOpenUser(false); }}></ListInfo>\r\n    <ListInfo data={store.getState().daemon} open={openDaemon} keyNames={{\r\n      cookies: '远程登录凭据', shop_info: \"门店详细信息\", solution_id: \"解决方案编号\"\r\n    }} title=\"门店信息\" onClose={() => { setOpenDaemon(false); }}></ListInfo>\r\n    <Dialog open={resetSettingsOpen} onClose={() => setResetSettingsOpen(false)}>\r\n      <DialogTitle>\r\n        回到默认设置\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除所有设置数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setResetSettingsOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={deleteDataOpen} onClose={() => setDeleteDataOpen(false)}>\r\n      <DialogTitle>\r\n        删除所有数据\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除软件数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setDeleteDataOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  </Container>)\r\n}\r\n\r\nexport default Settings;","import store from \"../data/store\";\r\n\r\n\r\nclass WebSocketAPI {\r\n  constructor(url) {\r\n    this.connect = this.connect.bind(this);\r\n    this.url = url || store.getState().config.data.remote_login.server || \"ws://127.0.0.1:8081\";\r\n    this.ws = null;\r\n    this.onopen = () => {\r\n      console.log('Connection started');\r\n    };\r\n    this.ondata = e => {\r\n      if (e.cmd === 'code') {\r\n        this.oncode(e.data);\r\n      } else if (e.cmd === 'cookies') {\r\n        this.oncookies(e.data);\r\n      }\r\n    };\r\n    this.onmessage = e => {\r\n      // console.log('onmessage', e);\r\n      this.ondata(JSON.parse(e.data));\r\n    };\r\n    this.onerror = e => {\r\n      console.error(e);\r\n    };\r\n    this.onclose = () => {\r\n      console.log('Connection closed');\r\n    };\r\n    this.oncode = code => { console.log('code', code); }\r\n    this.oncookies = cookies => { console.log('cookies', cookies); }\r\n  }\r\n  connect() {\r\n    this.ws = this.ws || new WebSocket(this.url);\r\n    this.ws.onopen = this.onopen;\r\n    this.ws.onclose = this.onclose;\r\n    this.ws.onerror = this.onerror;\r\n    this.ws.onmessage = this.onmessage;\r\n  }\r\n  close() {\r\n    if (this.ws) this.ws.close();\r\n  }\r\n}\r\n\r\nexport { WebSocketAPI };","import { Box, Container, Paper } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { WebSocketAPI } from '../api/remote_login';\r\nimport { setConfig, setDaemon } from '../data/action';\r\nimport store from '../data/store';\r\nconst QRCode = require('qrcode.react');\r\n\r\nfunction CenterBox(props) {\r\n  const { children } = props;\r\n  return <Box style={{ width: '100%', height: '100%', display: \"flex\", justifyContent: \"center\", flexDirection: \"column\" }}><Box style={{ width: '100%', textAlign: \"center\" }}>{children}</Box></Box>;\r\n}\r\n\r\nexport default class RemoteLogin extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      code: null,\r\n      loginDone: false\r\n    };\r\n    this.ws_api = null;\r\n    // this.unsubscribe = store.subscribe(async () => {\r\n    //   if (this.loginDone) return;\r\n    //   let state = store.getState();\r\n    //   if (state.daemon) {\r\n    //     this.setState({ loginDone: true });\r\n    //     if (this.ws_api) this.ws_api.close();\r\n    //   }\r\n    // });\r\n    setTimeout(async () => {\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      const res = await api.request('remote_login', \"PATCH\");\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      const server = res.data.server;\r\n      let config = store.getState().config;\r\n      config.data.remote_login.server = server;\r\n      store.dispatch(setConfig(config));\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      this.ws_api = new WebSocketAPI(server);\r\n      this.ws_api.oncode = code => {\r\n        // console.log('code', code);\r\n        if (store.getState().daemon || this.state.loginDone) return;\r\n        this.setState({ code });\r\n      };\r\n      this.ws_api.oncookies = async cookies => {\r\n        const resp = await api.request('remote_login', \"POST\", { cookies });\r\n        console.log('done', resp);\r\n        if (store.getState().daemon || this.state.loginDone) return;\r\n        this.setState({ loginDone: true });\r\n        const daemon = await api.request('remote_login', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        }\r\n      }\r\n      if (store.getState().daemon || this.state.loginDone) return;\r\n      this.ws_api.connect();\r\n    }, 1000);\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.ws_api) this.ws_api.close();\r\n    // this.unsubscribe();\r\n  }\r\n  render() {\r\n    let content = null;\r\n    if (this.state.loginDone) {\r\n      content = <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>登录完成</CenterBox>\r\n      </Paper>;\r\n    } else {\r\n      content = this.state.code ? <QRCode value={JSON.stringify(this.state.code)} size={200} /> : <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>正在加载二维码...</CenterBox>\r\n      </Paper>;\r\n    }\r\n    return (<Container>\r\n      {content}\r\n    </Container>);\r\n  }\r\n}","import { Box, Button, Container, Divider, TextField, Typography, Zoom, Fade } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { setMessage, setUser } from '../data/action';\r\nimport store from '../data/store';\r\nimport { objectUpdate } from '../utils/utils';\r\n\r\n\r\nfunction LoginFrame(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    captcha: \"\",\r\n    actionType: 'login'\r\n  });\r\n  const refUsername = React.useRef();\r\n  const refPassword = React.useRef();\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n  // style={{ display: \"flex\", justifyContent: 'center', alignItems: \"center\", flexDirection: \"column\", }}\r\n  const actionLogin = state.actionType === 'login' ? true : false;\r\n  const handleAction = async () => {\r\n    // console.log('handle', actionLogin);\r\n    if (actionLogin) {\r\n      const res = await api.request('session', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code !== 200) return;\r\n      // 获取user\r\n      const user = await api.request('user', 'GET');\r\n      if (user.code !== 200) return;\r\n      console.log('user', user.data.user);\r\n      store.dispatch(setUser(user.data.user));\r\n    } else {\r\n      // 注册，注册成功则跳转登录\r\n      const res = await api.request('user', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code === 200) {\r\n        // 弹窗\r\n        store.dispatch(setMessage(\"注册成功\"));\r\n        setState({actionType: 'login'});\r\n      }\r\n    }\r\n  }\r\n\r\n  return (<Box>\r\n    <Typography variant=\"h4\">{actionLogin ? \"登录\" : \"注册\"}</Typography>\r\n    <br />\r\n    <Divider></Divider>\r\n    <br />\r\n    <TextField fullWidth ref={refUsername} label=\"用户名\" variant=\"outlined\" value={state.username} onChange={e => {\r\n      setState({ username: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        refPassword.current.querySelector(\"input\").focus();\r\n      }\r\n    }} />\r\n    <br /><br />\r\n    <TextField fullWidth ref={refPassword} label=\"密码\" variant=\"outlined\" value={state.password} type=\"password\" onChange={e => {\r\n      setState({ password: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        handleAction();\r\n      }\r\n    }} />\r\n    <Fade in={actionLogin} style={{ display: actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>登录</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => setState({ actionType: \"sign_in\" })}>注册</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n    <Fade in={!actionLogin} style={{ display: !actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>注册</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" onClick={() => setState({ actionType: 'login' })}>返回登录</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n  </Box >);\r\n}\r\n\r\nexport default function Login(props) {\r\n  return <Container maxWidth=\"sm\">\r\n    <LoginFrame></LoginFrame>\r\n  </Container>\r\n}","import { Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListSubheader, TextField, Typography } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport Actions from \"../components/Actions\";\r\nimport { ActionTag, isActionModified } from \"../components/Actions\";\r\nimport Triggers from \"../components/Triggers\";\r\nimport { TriggerTag, isTriggerModified } from \"../components/Triggers\";\r\nimport { setErrorInfo, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { arrayRemove, deepCopy, objectUpdate } from \"../utils/utils\";\r\n\r\n\r\nfunction TaskTag(props) {\r\n  const { task } = props;\r\n  return <code>{JSON.stringify(task)}</code>;\r\n}\r\n\r\nexport default function Tasks(props) {\r\n  const tasks = store.getState().tasks;\r\n  const [state, setInnerState] = React.useState({\r\n    dialogAddTaskOpen: false,\r\n    dialogAddTriggerOpen: false,\r\n    dialogAddActionOpen: false,\r\n    dialogUpdateTrigger: false,\r\n    triggers: [],\r\n    actions: [],\r\n    requesting: false,\r\n    taskName: store.getState().types.task_data ? `未命名任务${store.getState().types.task_data.tid}` : '未命名任务'\r\n  });\r\n  const taskData = store.getState().types.task_data;\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n\r\n  if (!state.requesting && !taskData) {\r\n    setState({ requesting: true });\r\n    api.request(\"task\", 'PATCH').then(resp => {\r\n      // console.log(\"resp\", resp);\r\n      store.dispatch(updateTypes(\"task_data\", resp.data.task_data));\r\n      forceUpdate();\r\n    })\r\n  }\r\n\r\n  const handleAddTask = async () => {\r\n    console.log('pass#2');\r\n    if (!taskData) {\r\n      setErrorInfo(\"Task数据为空。\");\r\n      console.error(\"Task数据为空。\");\r\n      return;\r\n    }\r\n    const task = objectUpdate(taskData, { triggers: state.triggers, actions: state.actions, task_name: state.taskName, tid: null, });\r\n    console.log('task', task);\r\n    const resp = await api.request('task', \"POST\", { task });\r\n    console.log('resp', resp);\r\n  };\r\n\r\n  const dialogAddTask = <Dialog fullWidth open={state.dialogAddTaskOpen} onClose={() => setState({ dialogAddTaskOpen: false })}>\r\n    <DialogTitle>添加新任务</DialogTitle>\r\n    <DialogContent>\r\n      <List>\r\n        <ListSubheader>计划名称</ListSubheader>\r\n        <ListItem>\r\n          <TextField value={state.taskName} onChange={e => {\r\n            setState({ taskName: e.target.value });\r\n          }}></TextField>\r\n        </ListItem>\r\n        <ListSubheader>触发器列表</ListSubheader>\r\n        {state.triggers.map((trigger, k) => <ListItem key={k}>\r\n          <TriggerTag trigger={trigger} onSave={data => {\r\n            console.log('saveing', data);\r\n            let newTriggers = deepCopy(state.triggers);\r\n            newTriggers[k] = data;\r\n            console.log(\"newTriggers\", newTriggers);\r\n            setState({ triggers: newTriggers });\r\n          }}></TriggerTag>\r\n          <ListItemSecondaryAction>\r\n            <IconButton onClick={() => {\r\n              let newTriggers = deepCopy(state.triggers);\r\n              newTriggers.splice(k, 1);\r\n              console.log(\"newTriggers\", newTriggers);\r\n              setState({ triggers: newTriggers });\r\n            }}>\r\n              <DeleteIcon></DeleteIcon>\r\n            </IconButton>\r\n          </ListItemSecondaryAction>\r\n        </ListItem>)}\r\n        <ListSubheader>Actions列表</ListSubheader>\r\n        {state.actions.map((action, k) => <ListItem key={k}>\r\n          <ActionTag action={action} onSave={data => {\r\n            console.log('saveing', data);\r\n            let newActions = deepCopy(state.actions);\r\n            newActions[k] = data;\r\n            console.log(\"newActions\", newActions);\r\n            setState({ actions: newActions });\r\n          }}></ActionTag>\r\n          <ListItemSecondaryAction>\r\n            <IconButton onClick={() => {\r\n              let newActions = deepCopy(state.actions);\r\n              newActions.splice(k, 1);\r\n              console.log(\"newActions\", newActions);\r\n              setState({ actions: newActions });\r\n            }}>\r\n              <DeleteIcon></DeleteIcon>\r\n            </IconButton>\r\n          </ListItemSecondaryAction>\r\n        </ListItem>)}\r\n        <ListItem>\r\n          <Grid container spacing={5}>\r\n            <Grid item xs={12} lg={6}>\r\n              <Button fullWidth onClick={() => { setState({ dialogAddTriggerOpen: true }) }} color=\"primary\" variant=\"outlined\">添加触发器</Button>\r\n            </Grid>\r\n            <Grid item xs={12} lg={6}>\r\n              <Button fullWidth onClick={() => { setState({ dialogAddActionOpen: true }) }} color=\"primary\" variant=\"outlined\">添加Action</Button>\r\n            </Grid>\r\n          </Grid>\r\n        </ListItem>\r\n      </List>\r\n      <Dialog open={state.dialogAddTriggerOpen} onClose={() => setState({ dialogAddTriggerOpen: false })}>\r\n        <DialogTitle>选择一个触发器</DialogTitle>\r\n        <DialogContent>\r\n          <Triggers onClick={trigger => {\r\n            console.log(\"trigger\", trigger);\r\n            let triggers = deepCopy(state.triggers);\r\n            triggers.push(trigger);\r\n            setState({ dialogAddTriggerOpen: false, triggers: triggers });\r\n          }} selectMode></Triggers>\r\n        </DialogContent>\r\n      </Dialog>\r\n      <Dialog open={state.dialogAddActionOpen} onClose={() => setState({ dialogAddActionOpen: false })}>\r\n        <DialogTitle>选择一个Action</DialogTitle>\r\n        <DialogContent>\r\n          <Actions onClick={action => {\r\n            console.log(\"action\", action);\r\n            let actions = deepCopy(state.actions);\r\n            actions.push(action);\r\n            setState({ dialogAddActionOpen: false, actions: actions });\r\n          }} selectMode></Actions>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button color=\"primary\" disabled={state.triggers.length === 0 || state.actions.length === 0} onClick={async () => {\r\n        console.log('pass#1');\r\n        await handleAddTask();\r\n        setState({ dialogAddTaskOpen: false, triggers: [], actions: [] });\r\n      }}>确定</Button>\r\n      <Button onClick={() => setState({ dialogAddTaskOpen: false })}>取消</Button>\r\n    </DialogActions>\r\n  </Dialog>;\r\n\r\n  return <Container>\r\n    <Grid container spacing={3}>\r\n      <Grid item lg={8} sm={12}>\r\n        <Typography variant=\"h4\">任务列表</Typography>\r\n        <List>\r\n          {tasks.map((task, k) => <ListItem><TaskTag task={task} key={k}></TaskTag></ListItem>)}\r\n        </List>\r\n      </Grid>\r\n      <Grid item lg={4} sm={12}>\r\n        <Container maxWidth=\"xs\">\r\n          <List>\r\n            <ListSubheader>新任务</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => { setState({ dialogAddTaskOpen: true }) }}>添加新任务</Button>\r\n            </ListItem>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\">设置默认任务</Button>\r\n            </ListItem>\r\n\r\n            <ListSubheader>全部任务管理</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"outlined\">删除全部任务</Button>\r\n            </ListItem>\r\n          </List>\r\n        </Container>\r\n      </Grid>\r\n    </Grid>\r\n    {dialogAddTask}\r\n  </Container>\r\n}","import React from 'react';\r\nimport \"@fontsource/roboto\";\r\nimport clsx from 'clsx';\r\nimport Container from '@material-ui/core/Container';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport AssignmentIcon from '@material-ui/icons/Assignment';\r\nimport AlarmIcon from '@material-ui/icons/Alarm';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport StorageIcon from '@material-ui/icons/Storage';\r\nimport VerifiedUserIcon from '@material-ui/icons/VerifiedUser';\r\nimport PhonelinkIcon from '@material-ui/icons/Phonelink';\r\nimport {\r\n  HashRouter as Router,\r\n  // BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\r\nimport { Provider } from 'react-redux'\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport store from './data/store';\r\nimport { setConfig, setDaemon, setErrorInfo, setMessage, setReserveTableData, setRoomStockData, setShopInfo } from \"./data/action\";\r\n\r\nimport { isIterator, isMobileDevice, sleep } from \"./utils/utils\";\r\nimport { api } from \"./api/api\";\r\n\r\nimport ListItemLink from \"./components/ListItemLink\";\r\nimport Launch from \"./pages/Launch\";\r\nimport Settings from \"./pages/Settings\";\r\nimport './App.css';\r\nimport { Box, Button, Dialog, DialogActions, DialogContent, DialogTitle, ListItem, Snackbar } from '@material-ui/core';\r\nimport RemoteLogin from './pages/RemoteLogin';\r\nimport Login from './pages/Login';\r\nimport Tasks from \"./pages/Tasks\";\r\n\r\nconst drawerWidth = 240;\r\nmoment.locale('zh-cn');\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n    width: '100%',\r\n    // overflowX: 'auto',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  hide: {\r\n    display: 'none',\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    flexShrink: 0,\r\n    whiteSpace: 'nowrap',\r\n  },\r\n  drawerOpen: {\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerClose: {\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n    width: theme.spacing(7) + 1,\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  toolbar: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // necessary for content to be below app bar\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3),\r\n    width: '100%',\r\n    overflowX: 'auto',\r\n  },\r\n}));\r\n\r\n// const api = new API();\r\n// const authApi = new AuthAPI();\r\n// api.get_shop_info().then(shopInfo => {\r\n//   console.log('shopInfo', shopInfo);\r\n//   if (shopInfo) store.dispatch(setShopInfo(shopInfo));\r\n// }).catch(e => {\r\n//   store.dispatch(setErrorInfo(e));\r\n// })\r\n\r\nlet subscribers = {};\r\n\r\nlet last_data = {\r\n  config: null,\r\n  user: null,\r\n  daemon: null\r\n};\r\n\r\nstore.subscribe(async () => {\r\n  let state = store.getState();\r\n  // console.log('redux update to', state);\r\n  // 保存 config\r\n  if (state.config.data) {\r\n    if (JSON.stringify(state.config.data) !== JSON.stringify(last_data.config)) {\r\n      // console.log('Config will change:', state.config.data);\r\n      state.config.save();\r\n      if (store.getState().user && store.getState().config.data.settings_async) {\r\n        await api.request('sync', 'POST', { config: state.config.data });\r\n      }\r\n    } else {\r\n      // console.log('Not change:', state.config.data);\r\n    }\r\n    last_data.config = state.config.data;\r\n  }\r\n  for (let subFunc in subscribers) {\r\n    subscribers[subFunc](state);\r\n  }\r\n});\r\n\r\nconst getShopTitle = function () {\r\n  if (!(store.getState().daemon && store.getState().daemon.shop_info && store.getState().daemon.shop_info.shopName)) return null;\r\n  // console.log('getShopTitle', store.getState().daemon.shop_info);\r\n  const title = `${store.getState().daemon.shop_info.shopName} - ${store.getState().daemon.shop_info.branchName}`;\r\n  // console.log(title);\r\n  return title;\r\n}\r\n\r\nexport default function App() {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [popupLogin, setPopupLogin] = React.useState(false);\r\n  const [errorDialogInfo, setErrorDialogInfo] = React.useState(false);\r\n  const [myMessage, setMyMessage] = React.useState(null);\r\n  const [hasLogin, setHasLogin] = React.useState(false);\r\n  const titleDefault = \"团购杀手 - KTV体验版\";\r\n  const [title, setTitle] = React.useState(getShopTitle() || titleDefault);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n\r\n  // 拉大到800会打开，拉小到600关闭\r\n  const triggerWidthOpen = 800;\r\n  const triggerWidthClose = 600;\r\n\r\n  // 注册一个当遇到错误的时候调用的钩子吧，用来显示错误信息\r\n  subscribers['Error'] = function (state) {\r\n    if (state.errorInfo) {\r\n      console.log('Error Hook: ', state.errorInfo);\r\n      setErrorDialogInfo(state.errorInfo);\r\n      // 清空错误信息\r\n      store.dispatch(setErrorInfo(null));\r\n    }\r\n  };\r\n  // 注册一个消息钩子\r\n  subscribers['Message'] = function (state) {\r\n    if (state.message) {\r\n      console.log('message: ', state.message);\r\n      setMyMessage(state.message);\r\n      store.dispatch(setMessage(null));\r\n    }\r\n  };\r\n  subscribers['User'] = async function (state) {\r\n    if (state.user) {\r\n      if (JSON.stringify(state.user) != JSON.stringify(last_data.user)) {\r\n        forceUpdate();\r\n        // 登录信息完成，触发获取daemon\r\n        // if (!last_data.user) \r\n        if (!last_data.user) {\r\n          // store.dispatch(setDaemon(false));\r\n          console.log('trigger');\r\n        }\r\n      }\r\n      last_data.user = state.user;\r\n    }\r\n  };\r\n  subscribers['Daemon'] = async function (state) {\r\n    if (state.daemon) {\r\n      if (JSON.stringify(state.daemon) != JSON.stringify(last_data.daemon)) {\r\n        forceUpdate();\r\n      }\r\n      last_data.daemon = state.daemon;\r\n      if (state.daemon.shop_info) {\r\n        if (title === titleDefault) {\r\n          setTitle(getShopTitle());\r\n        }\r\n      }\r\n    }\r\n    // if (state.daemon === false) {\r\n    //   store.dispatch(setDaemon(null));\r\n    //   const daemon = await api.request('daemon', 'GET');\r\n    //   if (daemon.code === 200 && daemon.data.uid) {\r\n    //     store.dispatch(setDaemon(daemon.data));\r\n    //   } else store.dispatch(setDaemon(null));\r\n    // }\r\n  };\r\n  // onMount & onUpdate\r\n  React.useEffect(() => {\r\n    const onWindowResize = () => {\r\n      let width = window.innerWidth;\r\n      // console.log(width);\r\n      if (!open && width >= triggerWidthOpen) setOpen(true);\r\n      if (open && width <= triggerWidthClose) setOpen(false);\r\n    };\r\n    window.addEventListener(\"load\", onWindowResize);\r\n    window.addEventListener('resize', onWindowResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"load\", onWindowResize);\r\n      window.removeEventListener(\"resize\", onWindowResize);\r\n    };\r\n  });\r\n\r\n\r\n  const handleLoginOpen = () => {\r\n    // console.log('handleLoginOpen');\r\n    setPopupLogin(true);\r\n  };\r\n\r\n  const handleLoginClose = () => {\r\n    setPopupLogin(false);\r\n  };\r\n\r\n  const handleClickAction = () => {\r\n    if (window.innerWidth < 600 || window.location.pathname === '/') {\r\n      setOpen(false);\r\n    }\r\n  };\r\n\r\n  const mainContent = <Router>\r\n    <MuiPickersUtilsProvider utils={MomentUtils} locale=\"zh-cn\">\r\n      <CssBaseline />\r\n      <AppBar\r\n        position=\"fixed\"\r\n        className={clsx(classes.appBar, {\r\n          [classes.appBarShift]: open,\r\n        })}\r\n      >\r\n        <Toolbar>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={() => { setOpen(true); }}\r\n            edge=\"start\"\r\n            className={clsx(classes.menuButton, {\r\n              [classes.hide]: open,\r\n            })}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" noWrap className={classes.title}>\r\n            {title}\r\n          </Typography>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"login\"\r\n            onClick={handleLoginOpen}\r\n          >\r\n            <AccountCircleIcon />\r\n          </IconButton>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        className={clsx(classes.drawer, {\r\n          [classes.drawerOpen]: open,\r\n          [classes.drawerClose]: !open,\r\n        })}\r\n        classes={{\r\n          paper: clsx({\r\n            [classes.drawerOpen]: open,\r\n            [classes.drawerClose]: !open,\r\n          }),\r\n        }}\r\n      >\r\n        <div className={classes.toolbar}>\r\n          <IconButton onClick={() => { setOpen(false); }}>\r\n            {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List onClick={handleClickAction}>\r\n          <ListItemLink to=\"/\" primary=\"启动页\" icon={<DashboardIcon />} />\r\n          <ListItemLink to=\"/tasks\" primary=\"任务\" icon={<AssignmentIcon />} />\r\n          <ListItemLink to=\"/settings\" primary=\"设置\" icon={<SettingsIcon />} />\r\n        </List>\r\n      </Drawer>\r\n      <main className={classes.content}>\r\n        <div className={classes.toolbar} />\r\n        <Switch>\r\n          <Route path={\"/\"} exact={true}>\r\n            <Launch />\r\n          </Route>\r\n          <Route path={\"/tasks\"} exact={true}>\r\n            <Tasks />\r\n          </Route>\r\n          <Route path={\"/settings\"} exact={false}>\r\n            <Settings />\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n    </MuiPickersUtilsProvider>\r\n  </Router>;\r\n\r\n  const user = store.getState().user;\r\n  const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n  let content = isNowLogining ? <Box>正在登录...</Box> : (user ? mainContent : <Login></Login>);\r\n  if ((!isNowLogining && user) && !store.getState().daemon) {\r\n    content = <RemoteLogin></RemoteLogin>\r\n  }\r\n  // console.log('app.js user', user, 'content', content);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <ThemeProvider theme={store.getState().config.theme}>\r\n        {content}\r\n        <Dialog open={errorDialogInfo ? true : false} onClose={() => { setErrorDialogInfo(null); }}>\r\n          <DialogTitle>遇到错误</DialogTitle>\r\n          <DialogContent>\r\n            <Typography variant=\"body1\">错误信息</Typography>\r\n            <Box component=\"div\">\r\n              <Box component=\"div\">\r\n                {() => {\r\n                  if (isIterator(errorDialogInfo) && typeof (errorDialogInfo) !== 'string') {\r\n                    return <List>\r\n                      {errorDialogInfo.map((d, i) => <ListItem key={i}>\r\n                        <code>{JSON.stringify(d) === '{}' ? d.toString() : JSON.stringify(d)}</code>\r\n                      </ListItem>)}\r\n                    </List>;\r\n                  } else {\r\n                    return <code>{JSON.stringify(errorDialogInfo) === '{}' ? errorDialogInfo.toString() : JSON.stringify(errorDialogInfo)}</code>;\r\n                  }\r\n                }}\r\n              </Box>\r\n            </Box>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button color=\"primary\" onClick={() => { window.location.reload() }}>刷新</Button>\r\n            <Button color=\"primary\" onClick={() => { setErrorDialogInfo(null); }}>取消</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        <Snackbar\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'right',\r\n          }}\r\n          open={myMessage !== null}\r\n          autoHideDuration={6000}\r\n          // onClose={(e) => { console.log(e); }}\r\n          message={myMessage}\r\n          action={\r\n            <React.Fragment>\r\n              <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={() => setMyMessage(null)}>\r\n                <CloseIcon fontSize=\"small\" />\r\n              </IconButton>\r\n            </React.Fragment>\r\n          }\r\n        />\r\n      </ThemeProvider>\r\n    </div >\r\n  );\r\n}\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from './data/store';\r\nimport { Provider } from 'react-redux';\r\nimport { api } from './api/api';\r\nimport { setConfig, setDaemon, setErrorInfo, setRoomStockPlans, setTimetableNodes, setTimetablePeriods, setUser } from './data/action';\r\nimport { sleep } from './utils/utils';\r\n\r\n// 循环执行函数\r\nasync function cycleFunc(cycle = 1000) {\r\n  while (true) {\r\n    try {\r\n\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    await sleep(cycle);\r\n  }\r\n}\r\n\r\n// 开始执行的函数\r\nasync function startFunc() {\r\n  setTimeout(async () => {\r\n    const user = store.getState().user;\r\n    const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n    if (isNowLogining) {\r\n      api.load_from_config();\r\n      const res = await api.request('user', 'GET');\r\n      // console.log('index res', res)\r\n      if (res.code === 200) {\r\n        // console.log('saving user', res.data.user)\r\n        store.dispatch(setUser(res.data.user));\r\n        const daemon = await api.request('daemon', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        } else store.dispatch(setDaemon(null));\r\n      }\r\n    }\r\n    // let c = api.download_config();\r\n    // if (!c.settings_async) return;\r\n    // const config_frontend = await api.download_config();\r\n    // if (!config_frontend) {\r\n    //   store.dispatch(setErrorInfo(\"同步设置失败\"));\r\n    // }\r\n    // else store.dispatch(setConfig(config_frontend));\r\n  }, 0);\r\n}\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\nstartFunc().then(() => {\r\n  cycleFunc();\r\n});\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}